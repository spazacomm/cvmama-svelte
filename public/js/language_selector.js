function asyncGeneratorStep(e,a,n,t,o,r,c){try{var l=e[r](c),u=l.value}catch(e){return void n(e)}l.done?a(u):Promise.resolve(u).then(t,o)}function _asyncToGenerator(e){return function(){var a=this,n=arguments;return new Promise((function(t,o){var r=e.apply(a,n);function c(e){asyncGeneratorStep(r,t,o,c,l,"next",e)}function l(e){asyncGeneratorStep(r,t,o,c,l,"throw",e)}c(void 0)}))}}var __generator=this&&this.__generator||function(e,a){var n,t,o,r,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,t&&(o=2&r[0]?t.return:r[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,r[1])).done)return o;switch(t=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,t=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){c.label=r[1];break}if(6===r[0]&&c.label<o[1]){c.label=o[1],o=r;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(r);break}o[2]&&c.ops.pop(),c.trys.pop();continue}r=a.call(e,c)}catch(e){r=[6,e],t=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}},setupLanguageSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a="";switch(get_cookie("pref_language")){case"de":a="Deutsch";break;case"en":default:a="English";break;case"fr":a="Français";break;case"nl":a="Nederlands";break;case"es":a="Español"}$("#language-selector-btn").text(a),$("#language-selector-dropdown").val(get_cookie("pref_language")),e&&($("#account-language-selector-dropdown").val(get_cookie("pref_language")),$("#account-language-selector-save").prop("disabled",!0))},createLanguageOption=function(e,a,n){var t=document.createElement("option");t.setAttribute("notranslate",""),t.value=e,t.textContent=a,$(n).append(t)},saveLanguageSelection=function(e,a,n){var t=$(e).val();if(t&&""!==t.trim()){if(t!==get_cookie("pref_language")){var o=window.location.hostname.replace(/^www/,"");set_cookie("pref_language",t,2592e3,";domain="+o),location.reload()}LanguageSelectorEvent(a,"language_selection",t).send(),n&&$(n).modal("hide")}},getLanguageSelectorData=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(a,n){$.ajax({url:"/api/locale/selector",type:"GET",data:{csrf_token:page_info.csrf_token},success:function(n){n.show_language_selector&&($("#language-selector-btn-container").removeClass("tw-hidden"),e&&($("#account-language-selector").removeClass("tw-hidden"),$("#account-language-selector-dropdown").empty()),$("#language-selector-dropdown").empty(),n.languages.forEach((function(a){createLanguageOption(a.language,a.language_readable,"#language-selector-dropdown"),e&&createLanguageOption(a.language,a.language_readable,"#account-language-selector-dropdown")}))),a()},error:function(){logger.error("Error getting language selector data"),n()}})}))};$(document).ready(_asyncToGenerator((function(){var e,a,n;return __generator(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,getLanguageSelectorData(null!==(e=page_info.show_account_language_settings)&&void 0!==e&&e)];case 1:return t.sent(),setupLanguageSelector(null!==(a=page_info.show_account_language_settings)&&void 0!==a&&a),[3,3];case 2:return n=t.sent(),logger.error("Error setting up language selector: "+n.message),[3,3];case 3:return $("#language-selector-btn").on("click",(function(){$("#language-selector").modal("show"),LanguageSelectorEvent("language_icon_clicked").send()})),$("#language-selector-save").on("click",(function(){saveLanguageSelection("#language-selector-dropdown","language_popup_option_selected","#language-selector")})),$("#account-language-selector-save").on("click",(function(){saveLanguageSelection("#account-language-selector-dropdown","language_account_settings_selected")})),$("#account-language-selector-dropdown").on("change",(function(){$("#account-language-selector-dropdown").val()!==get_cookie("pref_language")?$("#account-language-selector-save").prop("disabled",!1):$("#account-language-selector-save").prop("disabled",!0)})),[2]}}))})));
//# sourceMappingURL=language_selector.js.map
