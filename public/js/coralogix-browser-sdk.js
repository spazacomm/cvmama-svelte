var bundle=function(e){"use strict";var t="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},n="1.9.0",r=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var o=function(e){var t=new Set([e]),n=new Set,o=e.match(r);if(!o)return function(){return!1};var i=+o[1],s=+o[2],a=+o[3];if(null!=o[4])return function(t){return t===e};function c(e){return n.add(e),!1}function u(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;var o=e.match(r);if(!o)return c(e);var l=+o[1],d=+o[2],p=+o[3];return null!=o[4]||i!==l?c(e):0===i?s===d&&a<=p?u(e):c(e):s<=d?u(e):c(e)}}(n),i=n.split(".")[0],s=Symbol.for("opentelemetry.js.api."+i),a=t;function c(e,t,r,o){var i;void 0===o&&(o=!1);var c=a[s]=null!==(i=a[s])&&void 0!==i?i:{version:n};if(!o&&c[e]){var u=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(u.stack||u.message),!1}if(c.version!==n){u=new Error("@opentelemetry/api: Registration of version v"+c.version+" for "+e+" does not match previously registered API v"+n);return r.error(u.stack||u.message),!1}return c[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+n+"."),!0}function u(e){var t,n,r=null===(t=a[s])||void 0===t?void 0:t.version;if(r&&o(r))return null===(n=a[s])||void 0===n?void 0:n[e]}function l(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+n+".");var r=a[s];r&&delete r[e]}var d,p=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},h=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},f=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g("verbose",this._namespace,e)},e}();function g(e,t,n){var r=u("diag");if(r)return n.unshift(t),r[e].apply(r,h([],p(n),!1))}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(d||(d={}));var m=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},v=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},y=function(){function e(){function e(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=u("diag");if(r)return r[e].apply(r,v([],m(t),!1))}}var t=this;t.setLogger=function(e,n){var r,o,i;if(void 0===n&&(n={logLevel:d.INFO}),e===t){var s=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(r=s.stack)&&void 0!==r?r:s.message),!1}"number"==typeof n&&(n={logLevel:n});var a=u("diag"),l=function(e,t){function n(n,r){var o=t[n];return"function"==typeof o&&e>=r?o.bind(t):function(){}}return e<d.NONE?e=d.NONE:e>d.ALL&&(e=d.ALL),t=t||{},{error:n("error",d.ERROR),warn:n("warn",d.WARN),info:n("info",d.INFO),debug:n("debug",d.DEBUG),verbose:n("verbose",d.VERBOSE)}}(null!==(o=n.logLevel)&&void 0!==o?o:d.INFO,e);if(a&&!n.suppressOverrideMessage){var p=null!==(i=(new Error).stack)&&void 0!==i?i:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+p),l.warn("Current logger will overwrite one already registered from "+p)}return c("diag",l,t,!0)},t.disable=function(){l("diag",t)},t.createComponentLogger=function(e){return new f(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),E=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},b=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},S=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(e){var t=E(e,2);return[t[0],t[1]]}))},e.prototype.setEntry=function(t,n){var r=new e(this._entries);return r._entries.set(t,n),r},e.prototype.removeEntry=function(t){var n=new e(this._entries);return n._entries.delete(t),n},e.prototype.removeEntries=function(){for(var t,n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=new e(this._entries);try{for(var s=b(r),a=s.next();!a.done;a=s.next()){var c=a.value;i._entries.delete(c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return i},e.prototype.clear=function(){return new e},e}(),T=Symbol("BaggageEntryMetadata"),_=y.instance();function C(e){return void 0===e&&(e={}),new S(new Map(Object.entries(e)))}function I(e){return Symbol.for(e)}var O,w,R=function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(e){return n._currentContext.get(e)},n.setValue=function(t,r){var o=new e(n._currentContext);return o._currentContext.set(t,r),o},n.deleteValue=function(t){var r=new e(n._currentContext);return r._currentContext.delete(t),r}},A=new R,N=(O=function(e,t){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},O(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}O(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),L=function(){function e(){}return e.prototype.createGauge=function(e,t){return V},e.prototype.createHistogram=function(e,t){return H},e.prototype.createCounter=function(e,t){return G},e.prototype.createUpDownCounter=function(e,t){return X},e.prototype.createObservableGauge=function(e,t){return z},e.prototype.createObservableCounter=function(e,t){return Y},e.prototype.createObservableUpDownCounter=function(e,t){return K},e.prototype.addBatchObservableCallback=function(e,t){},e.prototype.removeBatchObservableCallback=function(e){},e}(),M=function(){},x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),t.prototype.add=function(e,t){},t}(M),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),t.prototype.add=function(e,t){},t}(M),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),t.prototype.record=function(e,t){},t}(M),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),t.prototype.record=function(e,t){},t}(M),U=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.removeCallback=function(e){},e}(),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),t}(U),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),t}(U),B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),t}(U),W=new L,G=new x,V=new P,H=new D,X=new k,Y=new F,z=new j,K=new B,Z={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},J={set:function(e,t,n){null!=e&&(e[t]=n)}},q=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},$=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Q=function(){function e(){}return e.prototype.active=function(){return A},e.prototype.with=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return t.call.apply(t,$([n],q(r),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),ee=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},te=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},ne="context",re=new Q,oe=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return c(ne,e,y.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,n){for(var r,o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];return(r=this._getContextManager()).with.apply(r,te([e,t,n],ee(o),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return u(ne)||re},e.prototype.disable=function(){this._getContextManager().disable(),l(ne,y.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(w||(w={}));var ie="0000000000000000",se="00000000000000000000000000000000",ae={traceId:se,spanId:ie,traceFlags:w.NONE},ce=function(){function e(e){void 0===e&&(e=ae),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.addLink=function(e){return this},e.prototype.addLinks=function(e){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),ue=I("OpenTelemetry Context Key SPAN");function le(e){return e.getValue(ue)||void 0}function de(){return le(oe.getInstance().active())}function pe(e,t){return e.setValue(ue,t)}function he(e){return e.deleteValue(ue)}function fe(e,t){return pe(e,new ce(t))}function ge(e){var t;return null===(t=le(e))||void 0===t?void 0:t.spanContext()}var me=/^([0-9a-f]{32})$/i,ve=/^[0-9a-f]{16}$/i;function ye(e){return me.test(e)&&e!==se}function Ee(e){return ve.test(e)&&e!==ie}function be(e){return ye(e.traceId)&&Ee(e.spanId)}function Se(e){return new ce(e)}var Te=oe.getInstance(),_e=function(){function e(){}return e.prototype.startSpan=function(e,t,n){if(void 0===n&&(n=Te.active()),Boolean(null==t?void 0:t.root))return new ce;var r,o=n&&ge(n);return"object"==typeof(r=o)&&"string"==typeof r.spanId&&"string"==typeof r.traceId&&"number"==typeof r.traceFlags&&be(o)?new ce(o):new ce},e.prototype.startActiveSpan=function(e,t,n,r){var o,i,s;if(!(arguments.length<2)){2===arguments.length?s=t:3===arguments.length?(o=t,s=n):(o=t,i=n,s=r);var a=null!=i?i:Te.active(),c=this.startSpan(e,o,a),u=pe(a,c);return Te.with(u,s,void 0,c)}},e}();var Ce,Ie,Oe,we=new _e,Re=function(){function e(e,t,n,r){this._provider=e,this.name=t,this.version=n,this.options=r}return e.prototype.startSpan=function(e,t,n){return this._getTracer().startSpan(e,t,n)},e.prototype.startActiveSpan=function(e,t,n,r){var o=this._getTracer();return Reflect.apply(o.startActiveSpan,o,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):we},e}(),Ae=new(function(){function e(){}return e.prototype.getTracer=function(e,t,n){return new _e},e}()),Ne=function(){function e(){}return e.prototype.getTracer=function(e,t,n){var r;return null!==(r=this.getDelegateTracer(e,t,n))&&void 0!==r?r:new Re(this,e,t,n)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:Ae},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(e,t,n)},e}();!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Ce||(Ce={})),function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(Ie||(Ie={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(Oe||(Oe={}));var Le=oe.getInstance(),Me=y.instance(),xe=new(function(){function e(){}return e.prototype.getMeter=function(e,t,n){return W},e}()),ke="metrics",Pe=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(e){return c(ke,e,y.instance())},e.prototype.getMeterProvider=function(){return u(ke)||xe},e.prototype.getMeter=function(e,t,n){return this.getMeterProvider().getMeter(e,t,n)},e.prototype.disable=function(){l(ke,y.instance())},e}().getInstance(),De=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),Ue=I("OpenTelemetry Baggage Key");function Fe(e){return e.getValue(Ue)||void 0}function je(){return Fe(oe.getInstance().active())}function Be(e,t){return e.setValue(Ue,t)}function We(e){return e.deleteValue(Ue)}var Ge="propagation",Ve=new De,He=function(){function e(){this.createBaggage=C,this.getBaggage=Fe,this.getActiveBaggage=je,this.setBaggage=Be,this.deleteBaggage=We}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return c(Ge,e,y.instance())},e.prototype.inject=function(e,t,n){return void 0===n&&(n=J),this._getGlobalPropagator().inject(e,t,n)},e.prototype.extract=function(e,t,n){return void 0===n&&(n=Z),this._getGlobalPropagator().extract(e,t,n)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){l(Ge,y.instance())},e.prototype._getGlobalPropagator=function(){return u(Ge)||Ve},e}(),Xe=He.getInstance(),Ye="trace",ze=function(){function e(){this._proxyTracerProvider=new Ne,this.wrapSpanContext=Se,this.isSpanContextValid=be,this.deleteSpan=he,this.getSpan=le,this.getActiveSpan=de,this.getSpanContext=ge,this.setSpan=pe,this.setSpanContext=fe}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=c(Ye,this._proxyTracerProvider,y.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return u(Ye)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){l(Ye,y.instance()),this._proxyTracerProvider=new Ne},e}().getInstance(),Ke=I("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function Ze(e){return!0===e.getValue(Ke)}var Je="baggage",qe=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function $e(e){var t=e.split(";");if(!(t.length<=0)){var n=t.shift();if(n){var r=n.indexOf("=");if(!(r<=0)){var o,i,s=decodeURIComponent(n.substring(0,r).trim()),a=decodeURIComponent(n.substring(r+1).trim());return t.length>0&&("string"!=typeof(i=t.join(";"))&&(_.error("Cannot create baggage metadata from unknown type: "+typeof i),i=""),o={__TYPE__:T,toString:function(){return i}}),{key:s,value:a,metadata:o}}}}}var Qe=function(){function e(){}return e.prototype.inject=function(e,t,n){var r=Xe.getBaggage(e);if(r&&!Ze(e)){var o=function(e){return e.getAllEntries().map((function(e){var t=qe(e,2),n=t[0],r=t[1],o=encodeURIComponent(n)+"="+encodeURIComponent(r.value);return void 0!==r.metadata&&(o+=";"+r.metadata.toString()),o}))}(r).filter((function(e){return e.length<=4096})).slice(0,180),i=function(e){return e.reduce((function(e,t){var n=e+(""!==e?",":"")+t;return n.length>8192?e:n}),"")}(o);i.length>0&&n.set(t,Je,i)}},e.prototype.extract=function(e,t,n){var r=n.get(t,Je),o=Array.isArray(r)?r.join(","):r;if(!o)return e;var i={};return 0===o.length?e:(o.split(",").forEach((function(e){var t=$e(e);if(t){var n={value:t.value};t.metadata&&(n.metadata=t.metadata),i[t.key]=n}})),0===Object.entries(i).length?e:Xe.setBaggage(e,Xe.createBaggage(i)))},e.prototype.fields=function(){return[Je]},e}(),et=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},tt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function nt(e){var t,n,r={};if("object"!=typeof e||null==e)return r;try{for(var o=et(Object.entries(e)),i=o.next();!i.done;i=o.next()){var s=tt(i.value,2),a=s[0],c=s[1];rt(a)?ot(c)?Array.isArray(c)?r[a]=c.slice():r[a]=c:Me.warn("Invalid attribute value set for key: "+a):Me.warn("Invalid attribute key: "+a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}function rt(e){return"string"==typeof e&&e.length>0}function ot(e){return null==e||(Array.isArray(e)?function(e){var t,n,r;try{for(var o=et(e),i=o.next();!i.done;i=o.next()){var s=i.value;if(null!=s){if(!r){if(it(s)){r=typeof s;continue}return!1}if(typeof s!==r)return!1}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!0}(e):it(e))}function it(e){switch(typeof e){case"number":case"boolean":case"string":return!0}return!1}var st,at=function(e){Me.error(function(e){return"string"==typeof e?e:JSON.stringify(function(e){for(var t={},n=e;null!==n;)Object.getOwnPropertyNames(n).forEach((function(e){if(!t[e]){var r=n[e];r&&(t[e]=String(r))}})),n=Object.getPrototypeOf(n);return t}(e))}(e))};function ct(e){try{at(e)}catch(e){}}!function(e){e.AlwaysOff="always_off",e.AlwaysOn="always_on",e.ParentBasedAlwaysOff="parentbased_always_off",e.ParentBasedAlwaysOn="parentbased_always_on",e.ParentBasedTraceIdRatio="parentbased_traceidratio",e.TraceIdRatio="traceidratio"}(st||(st={}));var ut=["OTEL_SDK_DISABLED"];function lt(e){return ut.indexOf(e)>-1}var dt=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];function pt(e){return dt.indexOf(e)>-1}var ht=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function ft(e){return ht.indexOf(e)>-1}var gt=1/0,mt=128,vt={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:d.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:gt,OTEL_ATTRIBUTE_COUNT_LIMIT:mt,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:gt,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:mt,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:gt,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:mt,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:st.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};function yt(e,t,n){if(void 0!==n[e]){var r=String(n[e]);t[e]="true"===r.toLowerCase()}}function Et(e,t,n,r,o){if(void 0===r&&(r=-1/0),void 0===o&&(o=1/0),void 0!==n[e]){var i=Number(n[e]);isNaN(i)||(t[e]=i<r?r:i>o?o:i)}}function bt(e,t,n,r){void 0===r&&(r=",");var o=n[e];"string"==typeof o&&(t[e]=o.split(r).map((function(e){return e.trim()})))}var St={ALL:d.ALL,VERBOSE:d.VERBOSE,DEBUG:d.DEBUG,INFO:d.INFO,WARN:d.WARN,ERROR:d.ERROR,NONE:d.NONE};function Tt(e,t,n){var r=n[e];if("string"==typeof r){var o=St[r.toUpperCase()];null!=o&&(t[e]=o)}}function _t(e){var t={};for(var n in vt){var r=n;if("OTEL_LOG_LEVEL"===r)Tt(r,t,e);else if(lt(r))yt(r,t,e);else if(pt(r))Et(r,t,e);else if(ft(r))bt(r,t,e);else{var o=e[r];null!=o&&(t[r]=String(o))}}return t}var Ct="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{};function It(){var e=_t(Ct);return Object.assign({},vt,e)}var Ot,wt=performance,Rt="exception.type",At="exception.message",Nt="http.method",Lt="http.url",Mt="http.host",xt="http.scheme",kt="http.status_code",Pt="http.user_agent",Dt="telemetry.sdk.name",Ut="telemetry.sdk.language",Ft="telemetry.sdk.version",jt=((Ot={})[Dt]="opentelemetry",Ot["process.runtime.name"]="browser",Ot[Ut]="webjs",Ot[Ft]="1.25.1",Ot);var Bt,Wt=Math.pow(10,6),Gt=Math.pow(10,9);function Vt(e){var t=e/1e3;return[Math.trunc(t),Math.round(e%1e3*Wt)]}function Ht(){var e=wt.timeOrigin;if("number"!=typeof e){var t=wt;e=t.timing&&t.timing.fetchStart}return e}function Xt(e){return Jt(Vt(Ht()),Vt("number"==typeof e?e:wt.now()))}function Yt(e){if(Kt(e))return e;if("number"==typeof e)return e<Ht()?Xt(e):Vt(e);if(e instanceof Date)return Vt(e.getTime());throw TypeError("Invalid input type")}function zt(e){return e[0]*Gt+e[1]}function Kt(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}function Zt(e){return Kt(e)||"number"==typeof e||e instanceof Date}function Jt(e,t){var n=[e[0]+t[0],e[1]+t[1]];return n[1]>=Gt&&(n[1]-=Gt,n[0]+=1),n}!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED"}(Bt||(Bt={}));var qt=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},$t=function(){function e(e){var t;void 0===e&&(e={}),this._propagators=null!==(t=e.propagators)&&void 0!==t?t:[],this._fields=Array.from(new Set(this._propagators.map((function(e){return"function"==typeof e.fields?e.fields():[]})).reduce((function(e,t){return e.concat(t)}),[])))}return e.prototype.inject=function(e,t,n){var r,o;try{for(var i=qt(this._propagators),s=i.next();!s.done;s=i.next()){var a=s.value;try{a.inject(e,t,n)}catch(e){Me.warn("Failed to inject with "+a.constructor.name+". Err: "+e.message)}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},e.prototype.extract=function(e,t,n){return this._propagators.reduce((function(e,r){try{return r.extract(e,t,n)}catch(e){Me.warn("Failed to inject with "+r.constructor.name+". Err: "+e.message)}return e}),e)},e.prototype.fields=function(){return this._fields.slice()},e}(),Qt="[_0-9a-z-*/]",en=new RegExp("^(?:"+("[a-z]"+Qt+"{0,255}")+"|"+("[a-z0-9]"+Qt+"{0,240}@[a-z]"+Qt+"{0,13}")+")$"),tn=/^[ -~]{0,255}[!-~]$/,nn=/,|=/;var rn=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,t),n},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,n){return t.push(n+"="+e.get(n)),t}),[]).join(",")},e.prototype._parse=function(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((function(e,t){var n=t.trim(),r=n.indexOf("=");if(-1!==r){var o=n.slice(0,r),i=n.slice(r+1,t.length);(function(e){return en.test(e)})(o)&&function(e){return tn.test(e)&&!nn.test(e)}(i)&&e.set(o,i)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}(),on="traceparent",sn="tracestate",an=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");var cn,un,ln=function(){function e(){}return e.prototype.inject=function(e,t,n){var r=ze.getSpanContext(e);if(r&&!Ze(e)&&be(r)){var o="00-"+r.traceId+"-"+r.spanId+"-0"+Number(r.traceFlags||w.NONE).toString(16);n.set(t,on,o),r.traceState&&n.set(t,sn,r.traceState.serialize())}},e.prototype.extract=function(e,t,n){var r=n.get(t,on);if(!r)return e;var o=Array.isArray(r)?r[0]:r;if("string"!=typeof o)return e;var i=function(e){var t=an.exec(e);return t?"00"===t[1]&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}:null}(o);if(!i)return e;i.isRemote=!0;var s=n.get(t,sn);if(s){var a=Array.isArray(s)?s.join(","):s;i.traceState=new rn("string"==typeof a?a:void 0)}return ze.setSpanContext(e,i)},e.prototype.fields=function(){return[on,sn]},e}(),dn="[object Null]",pn="[object Undefined]",hn=Function.prototype.toString,fn=hn.call(Object),gn=(cn=Object.getPrototypeOf,un=Object,function(e){return cn(un(e))}),mn=Object.prototype,vn=mn.hasOwnProperty,yn=Symbol?Symbol.toStringTag:void 0,En=mn.toString;function bn(e){if(!function(e){return null!=e&&"object"==typeof e}(e)||"[object Object]"!==function(e){if(null==e)return void 0===e?pn:dn;return yn&&yn in Object(e)?function(e){var t=vn.call(e,yn),n=e[yn],r=!1;try{e[yn]=void 0,r=!0}catch(e){}var o=En.call(e);r&&(t?e[yn]=n:delete e[yn]);return o}(e):function(e){return En.call(e)}(e)}(e))return!1;var t=gn(e);if(null===t)return!0;var n=vn.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&hn.call(n)===fn}function Sn(e){return Cn(e)?e.slice():e}function Tn(e,t,n,r){var o;if(void 0===n&&(n=0),!(n>20)){if(n++,wn(e)||wn(t)||In(t))o=Sn(t);else if(Cn(e)){if(o=e.slice(),Cn(t))for(var i=0,s=t.length;i<s;i++)o.push(Sn(t[i]));else if(On(t))for(i=0,s=(a=Object.keys(t)).length;i<s;i++){o[c=a[i]]=Sn(t[c])}}else if(On(e))if(On(t)){if(!function(e,t){if(!bn(e)||!bn(t))return!1;return!0}(e,t))return t;o=Object.assign({},e);var a;for(i=0,s=(a=Object.keys(t)).length;i<s;i++){var c,u=t[c=a[i]];if(wn(u))void 0===u?delete o[c]:o[c]=u;else{var l=o[c],d=u;if(_n(e,c,r)||_n(t,c,r))delete o[c];else{if(On(l)&&On(d)){var p=r.get(l)||[],h=r.get(d)||[];p.push({obj:e,key:c}),h.push({obj:t,key:c}),r.set(l,p),r.set(d,h)}o[c]=Tn(o[c],u,n,r)}}}}else o=t;return o}}function _n(e,t,n){for(var r=n.get(e[t])||[],o=0,i=r.length;o<i;o++){var s=r[o];if(s.key===t&&s.obj===e)return!0}return!1}function Cn(e){return Array.isArray(e)}function In(e){return"function"==typeof e}function On(e){return!wn(e)&&!Cn(e)&&!In(e)&&"object"==typeof e}function wn(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||void 0===e||e instanceof Date||e instanceof RegExp||null===e}var Rn=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function An(e,t){return"string"==typeof t?e===t:!!e.match(t)}function Nn(e,t){var n,r;if(!t)return!1;try{for(var o=Rn(t),i=o.next();!i.done;i=o.next()){if(An(e,i.value))return!0}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1}var Ln,Mn=function(){function e(){var e=this;this._promise=new Promise((function(t,n){e._resolve=t,e._reject=n}))}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),e.prototype.resolve=function(e){this._resolve(e)},e.prototype.reject=function(e){this._reject(e)},e}(),xn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},kn=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Pn=function(){function e(e,t){this._callback=e,this._that=t,this._isCalled=!1,this._deferred=new Mn}return Object.defineProperty(e.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),e.prototype.call=function(){for(var e,t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((e=this._callback).call.apply(e,kn([this._that],xn(n),!1))).then((function(e){return t._deferred.resolve(e)}),(function(e){return t._deferred.reject(e)}))}catch(e){this._deferred.reject(e)}}return this._deferred.promise},e}(),Dn=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Un=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Fn=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},jn=function(){function e(e,t,n,r,o,i,s,a,c,u){void 0===s&&(s=[]),this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:Oe.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=r,this.parentSpanId=i,this.kind=o,this.links=s;var l=Date.now();this._performanceStartTime=wt.now(),this._performanceOffset=l-(this._performanceStartTime+Ht()),this._startTimeProvided=null!=a,this.startTime=this._getTime(null!=a?a:l),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,null!=u&&this.setAttributes(u),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,t)}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return null==t||this._isSpanEnded()?this:0===e.length?(Me.warn("Invalid attribute key: "+e),this):ot(t)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(t),this):(Me.warn("Invalid attribute value set for key: "+e),this)},e.prototype.setAttributes=function(e){var t,n;try{for(var r=Dn(Object.entries(e)),o=r.next();!o.done;o=r.next()){var i=Un(o.value,2),s=i[0],a=i[1];this.setAttribute(s,a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this},e.prototype.addEvent=function(e,t,n){if(this._isSpanEnded())return this;if(0===this._spanLimits.eventCountLimit)return Me.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(0===this._droppedEventsCount&&Me.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),Zt(t)&&(Zt(n)||(n=t),t=void 0);var r=nt(t);return this.events.push({name:e,attributes:r,time:this._getTime(n),droppedAttributesCount:0}),this},e.prototype.addLink=function(e){return this.links.push(e),this},e.prototype.addLinks=function(e){var t;return(t=this.links).push.apply(t,Fn([],Un(e),!1)),this},e.prototype.setStatus=function(e){return this._isSpanEnded()||(this.status=e),this},e.prototype.updateName=function(e){return this._isSpanEnded()||(this.name=e),this},e.prototype.end=function(e){this._isSpanEnded()?Me.error(this.name+" "+this._spanContext.traceId+"-"+this._spanContext.spanId+" - You can only call end() on a span once."):(this._ended=!0,this.endTime=this._getTime(e),this._duration=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return r<0&&(n-=1,r+=Gt),[n,r]}(this.startTime,this.endTime),this._duration[0]<0&&(Me.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&Me.warn("Dropped "+this._droppedEventsCount+" events because eventCountLimit reached"),this._spanProcessor.onEnd(this))},e.prototype._getTime=function(e){if("number"==typeof e&&e<wt.now())return Xt(e+this._performanceOffset);if("number"==typeof e)return Vt(e);if(e instanceof Date)return Vt(e.getTime());if(Kt(e))return e;if(this._startTimeProvided)return Vt(Date.now());var t=wt.now()-this._performanceStartTime;return Jt(this.startTime,Vt(t))},e.prototype.isRecording=function(){return!1===this._ended},e.prototype.recordException=function(e,t){var n={};"string"==typeof e?n[At]=e:e&&(e.code?n[Rt]=e.code.toString():e.name&&(n[Rt]=e.name),e.message&&(n[At]=e.message),e.stack&&(n["exception.stacktrace"]=e.stack)),n[Rt]||n[At]?this.addEvent("exception",n,t):Me.warn("Failed to record an exception "+e)},Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"droppedAttributesCount",{get:function(){return this._droppedAttributesCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"droppedEventsCount",{get:function(){return this._droppedEventsCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"droppedLinksCount",{get:function(){return this._droppedLinksCount},enumerable:!1,configurable:!0}),e.prototype._isSpanEnded=function(){return this._ended&&Me.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},e.prototype._truncateToLimitUtil=function(e,t){return e.length<=t?e:e.substr(0,t)},e.prototype._truncateToSize=function(e){var t=this,n=this._attributeValueLengthLimit;return n<=0?(Me.warn("Attribute value limit must be positive, got "+n),e):"string"==typeof e?this._truncateToLimitUtil(e,n):Array.isArray(e)?e.map((function(e){return"string"==typeof e?t._truncateToLimitUtil(e,n):e})):e},e}();!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Ln||(Ln={}));var Bn=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:Ln.NOT_RECORD}},e.prototype.toString=function(){return"AlwaysOffSampler"},e}(),Wn=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:Ln.RECORD_AND_SAMPLED}},e.prototype.toString=function(){return"AlwaysOnSampler"},e}(),Gn=function(){function e(e){var t,n,r,o;this._root=e.root,this._root||(ct(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new Wn),this._remoteParentSampled=null!==(t=e.remoteParentSampled)&&void 0!==t?t:new Wn,this._remoteParentNotSampled=null!==(n=e.remoteParentNotSampled)&&void 0!==n?n:new Bn,this._localParentSampled=null!==(r=e.localParentSampled)&&void 0!==r?r:new Wn,this._localParentNotSampled=null!==(o=e.localParentNotSampled)&&void 0!==o?o:new Bn}return e.prototype.shouldSample=function(e,t,n,r,o,i){var s=ze.getSpanContext(e);return s&&be(s)?s.isRemote?s.traceFlags&w.SAMPLED?this._remoteParentSampled.shouldSample(e,t,n,r,o,i):this._remoteParentNotSampled.shouldSample(e,t,n,r,o,i):s.traceFlags&w.SAMPLED?this._localParentSampled.shouldSample(e,t,n,r,o,i):this._localParentNotSampled.shouldSample(e,t,n,r,o,i):this._root.shouldSample(e,t,n,r,o,i)},e.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},e}(),Vn=function(){function e(e){void 0===e&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(4294967295*this._ratio)}return e.prototype.shouldSample=function(e,t){return{decision:ye(t)&&this._accumulate(t)<this._upperBound?Ln.RECORD_AND_SAMPLED:Ln.NOT_RECORD}},e.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},e.prototype._normalize=function(e){return"number"!=typeof e||isNaN(e)?0:e>=1?1:e<=0?0:e},e.prototype._accumulate=function(e){for(var t=0,n=0;n<e.length/8;n++){var r=8*n;t=(t^parseInt(e.slice(r,r+8),16))>>>0}return t},e}(),Hn=It(),Xn=st.AlwaysOn;function Yn(){return{sampler:zn(Hn),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:It().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:It().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:It().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:It().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:It().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:It().OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:It().OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:It().OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT}}}function zn(e){switch(void 0===e&&(e=It()),e.OTEL_TRACES_SAMPLER){case st.AlwaysOn:return new Wn;case st.AlwaysOff:return new Bn;case st.ParentBasedAlwaysOn:return new Gn({root:new Wn});case st.ParentBasedAlwaysOff:return new Gn({root:new Bn});case st.TraceIdRatio:return new Vn(Kn(e));case st.ParentBasedTraceIdRatio:return new Gn({root:new Vn(Kn(e))});default:return Me.error('OTEL_TRACES_SAMPLER value "'+e.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+Xn+'".'),new Wn}}function Kn(e){if(void 0===e.OTEL_TRACES_SAMPLER_ARG||""===e.OTEL_TRACES_SAMPLER_ARG)return Me.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to 1."),1;var t=Number(e.OTEL_TRACES_SAMPLER_ARG);return isNaN(t)?(Me.error("OTEL_TRACES_SAMPLER_ARG="+e.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to 1."),1):t<0||t>1?(Me.error("OTEL_TRACES_SAMPLER_ARG="+e.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to 1."),1):t}function Zn(e){var t,n,r,o,i,s,a,c,u,l,d,p,h=Object.assign({},e.spanLimits),f=_t(Ct);return h.attributeCountLimit=null!==(s=null!==(i=null!==(o=null!==(n=null===(t=e.spanLimits)||void 0===t?void 0:t.attributeCountLimit)&&void 0!==n?n:null===(r=e.generalLimits)||void 0===r?void 0:r.attributeCountLimit)&&void 0!==o?o:f.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)&&void 0!==i?i:f.OTEL_ATTRIBUTE_COUNT_LIMIT)&&void 0!==s?s:mt,h.attributeValueLengthLimit=null!==(p=null!==(d=null!==(l=null!==(c=null===(a=e.spanLimits)||void 0===a?void 0:a.attributeValueLengthLimit)&&void 0!==c?c:null===(u=e.generalLimits)||void 0===u?void 0:u.attributeValueLengthLimit)&&void 0!==l?l:f.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)&&void 0!==d?d:f.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)&&void 0!==p?p:gt,Object.assign({},e,{spanLimits:h})}var Jn=function(){function e(e,t){this._exporter=e,this._isExporting=!1,this._finishedSpans=[],this._droppedSpansCount=0;var n=It();this._maxExportBatchSize="number"==typeof(null==t?void 0:t.maxExportBatchSize)?t.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize="number"==typeof(null==t?void 0:t.maxQueueSize)?t.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis="number"==typeof(null==t?void 0:t.scheduledDelayMillis)?t.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis="number"==typeof(null==t?void 0:t.exportTimeoutMillis)?t.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new Pn(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(Me.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return e.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},e.prototype.onStart=function(e,t){},e.prototype.onEnd=function(e){this._shutdownOnce.isCalled||e.spanContext().traceFlags&w.SAMPLED&&this._addToBuffer(e)},e.prototype.shutdown=function(){return this._shutdownOnce.call()},e.prototype._shutdown=function(){var e=this;return Promise.resolve().then((function(){return e.onShutdown()})).then((function(){return e._flushAll()})).then((function(){return e._exporter.shutdown()}))},e.prototype._addToBuffer=function(e){if(this._finishedSpans.length>=this._maxQueueSize)return 0===this._droppedSpansCount&&Me.debug("maxQueueSize reached, dropping spans"),void this._droppedSpansCount++;this._droppedSpansCount>0&&(Me.warn("Dropped "+this._droppedSpansCount+" spans because maxQueueSize reached"),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()},e.prototype._flushAll=function(){var e=this;return new Promise((function(t,n){for(var r=[],o=0,i=Math.ceil(e._finishedSpans.length/e._maxExportBatchSize);o<i;o++)r.push(e._flushOneBatch());Promise.all(r).then((function(){t()})).catch(n)}))},e.prototype._flushOneBatch=function(){var e=this;return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise((function(t,n){var r=setTimeout((function(){n(new Error("Timeout"))}),e._exportTimeoutMillis);Le.with(function(e){return e.setValue(Ke,!0)}(Le.active()),(function(){var o;e._finishedSpans.length<=e._maxExportBatchSize?(o=e._finishedSpans,e._finishedSpans=[]):o=e._finishedSpans.splice(0,e._maxExportBatchSize);for(var i=function(){return e._exporter.export(o,(function(e){var o;clearTimeout(r),e.code===Bt.SUCCESS?t():n(null!==(o=e.error)&&void 0!==o?o:new Error("BatchSpanProcessor: span export failed"))}))},s=null,a=0,c=o.length;a<c;a++){var u=o[a];u.resource.asyncAttributesPending&&u.resource.waitForAsyncAttributes&&(null!=s||(s=[]),s.push(u.resource.waitForAsyncAttributes()))}null===s?i():Promise.all(s).then(i,(function(e){ct(e),n(e)}))}))}))},e.prototype._maybeStartTimer=function(){var e=this;if(!this._isExporting){var t=function(){e._isExporting=!0,e._flushOneBatch().finally((function(){e._isExporting=!1,e._finishedSpans.length>0&&(e._clearTimer(),e._maybeStartTimer())})).catch((function(t){e._isExporting=!1,ct(t)}))};if(this._finishedSpans.length>=this._maxExportBatchSize)return t();void 0===this._timer&&(this._timer=setTimeout((function(){return t()}),this._scheduledDelayMillis),this._timer)}},e.prototype._clearTimer=function(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)},e}(),qn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$n=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.onInit(n),r}return qn(t,e),t.prototype.onInit=function(e){var t=this;!0!==(null==e?void 0:e.disableAutoFlushOnDocumentHide)&&"undefined"!=typeof document&&(this._visibilityChangeListener=function(){"hidden"===document.visibilityState&&t.forceFlush()},this._pageHideListener=function(){t.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))},t.prototype.onShutdown=function(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))},t}(Jn),Qn=function(){this.generateTraceId=tr(16),this.generateSpanId=tr(8)},er=Array(32);function tr(e){return function(){for(var t=0;t<2*e;t++)er[t]=Math.floor(16*Math.random())+48,er[t]>=58&&(er[t]+=39);return String.fromCharCode.apply(null,er.slice(0,2*e))}}var nr=function(){function e(e,t,n){this._tracerProvider=n;var r,o,i,s,a=(r=t,o={sampler:zn()},i=Yn(),(s=Object.assign({},i,o,r)).generalLimits=Object.assign({},i.generalLimits,r.generalLimits||{}),s.spanLimits=Object.assign({},i.spanLimits,r.spanLimits||{}),s);this._sampler=a.sampler,this._generalLimits=a.generalLimits,this._spanLimits=a.spanLimits,this._idGenerator=t.idGenerator||new Qn,this.resource=n.resource,this.instrumentationLibrary=e}return e.prototype.startSpan=function(e,t,n){var r,o,i;void 0===t&&(t={}),void 0===n&&(n=Le.active()),t.root&&(n=ze.deleteSpan(n));var s=ze.getSpan(n);if(Ze(n))return Me.debug("Instrumentation suppressed, returning Noop Span"),ze.wrapSpanContext(ae);var a,c,u,l=null==s?void 0:s.spanContext(),d=this._idGenerator.generateSpanId();l&&ze.isSpanContextValid(l)?(a=l.traceId,c=l.traceState,u=l.spanId):a=this._idGenerator.generateTraceId();var p=null!==(r=t.kind)&&void 0!==r?r:Ie.INTERNAL,h=(null!==(o=t.links)&&void 0!==o?o:[]).map((function(e){return{context:e.context,attributes:nt(e.attributes)}})),f=nt(t.attributes),g=this._sampler.shouldSample(n,a,e,p,f,h);c=null!==(i=g.traceState)&&void 0!==i?i:c;var m={traceId:a,spanId:d,traceFlags:g.decision===Ce.RECORD_AND_SAMPLED?w.SAMPLED:w.NONE,traceState:c};if(g.decision===Ce.NOT_RECORD)return Me.debug("Recording is off, propagating context in a non-recording span"),ze.wrapSpanContext(m);var v=nt(Object.assign(f,g.attributes));return new jn(this,n,e,m,p,u,h,t.startTime,void 0,v)},e.prototype.startActiveSpan=function(e,t,n,r){var o,i,s;if(!(arguments.length<2)){2===arguments.length?s=t:3===arguments.length?(o=t,s=n):(o=t,i=n,s=r);var a=null!=i?i:Le.active(),c=this.startSpan(e,o,a),u=ze.setSpan(a,c);return Le.with(u,s,void 0,c)}},e.prototype.getGeneralLimits=function(){return this._generalLimits},e.prototype.getSpanLimits=function(){return this._spanLimits},e.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},e}();var rr,or=function(){return or=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},or.apply(this,arguments)},ir=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},sr=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ar=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},cr=function(){function e(e,t){var n,r=this;this._attributes=e,this.asyncAttributesPending=null!=t,this._syncAttributes=null!==(n=this._attributes)&&void 0!==n?n:{},this._asyncAttributesPromise=null==t?void 0:t.then((function(e){return r._attributes=Object.assign({},r._attributes,e),r.asyncAttributesPending=!1,e}),(function(e){return Me.debug("a resource's async attributes promise rejected: %s",e),r.asyncAttributesPending=!1,{}}))}return e.empty=function(){return e.EMPTY},e.default=function(){var t;return new e(((t={})["service.name"]="unknown_service",t[Ut]=jt[Ut],t[Dt]=jt[Dt],t[Ft]=jt[Ft],t))},Object.defineProperty(e.prototype,"attributes",{get:function(){var e;return this.asyncAttributesPending&&Me.error("Accessing resource attributes before async attributes settled"),null!==(e=this._attributes)&&void 0!==e?e:{}},enumerable:!1,configurable:!0}),e.prototype.waitForAsyncAttributes=function(){return ir(this,void 0,void 0,(function(){return sr(this,(function(e){switch(e.label){case 0:return this.asyncAttributesPending?[4,this._asyncAttributesPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.merge=function(t){var n,r=this;if(!t)return this;var o=or(or({},this._syncAttributes),null!==(n=t._syncAttributes)&&void 0!==n?n:t.attributes);if(!this._asyncAttributesPromise&&!t._asyncAttributesPromise)return new e(o);var i=Promise.all([this._asyncAttributesPromise,t._asyncAttributesPromise]).then((function(e){var n,o=ar(e,2),i=o[0],s=o[1];return or(or(or(or({},r._syncAttributes),i),null!==(n=t._syncAttributes)&&void 0!==n?n:t.attributes),s)}));return new e(o,i)},e.EMPTY=new e({}),e}(),ur=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},lr=function(){function e(e){this._spanProcessors=e}return e.prototype.forceFlush=function(){var e,t,n=[];try{for(var r=ur(this._spanProcessors),o=r.next();!o.done;o=r.next()){var i=o.value;n.push(i.forceFlush())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return new Promise((function(e){Promise.all(n).then((function(){e()})).catch((function(t){ct(t||new Error("MultiSpanProcessor: forceFlush failed")),e()}))}))},e.prototype.onStart=function(e,t){var n,r;try{for(var o=ur(this._spanProcessors),i=o.next();!i.done;i=o.next()){i.value.onStart(e,t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.prototype.onEnd=function(e){var t,n;try{for(var r=ur(this._spanProcessors),o=r.next();!o.done;o=r.next()){o.value.onEnd(e)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.shutdown=function(){var e,t,n=[];try{for(var r=ur(this._spanProcessors),o=r.next();!o.done;o=r.next()){var i=o.value;n.push(i.shutdown())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return new Promise((function(e,t){Promise.all(n).then((function(){e()}),t)}))},e}(),dr=function(){function e(){}return e.prototype.onStart=function(e,t){},e.prototype.onEnd=function(e){},e.prototype.shutdown=function(){return Promise.resolve()},e.prototype.forceFlush=function(){return Promise.resolve()},e}();!function(e){e[e.resolved=0]="resolved",e[e.timeout=1]="timeout",e[e.error=2]="error",e[e.unresolved=3]="unresolved"}(rr||(rr={}));var pr,hr,fr,gr,mr=function(){function e(e){var t;void 0===e&&(e={}),this._registeredSpanProcessors=[],this._tracers=new Map;var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=e.shift(),r=new WeakMap;e.length>0;)n=Tn(n,e.shift(),0,r);return n}({},Yn(),Zn(e));this.resource=null!==(t=n.resource)&&void 0!==t?t:cr.empty(),this.resource=cr.default().merge(this.resource),this._config=Object.assign({},n,{resource:this.resource});var r=this._buildExporterFromEnv();if(void 0!==r){var o=new $n(r);this.activeSpanProcessor=o}else this.activeSpanProcessor=new dr}return e.prototype.getTracer=function(e,t,n){var r=e+"@"+(t||"")+":"+((null==n?void 0:n.schemaUrl)||"");return this._tracers.has(r)||this._tracers.set(r,new nr({name:e,version:t,schemaUrl:null==n?void 0:n.schemaUrl},this._config,this)),this._tracers.get(r)},e.prototype.addSpanProcessor=function(e){0===this._registeredSpanProcessors.length&&this.activeSpanProcessor.shutdown().catch((function(e){return Me.error("Error while trying to shutdown current span processor",e)})),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new lr(this._registeredSpanProcessors)},e.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},e.prototype.register=function(e){void 0===e&&(e={}),ze.setGlobalTracerProvider(this),void 0===e.propagator&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&Le.setGlobalContextManager(e.contextManager),e.propagator&&Xe.setGlobalPropagator(e.propagator)},e.prototype.forceFlush=function(){var e=this._config.forceFlushTimeoutMillis,t=this._registeredSpanProcessors.map((function(t){return new Promise((function(n){var r,o=setTimeout((function(){n(new Error("Span processor did not completed within timeout period of "+e+" ms")),r=rr.timeout}),e);t.forceFlush().then((function(){clearTimeout(o),r!==rr.timeout&&(r=rr.resolved,n(r))})).catch((function(e){clearTimeout(o),r=rr.error,n(e)}))}))}));return new Promise((function(e,n){Promise.all(t).then((function(t){var r=t.filter((function(e){return e!==rr.resolved}));r.length>0?n(r):e()})).catch((function(e){return n([e])}))}))},e.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},e.prototype._getPropagator=function(e){var t;return null===(t=this.constructor._registeredPropagators.get(e))||void 0===t?void 0:t()},e.prototype._getSpanExporter=function(e){var t;return null===(t=this.constructor._registeredExporters.get(e))||void 0===t?void 0:t()},e.prototype._buildPropagatorFromEnv=function(){var e=this,t=Array.from(new Set(It().OTEL_PROPAGATORS)),n=t.map((function(t){var n=e._getPropagator(t);return n||Me.warn('Propagator "'+t+'" requested through environment variable is unavailable.'),n})).reduce((function(e,t){return t&&e.push(t),e}),[]);return 0===n.length?void 0:1===t.length?n[0]:new $t({propagators:n})},e.prototype._buildExporterFromEnv=function(){var e=It().OTEL_TRACES_EXPORTER;if("none"!==e&&""!==e){var t=this._getSpanExporter(e);return t||Me.error('Exporter "'+e+'" requested through environment variable is unavailable.'),t}},e._registeredPropagators=new Map([["tracecontext",function(){return new ln}],["baggage",function(){return new Qe}]]),e._registeredExporters=new Map,e}();function vr(e){return"string"==typeof e}function yr(e,t,n=!1){return!!vr(e)&&(function(e){return e instanceof RegExp}(t)?t.test(e):!!vr(t)&&(n?e===t:e.includes(t)))}function Er(e){return e?(+e^16*Math.random()>>+e/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,Er)}function br(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function Sr(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}e.CoralogixEventType=void 0,(pr=e.CoralogixEventType||(e.CoralogixEventType={})).ERROR="error",pr.NETWORK_REQUEST="network-request",pr.LOG="log",pr.USER_INTERACTION="user-interaction",pr.WEB_VITALS="web-vitals",pr.LONG_TASK="longtask",pr.RESOURCES="resources",pr.INTERNAL="internal",pr.DOM="dom",pr.CUSTOM_MEASUREMENT="custom-measurement",pr.MEMORY_USAGE="memory-usage",pr.SCREENSHOT="screenshot",pr.CUSTOM_SPAN="custom-span",pr.WORKER="web-worker",e.PerformanceTypes=void 0,(hr=e.PerformanceTypes||(e.PerformanceTypes={})).Resource="resource",hr.LongTask="longtask",hr.Navigation="navigation",hr.SoftNavigation="soft-navigation",e.OtelNetworkAttrs=void 0,(fr=e.OtelNetworkAttrs||(e.OtelNetworkAttrs={})).METHOD="http.method",fr.URL="http.url",fr.STATUS_CODE="http.status_code",fr.HOST="http.host",fr.SCHEME="http.scheme",fr.STATUS_TEXT="http.status_text",fr.RESPONSE_CONTENT_LENGTH="http.response_content_length",e.UrlType=void 0,(gr=e.UrlType||(e.UrlType={})).PAGE="page",gr.NETWORK_REQUEST="network_request","function"==typeof SuppressedError&&SuppressedError;var Tr,_r,Cr=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ir=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Or=function(){function e(){this._enabled=!1,this._currentContext=A}return e.prototype._bindFunction=function(e,t){void 0===e&&(e=A);var n=this,r=function(){for(var r=this,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return n.with(e,(function(){return t.apply(r,o)}))};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:t.length}),r},e.prototype.active=function(){return this._currentContext},e.prototype.bind=function(e,t){return void 0===e&&(e=this.active()),"function"==typeof t?this._bindFunction(e,t):t},e.prototype.disable=function(){return this._currentContext=A,this._enabled=!1,this},e.prototype.enable=function(){return this._enabled||(this._enabled=!0,this._currentContext=A),this},e.prototype.with=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i=this._currentContext;this._currentContext=e||A;try{return t.call.apply(t,Ir([n],Cr(r),!1))}finally{this._currentContext=i}},e}(),wr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rr=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;if(t.contextManager)throw"contextManager should be defined in register method not in constructor";if(t.propagator)throw"propagator should be defined in register method not in constructor";return n}return wr(t,e),t.prototype.register=function(t){void 0===t&&(t={}),void 0===t.contextManager&&(t.contextManager=new Or),t.contextManager&&t.contextManager.enable(),e.prototype.register.call(this,t)},t}(mr);function Ar(e,t){return t in e}function Nr(e,t,n,r){var o=void 0,i=void 0;Ar(n,t)&&"number"==typeof n[t]&&(o=n[t]);var s=Tr.FETCH_START;if(Ar(n,s)&&"number"==typeof n[s]&&(i=n[s]),void 0!==o&&void 0!==i&&o>=i)return e.addEvent(t,o),e}function Lr(e,t){Nr(e,Tr.FETCH_START,t),Nr(e,Tr.DOMAIN_LOOKUP_START,t),Nr(e,Tr.DOMAIN_LOOKUP_END,t),Nr(e,Tr.CONNECT_START,t),Ar(t,"name")&&t.name.startsWith("https:")&&Nr(e,Tr.SECURE_CONNECTION_START,t),Nr(e,Tr.CONNECT_END,t),Nr(e,Tr.REQUEST_START,t),Nr(e,Tr.RESPONSE_START,t),Nr(e,Tr.RESPONSE_END,t);var n=t[Tr.ENCODED_BODY_SIZE];void 0!==n&&e.setAttribute("http.response_content_length",n);var r=t[Tr.DECODED_BODY_SIZE];void 0!==r&&n!==r&&e.setAttribute("http.response_content_length_uncompressed",r)}function Mr(){return"undefined"!=typeof location?location.origin:void 0}function xr(e,t,n,r,o,i){void 0===o&&(o=new WeakSet);var s=kr(e),a=function(e,t,n,r,o,i){var s=zt(t),a=zt(n),c=r.filter((function(t){var n=zt(Yt(t[Tr.FETCH_START])),r=zt(Yt(t[Tr.RESPONSE_END]));return t.initiatorType.toLowerCase()===(i||"xmlhttprequest")&&t.name===e&&n>=s&&r<=a}));c.length>0&&(c=c.filter((function(e){return!o.has(e)})));return c}(e=s.toString(),t,n,r,o,i);if(0===a.length)return{mainRequest:void 0};if(1===a.length)return{mainRequest:a[0]};var c=function(e){return e.slice().sort((function(e,t){var n=e[Tr.FETCH_START],r=t[Tr.FETCH_START];return n>r?1:n<r?-1:0}))}(a);if(s.origin!==Mr()&&c.length>1){var u=c[0],l=function(e,t,n){for(var r,o=zt(n),i=zt(Yt(t)),s=e[1],a=e.length,c=1;c<a;c++){var u=e[c],l=zt(Yt(u[Tr.FETCH_START])),d=o-zt(Yt(u[Tr.RESPONSE_END]));l>=i&&(!r||d<r)&&(r=d,s=u)}return s}(c,u[Tr.RESPONSE_END],n),d=u[Tr.RESPONSE_END];return l[Tr.FETCH_START]<d&&(l=u,u=void 0),{corsPreFlightRequest:u,mainRequest:l}}return{mainRequest:a[0]}}function kr(e){if("function"==typeof URL)return new URL(e,"undefined"!=typeof document?document.baseURI:"undefined"!=typeof location?location.href:void 0);var t=(_r||(_r=document.createElement("a")),_r);return t.href=e,t}function Pr(e,t){if(e.nodeType===Node.DOCUMENT_NODE)return"/";var n=function(e,t){var n=e.nodeType,r=function(e){if(!e.parentNode)return 0;var t=[e.nodeType];e.nodeType===Node.CDATA_SECTION_NODE&&t.push(Node.TEXT_NODE);var n=Array.from(e.parentNode.childNodes);if(n=n.filter((function(n){var r=n.localName;return t.indexOf(n.nodeType)>=0&&r===e.localName})),n.length>=1)return n.indexOf(e)+1;return 0}(e),o="";if(n===Node.ELEMENT_NODE){var i=e.getAttribute("id");if(t&&i)return'//*[@id="'+i+'"]';o=e.localName}else if(n===Node.TEXT_NODE||n===Node.CDATA_SECTION_NODE)o="text()";else{if(n!==Node.COMMENT_NODE)return"";o="comment()"}if(o&&r>1)return"/"+o+"["+r+"]";return"/"+o}(e,t);if(t&&n.indexOf("@id")>0)return n;var r="";return e.parentNode&&(r+=Pr(e.parentNode,!1)),r+=n}function Dr(e,t){var n=t||[];return("string"==typeof n||n instanceof RegExp)&&(n=[n]),kr(e).origin===Mr()||n.some((function(t){return An(e,t)}))}!function(e){e.CONNECT_END="connectEnd",e.CONNECT_START="connectStart",e.DECODED_BODY_SIZE="decodedBodySize",e.DOM_COMPLETE="domComplete",e.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",e.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",e.DOM_INTERACTIVE="domInteractive",e.DOMAIN_LOOKUP_END="domainLookupEnd",e.DOMAIN_LOOKUP_START="domainLookupStart",e.ENCODED_BODY_SIZE="encodedBodySize",e.FETCH_START="fetchStart",e.LOAD_EVENT_END="loadEventEnd",e.LOAD_EVENT_START="loadEventStart",e.NAVIGATION_START="navigationStart",e.REDIRECT_END="redirectEnd",e.REDIRECT_START="redirectStart",e.REQUEST_START="requestStart",e.RESPONSE_END="responseEnd",e.RESPONSE_START="responseStart",e.SECURE_CONNECTION_START="secureConnectionStart",e.UNLOAD_EVENT_END="unloadEventEnd",e.UNLOAD_EVENT_START="unloadEventStart"}(Tr||(Tr={}));var Ur=function(){function e(){}return e.prototype.emit=function(e){},e}(),Fr=new(function(){function e(){}return e.prototype.getLogger=function(e,t,n){return new Ur},e}()),jr="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},Br=Symbol.for("io.opentelemetry.js.api.logs"),Wr=jr;var Gr,Vr,Hr=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalLoggerProvider=function(e){return Wr[Br]?this.getLoggerProvider():(Wr[Br]=(t=1,n=e,r=Fr,function(e){return e===t?n:r}),e);var t,n,r},e.prototype.getLoggerProvider=function(){var e,t;return null!==(t=null===(e=Wr[Br])||void 0===e?void 0:e.call(Wr,1))&&void 0!==t?t:Fr},e.prototype.getLogger=function(e,t,n){return this.getLoggerProvider().getLogger(e,t,n)},e.prototype.disable=function(){delete Wr[Br]},e}(),Xr=Hr.getInstance();function Yr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zr,Kr=function(){if(Vr)return Gr;function e(e){return"function"==typeof e}Vr=1;var t=console.error.bind(console);function n(e,t,n){var r=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:r,writable:!0,value:n})}function r(n){n&&n.logger&&(e(n.logger)?t=n.logger:t("new logger isn't a function, not replacing"))}function o(r,o,i){if(r&&r[o]){if(!i)return t("no wrapper function"),void t((new Error).stack);if(e(r[o])&&e(i)){var s=r[o],a=i(s,o);return n(a,"__original",s),n(a,"__unwrap",(function(){r[o]===a&&n(r,o,s)})),n(a,"__wrapped",!0),n(r,o,a),a}t("original object and wrapper must be functions")}else t("no original function "+o+" to wrap")}function i(e,n){return e&&e[n]?e[n].__unwrap?e[n].__unwrap():void t("no original to unwrap to -- has "+n+" already been unwrapped?"):(t("no function to unwrap."),void t((new Error).stack))}return r.wrap=o,r.massWrap=function(e,n,r){if(!e)return t("must provide one or more modules to patch"),void t((new Error).stack);Array.isArray(e)||(e=[e]),n&&Array.isArray(n)?e.forEach((function(e){n.forEach((function(t){o(e,t,r)}))})):t("must provide one or more functions to wrap on modules")},r.unwrap=i,r.massUnwrap=function(e,n){if(!e)return t("must provide one or more modules to patch"),void t((new Error).stack);Array.isArray(e)||(e=[e]),n&&Array.isArray(n)?e.forEach((function(e){n.forEach((function(t){i(e,t)}))})):t("must provide one or more functions to unwrap on modules")},Gr=r}(),Zr=function(){return Zr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Zr.apply(this,arguments)},Jr=function(){function e(e,t,n){this.instrumentationName=e,this.instrumentationVersion=t,this._wrap=Kr.wrap,this._unwrap=Kr.unwrap,this._massWrap=Kr.massWrap,this._massUnwrap=Kr.massUnwrap,this._config=Zr({enabled:!0},n),this._diag=Me.createComponentLogger({namespace:e}),this._tracer=ze.getTracer(e,t),this._meter=Pe.getMeter(e,t),this._logger=Xr.getLogger(e,t),this._updateMetricInstruments()}return Object.defineProperty(e.prototype,"meter",{get:function(){return this._meter},enumerable:!1,configurable:!0}),e.prototype.setMeterProvider=function(e){this._meter=e.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()},Object.defineProperty(e.prototype,"logger",{get:function(){return this._logger},enumerable:!1,configurable:!0}),e.prototype.setLoggerProvider=function(e){this._logger=e.getLogger(this.instrumentationName,this.instrumentationVersion)},e.prototype.getModuleDefinitions=function(){var e,t=null!==(e=this.init())&&void 0!==e?e:[];return Array.isArray(t)?t:[t]},e.prototype._updateMetricInstruments=function(){},e.prototype.getConfig=function(){return this._config},e.prototype.setConfig=function(e){this._config=Zr({},e)},e.prototype.setTracerProvider=function(e){this._tracer=e.getTracer(this.instrumentationName,this.instrumentationVersion)},Object.defineProperty(e.prototype,"tracer",{get:function(){return this._tracer},enumerable:!1,configurable:!0}),e.prototype._runSpanCustomizationHook=function(e,t,n,r){if(e)try{e(n,r)}catch(e){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:t},e)}},e}(),qr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$r=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o._config.enabled&&o.enable(),o}return qr(t,e),t}(Jr);function Qr(e,t,n){var r,o;try{o=e()}catch(e){r=e}finally{return t(r,o),o}}function eo(e){return"function"==typeof e&&"function"==typeof e.__original&&"function"==typeof e.__unwrap&&!0===e.__wrapped}e.CoralogixLogSeverity=void 0,(zr=e.CoralogixLogSeverity||(e.CoralogixLogSeverity={}))[zr.Debug=1]="Debug",zr[zr.Verbose=2]="Verbose",zr[zr.Info=3]="Info",zr[zr.Warn=4]="Warn",zr[zr.Error=5]="Error",zr[zr.Critical=6]="Critical";var to,no={exports:{}},ro={exports:{}};function oo(){return to||(to=1,ro.exports=function(){function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t(e){return e.charAt(0).toUpperCase()+e.substring(1)}function n(e){return function(){return this[e]}}var r=["isConstructor","isEval","isNative","isToplevel"],o=["columnNumber","lineNumber"],i=["fileName","functionName","source"],s=["args"],a=["evalOrigin"],c=r.concat(o,i,s,a);function u(e){if(e)for(var n=0;n<c.length;n++)void 0!==e[c[n]]&&this["set"+t(c[n])](e[c[n]])}u.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof u)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new u(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",n=this.getColumnNumber()||"",r=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+n+")":"[eval]:"+t+":"+n:r?r+" ("+e+":"+t+":"+n+")":e+":"+t+":"+n}},u.fromString=function(e){var t=e.indexOf("("),n=e.lastIndexOf(")"),r=e.substring(0,t),o=e.substring(t+1,n).split(","),i=e.substring(n+1);if(0===i.indexOf("@"))var s=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(i,""),a=s[1],c=s[2],l=s[3];return new u({functionName:r,args:o||void 0,fileName:a,lineNumber:c||void 0,columnNumber:l||void 0})};for(var l=0;l<r.length;l++)u.prototype["get"+t(r[l])]=n(r[l]),u.prototype["set"+t(r[l])]=function(e){return function(t){this[e]=Boolean(t)}}(r[l]);for(var d=0;d<o.length;d++)u.prototype["get"+t(o[d])]=n(o[d]),u.prototype["set"+t(o[d])]=function(t){return function(n){if(!e(n))throw new TypeError(t+" must be a Number");this[t]=Number(n)}}(o[d]);for(var p=0;p<i.length;p++)u.prototype["get"+t(i[p])]=n(i[p]),u.prototype["set"+t(i[p])]=function(e){return function(t){this[e]=String(t)}}(i[p]);return u}()),ro.exports}var io;var so=(io||(io=1,no.exports=function(e){var t=/(^|@)\S+:\d+/,n=/^\s*at .*(\S+:\d+|\(native\))/m,r=/^(eval@)?(\[native code])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(n))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter((function(e){return!!e.match(n)}),this).map((function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var n=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),r=n.match(/ (\(.+\)$)/);n=r?n.replace(r[0],""):n;var o=this.extractLocation(r?r[1]:n),i=r&&n||void 0,s=["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0];return new e({functionName:i,fileName:s,lineNumber:o[1],columnNumber:o[2],source:t})}),this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter((function(e){return!e.match(r)}),this).map((function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e({functionName:t});var n=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=t.match(n),o=r&&r[1]?r[1]:void 0,i=this.extractLocation(t.replace(n,""));return new e({functionName:o,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:t})}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,r=t.message.split("\n"),o=[],i=2,s=r.length;i<s;i+=2){var a=n.exec(r[i]);a&&o.push(new e({fileName:a[2],lineNumber:a[1],source:r[i]}))}return o},parseOpera10:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=t.stacktrace.split("\n"),o=[],i=0,s=r.length;i<s;i+=2){var a=n.exec(r[i]);a&&o.push(new e({functionName:a[3]||void 0,fileName:a[2],lineNumber:a[1],source:r[i]}))}return o},parseOpera11:function(n){return n.stack.split("\n").filter((function(e){return!!e.match(t)&&!e.match(/^Error created at/)}),this).map((function(t){var n,r=t.split("@"),o=this.extractLocation(r.pop()),i=r.shift()||"",s=i.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;i.match(/\(([^)]*)\)/)&&(n=i.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var a=void 0===n||"[arguments not available]"===n?void 0:n.split(",");return new e({functionName:s,args:a,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:t})}),this)}}}(oo())),no.exports),ao=Yr(so);const co=6e4;function uo(){return(new Date).getTime()}const lo={"Content-Encoding":"gzip"},po=1e3,ho="rum_session",fo="rum_prev_session",go={sessionSampleRate:100,onlyWithErrorConfig:{enable:!1}},mo="rumSessionManager",vo="rumSessionRecorder",yo="rumSessionRecorderSegmentsMap",Eo="rumSnapshotManager",bo={errorCount:0,viewCount:0,actionCount:0,hasRecording:!1,hasScreenshot:!1};function So(){if("object"==typeof globalThis)return globalThis;Object.defineProperty(Object.prototype,"__cx_global__",{get(){return this},configurable:!0});let e=__cx_global__;return delete Object.prototype.__cx_global__,"object"!=typeof e&&(e="object"==typeof self?self:"object"==typeof window?window:{}),e}const To=So();function _o(){return To[Eo]}function Co(){return To[mo]}function Io(){return To[vo]}function Oo(){return To[qa]}function wo(){return To[$a]}const Ro="__globalSpan__",Ao="__globalSpanMap__",No="__customTracer__",Lo="__customTracerIgnoredInstruments__";function Mo(){return To[Ro]}function xo(){delete To[Ro]}function ko(e){return Mo()&&!Po(e)}function Po(e){var t;return!!(null===(t=To[Lo])||void 0===t?void 0:t.includes(e))}function Do(e){return Mo().startCustomSpan(e).span}const Uo="otelReady",Fo="attrProcessor";var jo;function Bo(e){e[Uo]=!0}function Wo(e,t={}){e.setAttribute(lc.CUSTOM_LABELS,JSON.stringify(Go(t)))}function Go(e={}){var t;const n=(null===(t=To[Fo])||void 0===t?void 0:t.getCustomLabels())||{};return Object.assign(Object.assign({},n),e)}!function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(jo||(jo={}));const Vo="__cx_metadata__",Ho="errors",Xo={TYPE:"error_type",STACK:"error_stack",MESSAGE:"error_message",DATA:"error_custom_data"};var Yo;function zo(e,t){return Sr(this,void 0,void 0,(function*(){const{stack:n,message:r,name:o}=t,i=!!(null==n?void 0:n.includes("at "));if(t&&i){const{supportMfe:t}=Oo(),i=ao.parse({stack:n.substring(0,4096),message:r,name:o}).map((({fileName:e,columnNumber:t,lineNumber:n,functionName:r})=>({fileName:e,columnNumber:t,lineNumber:n,functionName:r})));t&&(yield function(e,t){return Sr(this,void 0,void 0,(function*(){for(let t=0;t<e.length;t++){const n=yield Ko(e[t].fileName);e[t]=Object.assign(Object.assign({},e[t]),n||{isShell:!0})}const[n]=e;!function(e,t){const{app:n,version:r,isShell:o}=t;o||Wo(e,{mfeApp:n,mfeVersion:r})}(t,n)}))}(i,e)),e[Xo.STACK]=i}}))}function Ko(){return Sr(this,arguments,void 0,(function*(e=""){let t;const n=To[Vo],[r]=e.match(/https?:\/\/.*\//);if(r){let e;if(null==n?void 0:n.has(r))t=null==n?void 0:n.get(r);else{try{e=yield fetch(`${r}cx-metadata.json`,{cache:"no-cache"}),t=Object.assign(Object.assign({},yield e.json()),{mfePath:r})}catch(e){Oo().debug&&console.warn("Coralogix Browser SDK - Error fetching metadata",e)}To[Vo]=n.set(r,t)}}return t}))}!function(e){e.CONSOLE="console",e.WINDOW="window",e.UNHANDLED_REJECTION="unhandledrejection",e.DOCUMENT="document",e.CAPTURED="captured",e.WEB_WORKER="web_worker"}(Yo||(Yo={}));const Zo=e=>t=>{e.report(Yo.WINDOW,t)},Jo=e=>t=>{e.report(Yo.UNHANDLED_REJECTION,t.reason)},qo=e=>t=>{e.report(Yo.DOCUMENT,t)};function $o(t){t.setAttribute(lc.EVENT_TYPE,e.CoralogixEventType.ERROR),t.setAttribute(lc.SEVERITY,e.CoralogixLogSeverity.Error)}var Qo;!function(e){e.COMPONENT="component",e.HTTP_ERROR_NAME="http.error_name",e.HTTP_STATUS_TEXT="http.status_text"}(Qo||(Qo={}));var ei,ti="0.52.1",ni=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ri="object"==typeof process&&"node"===(null===(ei=process.release)||void 0===ei?void 0:ei.name),oi=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,"@opentelemetry/instrumentation-fetch",ti,t)||this;return n.component="fetch",n.version=ti,n.moduleName=n.component,n._usedResources=new WeakSet,n._tasksCount=0,n}return ni(t,e),t.prototype.init=function(){},t.prototype._addChildSpan=function(e,t){var n=this.tracer.startSpan("CORS Preflight",{startTime:t[Tr.FETCH_START]},ze.setSpan(Le.active(),e));this.getConfig().ignoreNetworkEvents||Lr(n,t),n.end(t[Tr.RESPONSE_END])},t.prototype._addFinalSpanAttributes=function(e,t){var n=kr(t.url);e.setAttribute(kt,t.status),null!=t.statusText&&e.setAttribute(Qo.HTTP_STATUS_TEXT,t.statusText),e.setAttribute(Mt,n.host),e.setAttribute(xt,n.protocol.replace(":","")),"undefined"!=typeof navigator&&e.setAttribute(Pt,navigator.userAgent)},t.prototype._addHeaders=function(e,t){if(!Dr(t,this.getConfig().propagateTraceHeaderCorsUrls)){var n={};return Xe.inject(Le.active(),n),void(Object.keys(n).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}if(e instanceof Request)Xe.inject(Le.active(),e.headers,{set:function(e,t,n){return e.set(t,"string"==typeof n?n:String(n))}});else if(e.headers instanceof Headers)Xe.inject(Le.active(),e.headers,{set:function(e,t,n){return e.set(t,"string"==typeof n?n:String(n))}});else if(e.headers instanceof Map)Xe.inject(Le.active(),e.headers,{set:function(e,t,n){return e.set(t,"string"==typeof n?n:String(n))}});else{n={};Xe.inject(Le.active(),n),e.headers=Object.assign({},n,e.headers||{})}},t.prototype._clearResources=function(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)},t.prototype._createSpan=function(e,t){var n;if(void 0===t&&(t={}),!Nn(e,this.getConfig().ignoreUrls)){var r=(t.method||"GET").toUpperCase(),o="HTTP "+r;return this.tracer.startSpan(o,{kind:Ie.CLIENT,attributes:(n={},n[Qo.COMPONENT]=this.moduleName,n[Nt]=r,n[Lt]=e,n)})}this._diag.debug("ignoring span as url matches ignored url")},t.prototype._findResourceAndAddNetworkEvents=function(e,t,n){var r=t.entries;if(!r.length){if(!performance.getEntriesByType)return;r=performance.getEntriesByType("resource")}var o=xr(t.spanUrl,t.startTime,n,r,this._usedResources,"fetch");if(o.mainRequest){var i=o.mainRequest;this._markResourceAsUsed(i);var s=o.corsPreFlightRequest;s&&(this._addChildSpan(e,s),this._markResourceAsUsed(s)),this.getConfig().ignoreNetworkEvents||Lr(e,i)}},t.prototype._markResourceAsUsed=function(e){this._usedResources.add(e)},t.prototype._endSpan=function(e,t,n){var r=this,o=Vt(Date.now()),i=Xt();this._addFinalSpanAttributes(e,n),setTimeout((function(){var n;null===(n=t.observer)||void 0===n||n.disconnect(),r._findResourceAndAddNetworkEvents(e,t,i),r._tasksCount--,r._clearResources(),e.end(o)}),300)},t.prototype._patchConstructor=function(){var e=this;return function(t){var n=e;return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=this,i=kr(e[0]instanceof Request?e[0].url:String(e[0])).href,s=e[0]instanceof Request?e[0]:e[1]||{},a=n._createSpan(i,s);if(!a)return t.apply(this,e);var c=n._prepareSpanData(i);function u(e,t){n._applyAttributesAfterFetch(e,s,t),n._endSpan(e,c,{status:t.status||0,statusText:t.message,url:i})}function l(e,t){n._applyAttributesAfterFetch(e,s,t),t.status>=200&&t.status<400?n._endSpan(e,c,t):n._endSpan(e,c,{status:t.status,statusText:t.statusText,url:i})}function d(e,t,n){try{var r=n.clone(),o=n.clone(),i=r.body;if(i){var s=i.getReader(),a=function(){s.read().then((function(t){t.done?l(e,o):a()}),(function(t){u(e,t)}))};a()}else l(e,n)}finally{t(n)}}function p(e,t,n){try{u(e,n)}finally{t(n)}}return new Promise((function(e,r){return Le.with(ze.setSpan(Le.active(),a),(function(){return n._addHeaders(s,i),n._tasksCount++,t.apply(o,s instanceof Request?[s]:[i,s]).then(d.bind(o,a,e),p.bind(o,a,r))}))}))}}},t.prototype._applyAttributesAfterFetch=function(e,t,n){var r=this,o=this.getConfig().applyCustomAttributesOnSpan;o&&Qr((function(){return o(e,t,n)}),(function(e){e&&r._diag.error("applyCustomAttributesOnSpan",e)}))},t.prototype._prepareSpanData=function(e){var t=Xt(),n=[];if("function"!=typeof PerformanceObserver)return{entries:n,startTime:t,spanUrl:e};var r=new PerformanceObserver((function(t){t.getEntries().forEach((function(t){"fetch"===t.initiatorType&&t.name===e&&n.push(t)}))}));return r.observe({entryTypes:["resource"]}),{entries:n,observer:r,startTime:t,spanUrl:e}},t.prototype.enable=function(){ri?this._diag.warn("this instrumentation is intended for web usage only, it does not instrument Node.js's fetch()"):(eo(fetch)&&(this._unwrap(Ct,"fetch"),this._diag.debug("removing previous patch for constructor")),this._wrap(Ct,"fetch",this._patchConstructor()))},t.prototype.disable=function(){ri||(this._unwrap(Ct,"fetch"),this._usedResources=new WeakSet)},t}($r);const ii=e=>{var t;const{traceParentInHeader:n}=e,r=null===(t=null==n?void 0:n.options)||void 0===t?void 0:t.propagateTraceHeaderCorsUrls;(null==n?void 0:n.enabled)&&r&&(e.propagateTraceHeaderCorsUrls=r)};class si{constructor(){this.responseBodyParsers=new Map([[ai.Json,e=>Sr(this,void 0,void 0,(function*(){return JSON.stringify(yield e.json())}))],[ai.TextPlain,e=>Sr(this,void 0,void 0,(function*(){return yield e.text()}))],[ai.TextHtml,e=>Sr(this,void 0,void 0,(function*(){return yield e.text()}))],[ai.TextCss,e=>Sr(this,void 0,void 0,(function*(){return yield e.text()}))],[ai.TextJavascript,e=>Sr(this,void 0,void 0,(function*(){return yield e.text()}))],[ai.Xml,e=>Sr(this,void 0,void 0,(function*(){return yield e.text()}))],[ai.FormData,e=>Sr(this,void 0,void 0,(function*(){return yield e.text()}))]]),this.requestBodySerializers=new Map([[ci.String,e=>Sr(this,void 0,void 0,(function*(){return e}))],[ci.Blob,e=>Sr(this,void 0,void 0,(function*(){return e.text()}))],[ci.FormData,e=>Sr(this,void 0,void 0,(function*(){return this.serializeFormData(e)}))],[ci.URLSearchParams,e=>Sr(this,void 0,void 0,(function*(){return e.toString()}))],[ci.JsonObject,e=>Sr(this,void 0,void 0,(function*(){return JSON.stringify(e)}))]])}resolveConfigForUrl(e,t=[]){return t.find((({url:t})=>t===e||t instanceof RegExp&&t.test(e)))}stringifyRequestBody(e){return Sr(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.body))return"";const t=yield this.serializeRequestBody(e.body);return this.truncateIfExceedsLimit(t)}))}stringifyResponseBody(e){return Sr(this,void 0,void 0,(function*(){const t=(e.headers.get("content-type")||"").split(";")[0].trim(),n=this.responseBodyParsers.get(t);if(!n)return"";const r=yield n(e);return this.truncateIfExceedsLimit(r)}))}truncateIfExceedsLimit(e){return e.length>Za?void 0:e}serializeRequestBody(e){return Sr(this,void 0,void 0,(function*(){const t=this.requestBodySerializers.get(e.constructor.name);return t?yield t(e):""}))}serializeFormData(e){let t="";return e.forEach(((e,n)=>{t+=`${n}: ${e}\n`})),t.trim()}}var ai,ci;!function(e){e.Json="application/json",e.TextPlain="text/plain",e.TextHtml="text/html",e.TextCss="text/css",e.TextJavascript="application/javascript",e.Xml="application/xml",e.FormData="multipart/form-data"}(ai||(ai={})),function(e){e.String="String",e.Blob="Blob",e.FormData="FormData",e.URLSearchParams="URLSearchParams",e.JsonObject="JsonObject",e.Unknown="Unknown"}(ci||(ci={}));class ui{filterHeaders(e,t=[]){if(!e)return new Map;const n=this.normalizeHeaders(e),r=new Map;return t.forEach((e=>{const t=e.toLowerCase();n.has(t)&&r.set(e,n.get(t))})),r}normalizeHeaders(e){if("string"==typeof e)return this.normalizeHeadersFromString(e);const t=new Headers(e),n=new Map;return t.forEach(((e,t)=>{n.set(t.toLowerCase(),e)})),n}normalizeHeadersFromString(e){const t=new Map;if(!e)return t;return e.trim().split(/\r\n/).forEach((e=>{const[n,r]=e.split(": ",2);n&&r&&t.set(n.trim().toLowerCase(),r.trim())})),t}}const li="request_headers",di="response_headers",pi="response_payload",hi="request_payload";function fi(t){const n=function(e){var t;return null===(t=To[Ao])||void 0===t?void 0:t[e]}(t.spanContext().traceId);if(n&&!Po(e.CoralogixEventType.NETWORK_REQUEST)){const{traceId:e,spanId:r}=n.span.spanContext();t._spanContext.traceId=e,t.parentSpanId=r}}var gi,mi;!function(e){e.FETCH="fetch"}(gi||(gi={}));!function(e){e.METHOD_OPEN="open",e.METHOD_SEND="send",e.EVENT_ABORT="abort",e.EVENT_ERROR="error",e.EVENT_LOAD="loaded",e.EVENT_TIMEOUT="timeout"}(mi||(mi={}));var vi,yi="0.52.1";!function(e){e.HTTP_STATUS_TEXT="http.status_text"}(vi||(vi={}));var Ei,bi=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Si=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,"@opentelemetry/instrumentation-xml-http-request",yi,t)||this;return n.component="xml-http-request",n.version=yi,n.moduleName=n.component,n._tasksCount=0,n._xhrMem=new WeakMap,n._usedResources=new WeakSet,n}return bi(t,e),t.prototype.init=function(){},t.prototype._addHeaders=function(e,t){if(!Dr(kr(t).href,this.getConfig().propagateTraceHeaderCorsUrls)){var n={};return Xe.inject(Le.active(),n),void(Object.keys(n).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}var r={};Xe.inject(Le.active(),r),Object.keys(r).forEach((function(t){e.setRequestHeader(t,String(r[t]))}))},t.prototype._addChildSpan=function(e,t){var n=this;Le.with(ze.setSpan(Le.active(),e),(function(){var e=n.tracer.startSpan("CORS Preflight",{startTime:t[Tr.FETCH_START]});n.getConfig().ignoreNetworkEvents||Lr(e,t),e.end(t[Tr.RESPONSE_END])}))},t.prototype._addFinalSpanAttributes=function(e,t,n){if("string"==typeof n){var r=kr(n);void 0!==t.status&&e.setAttribute(kt,t.status),void 0!==t.statusText&&e.setAttribute(vi.HTTP_STATUS_TEXT,t.statusText),e.setAttribute(Mt,r.host),e.setAttribute(xt,r.protocol.replace(":","")),e.setAttribute(Pt,navigator.userAgent)}},t.prototype._applyAttributesAfterXHR=function(e,t){var n=this,r=this.getConfig().applyCustomAttributesOnSpan;"function"==typeof r&&Qr((function(){return r(e,t)}),(function(e){e&&n._diag.error("applyCustomAttributesOnSpan",e)}))},t.prototype._addResourceObserver=function(e,t){var n=this._xhrMem.get(e);n&&"function"==typeof PerformanceObserver&&"function"==typeof PerformanceResourceTiming&&(n.createdResources={observer:new PerformanceObserver((function(e){var r=e.getEntries(),o=kr(t);r.forEach((function(e){"xmlhttprequest"===e.initiatorType&&e.name===o.href&&n.createdResources&&n.createdResources.entries.push(e)}))})),entries:[]},n.createdResources.observer.observe({entryTypes:["resource"]}))},t.prototype._clearResources=function(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(wt.clearResourceTimings(),this._xhrMem=new WeakMap,this._usedResources=new WeakSet)},t.prototype._findResourceAndAddNetworkEvents=function(e,t,n,r,o){if(n&&r&&o&&e.createdResources){var i=e.createdResources.entries;i&&i.length||(i=wt.getEntriesByType("resource"));var s=xr(kr(n).href,r,o,i,this._usedResources);if(s.mainRequest){var a=s.mainRequest;this._markResourceAsUsed(a);var c=s.corsPreFlightRequest;c&&(this._addChildSpan(t,c),this._markResourceAsUsed(c)),this.getConfig().ignoreNetworkEvents||Lr(t,a)}}},t.prototype._cleanPreviousSpanInformation=function(e){var t=this._xhrMem.get(e);if(t){var n=t.callbackToRemoveEvents;n&&n(),this._xhrMem.delete(e)}},t.prototype._createSpan=function(e,t,n){var r;if(!Nn(t,this.getConfig().ignoreUrls)){var o=n.toUpperCase(),i=this.tracer.startSpan(o,{kind:Ie.CLIENT,attributes:(r={},r[Nt]=n,r[Lt]=kr(t).toString(),r)});return i.addEvent(mi.METHOD_OPEN),this._cleanPreviousSpanInformation(e),this._xhrMem.set(e,{span:i,spanUrl:t}),i}this._diag.debug("ignoring span as url matches ignored url")},t.prototype._markResourceAsUsed=function(e){this._usedResources.add(e)},t.prototype._patchOpen=function(){var e=this;return function(t){var n=e;return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=e[0],i=e[1];return n._createSpan(this,i,o),t.apply(this,e)}}},t.prototype._patchSend=function(){var e=this;function t(t,n){var r=e._xhrMem.get(n);if(r){r.status=n.status,r.statusText=n.statusText,e._xhrMem.delete(n),r.span&&e._applyAttributesAfterXHR(r.span,n);var o=Xt(),i=Date.now();setTimeout((function(){!function(t,n,r,o){var i=n.callbackToRemoveEvents;"function"==typeof i&&i();var s=n.span,a=n.spanUrl,c=n.sendStartTime;s&&(e._findResourceAndAddNetworkEvents(n,s,a,c,r),s.addEvent(t,o),e._addFinalSpanAttributes(s,n,a),s.end(o),e._tasksCount--),e._clearResources()}(t,r,o,i)}),300)}}function n(){t(mi.EVENT_ERROR,this)}function r(){t(mi.EVENT_ABORT,this)}function o(){t(mi.EVENT_TIMEOUT,this)}function i(){this.status<299?t(mi.EVENT_LOAD,this):t(mi.EVENT_ERROR,this)}return function(t){return function(){for(var s=this,a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];var u=e._xhrMem.get(this);if(!u)return t.apply(this,a);var l=u.span,d=u.spanUrl;return l&&d&&Le.with(ze.setSpan(Le.active(),l),(function(){e._tasksCount++,u.sendStartTime=Xt(),l.addEvent(mi.METHOD_SEND),s.addEventListener("abort",r),s.addEventListener("error",n),s.addEventListener("load",i),s.addEventListener("timeout",o),u.callbackToRemoveEvents=function(){!function(t){t.removeEventListener("abort",r),t.removeEventListener("error",n),t.removeEventListener("load",i),t.removeEventListener("timeout",o);var s=e._xhrMem.get(t);s&&(s.callbackToRemoveEvents=void 0)}(s),u.createdResources&&u.createdResources.observer.disconnect()},e._addHeaders(s,d),e._addResourceObserver(s,d)})),t.apply(this,a)}}},t.prototype.enable=function(){this._diag.debug("applying patch to",this.moduleName,this.version),eo(XMLHttpRequest.prototype.open)&&(this._unwrap(XMLHttpRequest.prototype,"open"),this._diag.debug("removing previous patch from method open")),eo(XMLHttpRequest.prototype.send)&&(this._unwrap(XMLHttpRequest.prototype,"send"),this._diag.debug("removing previous patch from method send")),this._wrap(XMLHttpRequest.prototype,"open",this._patchOpen()),this._wrap(XMLHttpRequest.prototype,"send",this._patchSend())},t.prototype.disable=function(){this._diag.debug("removing patch from",this.moduleName,this.version),this._unwrap(XMLHttpRequest.prototype,"open"),this._unwrap(XMLHttpRequest.prototype,"send"),this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet},t}($r);!function(e){e.XHR="xhr"}(Ei||(Ei={}));var Ti;!function(e){e.CODE="code"}(Ti||(Ti={}));class _i extends $r{constructor(t){var n;super(e.CoralogixEventType.LOG,"1",t),this.stringifyCustomLogData=null===(n=Oo())||void 0===n?void 0:n.stringifyCustomLogData}init(){}disable(){}enable(){}log({severity:t,message:n,data:r,labels:o}){const i=this.tracer.startSpan(e.CoralogixEventType.LOG);i.setAttribute(lc.EVENT_TYPE,e.CoralogixEventType.LOG),i.setAttribute(lc.SOURCE,Ti.CODE),i.setAttribute(lc.SEVERITY,t),i.setAttribute(lc.LOG,JSON.stringify({severity:t,message:n,data:this.stringifyCustomLogData?JSON.stringify(r,Ic()):r})),o&&Wo(i,o),i.end()}}var Ci,Ii,Oi=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},wi=function(e){if("loading"===document.readyState)return"loading";var t=Oi();if(t){if(e<t.domInteractive)return"loading";if(0===t.domContentLoadedEventStart||e<t.domContentLoadedEventStart)return"dom-interactive";if(0===t.domComplete||e<t.domComplete)return"dom-content-loaded"}return"complete"},Ri=function(e){var t=e.nodeName;return 1===e.nodeType?t.toLowerCase():t.toUpperCase().replace(/^#/,"")},Ai=function(e,t){var n="";try{for(;e&&9!==e.nodeType;){var r=e,o=r.id?"#"+r.id:Ri(r)+(r.classList&&r.classList.value&&r.classList.value.trim()&&r.classList.value.trim().length?"."+r.classList.value.trim().replace(/\s+/g,"."):"");if(n.length+o.length>(t||100)-1)return n||o;if(n=n?o+">"+n:o,r.id)break;e=r.parentNode}}catch(e){}return n},Ni=function(e,t,n,r){var o,i;return function(s){t.value>=0&&(s||r)&&((i=t.value-(o||0))||void 0===o)&&(o=t.value,t.delta=i,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},Li=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},Mi=-1,xi=function(){return Mi},ki=function(e){addEventListener("pageshow",(function(t){t.persisted&&(Mi=t.timeStamp,e(t))}),!0)},Pi=function(){var e=Oi();return e&&e.activationStart||0},Di=function(e,t,n,r){var o,i=(null===(o=Oi())||void 0===o?void 0:o.navigationId)||"1",s=Oi(),a="navigate";return n?a=n:xi()>=0?a="back-forward-cache":s&&(document.prerendering||Pi()>0?a="prerender":document.wasDiscarded?a="restore":s.type&&(a=s.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:a,navigationId:r||i}},Ui=function(e){return PerformanceObserver.supportedEntryTypes.includes("soft-navigation")&&e&&e.reportSoftNavs},Fi=function(e){if(e){var t=window.performance.getEntriesByType("soft-navigation").filter((function(t){return t.navigationId===e}));return t?t[0]:void 0}},ji=function(e,t,n){var r=Ui(n);try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var o=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return o.observe(Object.assign({type:e,buffered:!0,includeSoftNavigationObservations:r},n||{})),o}}catch(e){}},Bi=function(e){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e()}))},Wi=function(e){var t=!1;return function(){t||(e(),t=!0)}},Gi=-1,Vi=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},Hi=function(e){"hidden"===document.visibilityState&&Gi>-1&&(Gi="visibilitychange"===e.type?e.timeStamp:0,Yi())},Xi=function(){addEventListener("visibilitychange",Hi,!0),addEventListener("prerenderingchange",Hi,!0)},Yi=function(){removeEventListener("visibilitychange",Hi,!0),removeEventListener("prerenderingchange",Hi,!0)},zi=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(Gi=-1),Gi<0&&(Gi=Vi(),Xi(),ki((function(){setTimeout((function(){Gi=Vi(),Xi()}),0)}))),{get firstHiddenTime(){return Gi}}},Ki=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},Zi=[1800,3e3],Ji=function(e,t){var n,r=Ui(t=t||{}),o=0,i=(null===(n=Oi())||void 0===n?void 0:n.navigationId)||"1";Ki((function(){var n,s=zi(),a=Di("FCP"),c=ji("paint",(function(u){u.forEach((function(u){if("first-contentful-paint"===u.name){r?u.navigationId&&u.navigationId!==a.navigationId&&function(r,i){a=Di("FCP",0,r,i),n=Ni(e,a,Zi,t.reportAllChanges),s=zi(!0);var c=i?Fi(i):null;o=c&&c.startTime||0}("soft-navigation",u.navigationId):c.disconnect();var l=0;if(u.navigationId&&u.navigationId!==i){var d=Fi(u.navigationId),p=d&&d.startTime?d.startTime:0;l=Math.max(u.startTime-p,0)}else l=Math.max(u.startTime-Pi(),0);var h=r&&u.navigationId?Fi(u.navigationId):null,f=h&&h.startTime?h.startTime:0;(u.startTime<s.firstHiddenTime||r&&u.navigationId&&u.navigationId!==a.navigationId&&u.navigationId!==i&&f>o)&&(a.value=l,a.entries.push(u),a.navigationId=u.navigationId||"1",n(!0))}}))}),t);c&&(n=Ni(e,a,Zi,t.reportAllChanges),ki((function(r){a=Di("FCP",0,"back-forward-cache",a.navigationId),n=Ni(e,a,Zi,t.reportAllChanges),Li((function(){a.value=performance.now()-r.timeStamp,n(!0)}))})))}))},qi=[.1,.25],$i=0,Qi=1/0,es=0,ts="",ns=!1,rs=function(e){var t;ts||(ts=(null===(t=Oi())||void 0===t?void 0:t.navigationId)||"1"),e.forEach((function(e){e.interactionId&&(ns&&e.navigationId&&e.navigationId!==ts&&(ts=e.navigationId,$i=0,Qi=1/0,es=0),Qi=Math.min(Qi,e.interactionId),es=Math.max(es,e.interactionId),$i=es?(es-Qi)/7+1:0)}))},os=function(){return Ci?$i:performance.interactionCount||0},is=[],ss=new Map,as=0,cs=function(){as=os(),is.length=0,ss.clear()},us=[],ls=function(e){if(us.forEach((function(t){return t(e)})),e.interactionId||"first-input"===e.entryType){var t=is[is.length-1],n=ss.get(e.interactionId);if(n||is.length<10||e.duration>t.latency){if(n)e.duration>n.latency?(n.entries=[e],n.latency=e.duration):e.duration===n.latency&&e.startTime===n.entries[0].startTime&&n.entries.push(e);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};ss.set(r.id,r),is.push(r)}is.sort((function(e,t){return t.latency-e.latency})),is.length>10&&is.splice(10).forEach((function(e){return ss.delete(e.id)}))}}},ds=function(e){var t=self.requestIdleCallback||self.setTimeout,n=-1;return e=Wi(e),"hidden"===document.visibilityState?e():(n=t(e),Bi(e)),n},ps=[200,500],hs=function(e,t){if("PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype){var n=Ui(t=t||{}),r=!1,o=0;Ki((function(){var i;!function(e){"interactionCount"in performance||Ci||(Ci=ji("event",rs,{type:"event",buffered:!0,durationThreshold:0,includeSoftNavigationObservations:ns=e||!1}))}(n);var s,a=Di("INP"),c=function(n,i){if(cs(),a=Di("INP",0,n,i),s=Ni(e,a,ps,t.reportAllChanges),r=!1,"soft-navigation"===n){var c=Fi(i);o=c&&c.startTime?c.startTime:0}},u=function(e){ds((function(){var n;e.forEach(ls),(n=function(){var e=Math.min(is.length-1,Math.floor((os()-as)/50));return is[e]}())&&(n.latency!==a.value||t&&t.reportAllChanges)&&(a.value=n.latency,a.entries=n.entries),s()}))},l=ji("event",u,{durationThreshold:null!==(i=t.durationThreshold)&&void 0!==i?i:40,opts:t});s=Ni(e,a,ps,t.reportAllChanges),l&&(l.observe({type:"first-input",buffered:!0,includeSoftNavigationObservations:n}),Bi((function(){u(l.takeRecords()),s(!0)})),ki((function(){cs(),c("back-forward-cache",a.navigationId),Li((function(){return s()}))})),n&&ji("soft-navigation",(function(n){n.forEach((function(n){var i=Fi(n.navigationId),u=i&&i.startTime?i.startTime:0;n.navigationId&&n.navigationId!==a.navigationId&&u>o&&(!r&&a.value>0&&s(!0),c("soft-navigation",n.navigationId),s=Ni(e,a,ps,t.reportAllChanges))}))}),t))}))}},fs=[],gs=[],ms=0,vs=new WeakMap,ys=new Map,Es=-1,bs=function(e){fs=fs.concat(e),Ss()},Ss=function(){Es<0&&(Es=ds(Ts))},Ts=function(){ys.size>10&&ys.forEach((function(e,t){ss.has(t)||ys.delete(t)}));var e=is.map((function(e){return vs.get(e.entries[0])})),t=gs.length-50;gs=gs.filter((function(n,r){return r>=t||e.includes(n)}));for(var n=new Set,r=0;r<gs.length;r++){var o=gs[r];ws(o.startTime,o.processingEnd).forEach((function(e){n.add(e)}))}var i=fs.length-1-50;fs=fs.filter((function(e,t){return e.startTime>ms&&t>i||n.has(e)})),Es=-1};us.push((function(e){e.interactionId&&e.target&&!ys.has(e.interactionId)&&ys.set(e.interactionId,e.target)}),(function(e){var t,n=e.startTime+e.duration;ms=Math.max(ms,e.processingEnd);for(var r=gs.length-1;r>=0;r--){var o=gs[r];if(Math.abs(n-o.renderTime)<=8){(t=o).startTime=Math.min(e.startTime,t.startTime),t.processingStart=Math.min(e.processingStart,t.processingStart),t.processingEnd=Math.max(e.processingEnd,t.processingEnd),t.entries.push(e);break}}t||(t={startTime:e.startTime,processingStart:e.processingStart,processingEnd:e.processingEnd,renderTime:n,entries:[e]},gs.push(t)),(e.interactionId||"first-input"===e.entryType)&&vs.set(e,t),Ss()}));var _s,Cs,Is,Os,ws=function(e,t){for(var n,r=[],o=0;n=fs[o];o++)if(!(n.startTime+n.duration<e)){if(n.startTime>t)break;r.push(n)}return r},Rs=[2500,4e3],As=[800,1800],Ns=function e(t){document.prerendering?Ki((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},Ls=function(e,t){var n=Ui(t=t||{}),r=Di("TTFB"),o=Ni(e,r,As,t.reportAllChanges);Ns((function(){var i=Oi();if(i){var s=i.responseStart;r.value=Math.max(s-Pi(),0),r.entries=[i],o(!0),ki((function(){r=Di("TTFB",0,"back-forward-cache",r.navigationId),(o=Ni(e,r,As,t.reportAllChanges))(!0)})),n&&ji("soft-navigation",(function(n){n.forEach((function(n){n.navigationId&&((r=Di("TTFB",0,"soft-navigation",n.navigationId)).entries=[n],(o=Ni(e,r,As,t.reportAllChanges))(!0))}))}),t)}}))},Ms={passive:!0,capture:!0},xs=new Date,ks=function(e,t){_s||(_s=t,Cs=e,Is=new Date,Us(removeEventListener),Ps())},Ps=function(){if(Cs>=0&&Cs<Is-xs){var e={entryType:"first-input",name:_s.type,target:_s.target,cancelable:_s.cancelable,startTime:_s.timeStamp,processingStart:_s.timeStamp+Cs};Os.forEach((function(t){t([e])})),Os=[]}},Ds=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){ks(e,t),o()},r=function(){o()},o=function(){removeEventListener("pointerup",n,Ms),removeEventListener("pointercancel",r,Ms)};addEventListener("pointerup",n,Ms),addEventListener("pointercancel",r,Ms)}(t,e):ks(t,e)}},Us=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,Ds,Ms)}))},Fs=[100,300],js=function(e,t){!function(e,t){var n,r=Ui(t=t||{}),o=(null===(n=Oi())||void 0===n?void 0:n.navigationId)||"1";Ki((function(){var n,i=zi(),s=Di("FID"),a=function(a){a.forEach((function(a){var u,l;r?a.navigationId&&a.navigationId!==s.navigationId&&(u="soft-navigation",l=a.navigationId,i=zi(!0),s=Di("FID",0,u,l),n=Ni(e,s,Fs,t.reportAllChanges)):c.disconnect(),a.startTime<i.firstHiddenTime&&(s.value=a.processingStart-a.startTime,s.entries.push(a),s.navigationId=a.navigationId||o,n(!0))}))},c=ji("first-input",a,t);n=Ni(e,s,Fs,t.reportAllChanges),c&&(Bi((function(){a(c.takeRecords()),r||c.disconnect()})),ki((function(){var r;s=Di("FID",0,"back-forward-cache",s.navigationId),n=Ni(e,s,Fs,t.reportAllChanges),Os=[],Cs=-1,_s=null,Us(addEventListener),r=a,Os.push(r),Ps()})))}))}((function(t){var n=function(e){var t=e.entries[0],n={eventTarget:Ai(t.target),eventType:t.name,eventTime:t.startTime,eventEntry:t,loadState:wi(t.startTime)};return Object.assign(e,{attribution:n})}(t);e(n)}),t)};function Bs(e){return null==e}function Ws(e){return"object"==typeof e}function Gs(e={},...t){if(Bs(e))return{};const n=(e,t)=>{const[r,...o]=t;if(!e.hasOwnProperty(r))return e;if(!o.length){const t=e,n=r;t[n];return br(t,["symbol"==typeof n?n:n+""])}return Object.assign(Object.assign({},e),{[r]:n(e[r],o)})};return(r=t,Bs(r)?[]:r instanceof Set?[...r]:Array.isArray(r)?r:[r]).reduce(((e,t)=>n(e,t.split("."))),e);var r}function Vs(e){return!!Bs(e)||(e instanceof Set||e instanceof Map?0===e.size:Array.isArray(e)||"string"==typeof e?0===e.length:!!Ws(e)&&0===Object.keys(e).length)}const Hs="web_vitals",Xs="long_tasks",Ys="resources",zs="custom_measurement",Ks="xhr",Zs="fetch",Js="session_recording",qs={lcp:!0,fid:!0,cls:!0,fcp:!0,inp:!0,ttfb:!0,tbt:!0,lt:!0},$s="internal",Qs=[".css"],ea=[".wasm",".manifest"],ta=[".js",".mjs"],na=[".mp3",".mp4",".wav",".ogg",".webm",".avi"],ra=[".pdf",".doc",".docx",".ppt",".pptx",".xls",".xlsx",".csv",".html"],oa=[".woff",".woff2",".ttf",".otf",".eot"],ia=[".svg",".jpg",".png",".jpeg",".bmp",".webp"];
/** Original source: https://www.npmjs.com/package/tti-polyfill?activeTab=code
     * @license Apache-2.0
     * @version 0.2.2
     * @description A polyfill for the Time to Interactive metric -
     * We decide to fork this package instead of installing it from npm
     * because it's not maintained anymore, and we want to have control over the codebase.
     * Also, we don't want to have a dependency on a package that is not maintained.
     */
var sa=void 0!==To?To:{},aa="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)};function ca(){ca=function(){},sa.Symbol||(sa.Symbol=la)}var ua=0;function la(e){return"jscomp_symbol_"+(e||"")+ua++}function da(){ca();var e=sa.Symbol.iterator;e||(e=sa.Symbol.iterator=sa.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&aa(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return pa(this)}}),da=function(){}}function pa(e){var t=0;return function(e){return da(),e={next:e},e[sa.Symbol.iterator]=function(){return this},e}((function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}))}function ha(e){da();var t=e[Symbol.iterator];return t?t.call(e):pa(e)}function fa(e){if(!(e instanceof Array)){e=ha(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}var ga=0;var ma="img script iframe link audio video source".split(" ");function va(e,t){for(var n=(e=ha(e)).next();!n.done;n=e.next())if(n=n.value,t.includes(n.nodeName.toLowerCase())||va(n.children,t))return!0;return!1}function ya(e,t){if(2<e.length)return performance.now();for(var n=[],r=(t=ha(t)).next();!r.done;r=t.next())r=r.value,n.push({timestamp:r.start,type:"requestStart"}),n.push({timestamp:r.end,type:"requestEnd"});for(r=(t=ha(e)).next();!r.done;r=t.next())n.push({timestamp:r.value,type:"requestStart"});for(n.sort((function(e,t){return e.timestamp-t.timestamp})),e=e.length,t=n.length-1;0<=t;t--)switch(r=n[t],r.type){case"requestStart":e--;break;case"requestEnd":if(2<++e)return r.timestamp;break;default:throw Error("Internal Error: This should never happen")}return 0}function Ea(e){e=e||{},this.w=!!e.useMutationObserver,this.u=e.minValue||null,e=To.__tti&&To.__tti.e;var t=To.__tti&&To.__tti.o;this.a=e?e.map((function(e){return{start:e.startTime,end:e.startTime+e.duration}})):[],t&&t.disconnect(),this.b=[],this.f=new Map,this.j=null,this.v=-1/0,this.i=!1,this.h=this.c=this.s=null,function(e,t){var n=XMLHttpRequest.prototype.send,r=ga++;XMLHttpRequest.prototype.send=function(o){for(var i=[],s=0;s<arguments.length;++s)i[s-0]=arguments[s];var a=this;return e(r),this.addEventListener("readystatechange",(function(){4===a.readyState&&t(r)})),n.apply(this,i)}}(this.m.bind(this),this.l.bind(this)),function(e,t){var n=fetch;fetch=function(r){for(var o=[],i=0;i<arguments.length;++i)o[i-0]=arguments[i];return new Promise((function(r,i){var s=ga++;e(s),n.apply(null,[].concat(fa(o))).then((function(e){t(s),r(e)}),(function(e){t(e),i(e)}))}))}}(this.m.bind(this),this.l.bind(this)),function(e){e.c=new PerformanceObserver((function(t){for(var n=(t=ha(t.getEntries())).next();!n.done;n=t.next())if("resource"===(n=n.value).entryType&&(e.b.push({start:n.fetchStart,end:n.responseEnd}),Sa(e,ya(e.g,e.b)+5e3)),"longtask"===n.entryType){var r=n.startTime+n.duration;e.a.push({start:n.startTime,end:r}),Sa(e,r+5e3)}})),e.c.observe({entryTypes:["longtask","resource"]})}(this),this.w&&(this.h=function(e){var t=new MutationObserver((function(t){for(var n=(t=ha(t)).next();!n.done;n=t.next())("childList"==(n=n.value).type&&va(n.addedNodes,ma)||"attributes"==n.type&&ma.includes(n.target.tagName.toLowerCase()))&&e(n)}));return t.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]}),t}(this.B.bind(this)))}function ba(e){e.i=!0;var t=0<e.a.length?e.a[e.a.length-1].end:0,n=ya(e.g,e.b);Sa(e,Math.max(n+5e3,t))}function Sa(e,t){!e.i||e.v>t||(clearTimeout(e.j),e.j=setTimeout((function(){var t=performance.timing.navigationStart,n=ya(e.g,e.b);t=(To.a&&To.a.A?1e3*To.a.A().C-t:0)||performance.timing.domContentLoadedEventEnd-t;if(e.u)var r=e.u;else performance.timing.domContentLoadedEventEnd?r=(r=performance.timing).domContentLoadedEventEnd-r.navigationStart:r=null;var o=performance.now();null===r&&Sa(e,Math.max(n+5e3,o+1e3));var i=e.a;5e3>o-n?n=null:n=5e3>o-(n=i.length?i[i.length-1].end:t)?null:Math.max(n,r),n&&(e.s(n),clearTimeout(e.j),e.i=!1,e.c&&e.c.disconnect(),e.h&&e.h.disconnect()),Sa(e,performance.now()+1e3)}),t-performance.now()),e.v=t)}Ea.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise((function(t){e.s=t,"complete"==document.readyState?ba(e):To.addEventListener("load",(function(){ba(e)}))}))},Ea.prototype.m=function(e){this.f.set(e,performance.now())},Ea.prototype.l=function(e){this.f.delete(e)},Ea.prototype.B=function(){Sa(this,performance.now()+5e3)},sa.Object.defineProperties(Ea.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return[].concat(fa(this.f.values()))}}});var Ta,_a=function(e=void 0){return e=e||{},"PerformanceLongTaskTiming"in To?new Ea(e).getFirstConsistentlyInteractive():Promise.resolve(null)};function Ca(e,t){if(Ia())try{e.observe({type:t,buffered:!0})}catch(n){e.observe({entryTypes:[t]})}}function Ia(){var e;return!!(null===(e=null==To?void 0:To.PerformanceObserver)||void 0===e?void 0:e.supportedEntryTypes)||(console.warn("Coralogix Browser SDK  - browser does not support the required APIs "),!1)}function Oa(e,t){return t.some((t=>t===e))}function wa(e,t,n){return t.some((t=>t instanceof RegExp?t.test(e):"string"==typeof t?(t=t.toLowerCase()).includes(e.toLowerCase()):(n&&console.warn(`Coralogix Browser SDK - ${n} must be from type string | Regex`),!1)))}!function(e){e.Media="media",e.Script="script",e.Css="css",e.Beacon="beacon",e.Img="img",e.Font="font",e.Doc="doc",e.Xhr="xmlhttprequest",e.Fetch="fetch",e.Iframe="iframe",e.Video="video",e.Audio="audio",e.Track="track",e.Other="other"}(Ta||(Ta={}));function Ra(e,t){const n=So();let r;return n.Zone&&"function"==typeof n.Zone.__symbol__&&(r=e[n.Zone.__symbol__(t)]),r||(r=e[t]),r}function Aa(e,t,n,{once:r,capture:o,passive:i}={}){const s=r?e=>{u(),n(e)}:n,a=i?{capture:o,passive:i}:o,c=Ra(e,"addEventListener");function u(){const n=Ra(e,"removeEventListener");t.forEach((t=>n.call(e,t,s,a)))}return t.forEach((t=>c.call(e,t,s,a))),{stop:u}}const Na=["BUTTON","LABEL","A","INPUT","OPTION"];function La(e,t){if(!e)return"";const n=Ma(e,5);return n?function(e,t){if(ka(e,t.maskInputTypes,t.maskClass)||xa(e,t.maskClass,5))return rc;const n=function(e,t){return e.children?Array.from(e.children).find((e=>ka(e,t.maskInputTypes,t.maskClass))):null}(e,t);if(n)return rc;return function(e){if(e instanceof HTMLInputElement)return e.value||"";return"innerText"in e?e.innerText:""}(e)}(n,t):""}function Ma(e,t){return!e||t<=0?null:Na.includes(e.nodeName)?e:Ma(e.parentElement,t-1)}function xa(e,t,n=5){return!(!e||n<=0)&&(!!Pa(e.className,t)||xa(e.parentElement,t,n-1))}function ka(e,t,n){return!!e&&(function(e,t){if(e instanceof HTMLInputElement){const n=e.type||"text";return t.includes(n)}return!1}(e,t)||Pa(e.className,n))}function Pa(e,t){return t instanceof RegExp?t.test(e):"string"==typeof e&&e.includes(t)}const Da="interactions",Ua={click:!0};const Fa="memory_usage";class ja{constructor(){this.measurements=new Map}startMeasurement(e,t){this.checkAndResetIfSessionExpired(),!this.measurements.has(e)&&e.trim()?this.measurements.set(e,{startTime:Date.now(),labels:t}):this.logDebug(`Invalid or duplicate key: "${e}".`)}getMeasurement(e){if(this.checkAndResetIfSessionExpired(),!this.measurements.has(e)||!e.trim())return void this.logDebug(`Invalid or duplicate key: "${e}".`);const{startTime:t,labels:n}=this.measurements.get(e);return this.measurements.delete(e),{duration:Date.now()-t,labels:n}}checkAndResetIfSessionExpired(){Co().isIdleActive&&this.measurements.clear()}logDebug(e){Oo().debug&&console.debug(`Coralogix Browser SDK - ${e}`)}}class Ba extends $r{constructor(e){super(zs,"1.0.0",e)}init(){}disable(){}enable(){}createCustomMeasurement(t,n,r){const o=this.tracer.startSpan(zs);o[lc.EVENT_TYPE]=e.CoralogixEventType.CUSTOM_MEASUREMENT,o[lc.CUSTOM_MEASUREMENT_CONTEXT]={name:t,value:n},Object.keys(r||{}).length>0&&o.setAttribute(lc.CUSTOM_LABELS,JSON.stringify(r)),o.end()}}const Wa="web-worker-runtime-error",Ga="web-worker-messageerror",Va="Unknown worker runtime error",Ha="Failed to deserialize message from worker",Xa="error",Ya="messageerror";const za="/browser/v1beta/logs",Ka=1024,Za=1024,Ja=["application","version","coralogixDomain"],qa="sdkConfig",$a="userAgent",Qa="{id}",ec="PAGE_URL_LABEL_PROVIDERS",tc="NETWORK_URL_LABEL_PROVIDERS",nc="rumInternalData",rc="***",oc=["password","email","tel"],ic="cx-fingerprint",sc=[{pattern:new RegExp(/[0-9a-fA-F-]{36}/g),replacement:Qa},{pattern:new RegExp(/^[a-zA-Z0-9-_]{21}$/),replacement:Qa}],ac={pageUrlBlueprinters:[e=>function({patterns:e,url:t}){let n=t;for(const{pattern:t,replacement:r}of e)n=n.replace(t,r);return n}({patterns:sc,url:e})]},cc={ignoreUrls:[new RegExp(za),new RegExp("/sessionrecording")],user_context:{user_id:"",user_name:""},labels:{},urlBlueprinters:ac,collectIPData:!0},uc=[{Instrument:class extends $r{constructor(e){super(Ho,"1",e),this.parseErrorObject=e=>{var t;return null!==(t=null==e?void 0:e.message)&&void 0!==t?t:JSON.stringify(e,Ic())},Oo().supportMfe&&(To[Vo]=new Map)}init(){}enable(){var e;Kr.wrap(console,"error",(e=this,t=>(...n)=>(e.report(Yo.CONSOLE,n),t.apply(console,n)))),To.addEventListener("error",Zo(this)),To.addEventListener("unhandledrejection",Jo(this)),document.documentElement.addEventListener("error",qo(this),{capture:!0})}disable(){Kr.unwrap(console,"error"),To.removeEventListener("error",Zo(this)),To.removeEventListener("unhandledrejection",Jo(this)),document.documentElement.removeEventListener("error",qo(this),{capture:!0})}report(e,t){if(!(t instanceof Array&&0===t.length))switch(!0){case t instanceof Error:this.reportError(e,t);break;case t instanceof ErrorEvent:this.reportErrorEvent(e,t);break;case t instanceof Event:this.reportEvent(e,t);break;case"string"==typeof t:this.reportString(e,t);break;case t instanceof Array:{const n=t.find((e=>e instanceof Error)),r=t.map((e=>"string"==typeof e?e:this.parseErrorObject(e))).join(" ");this.reportString(e,r,n);break}default:this.reportString(e,"string"==typeof t?t:this.getPossibleEventMessage(t))}}reportError(e,t,n,r){return Sr(this,void 0,void 0,(function*(){const{message:o,name:i}=t,s=this.createSpan("error"),a=o.split("\n")[0];$o(s),s.setAttribute(lc.SOURCE,e),s.setAttribute(Xo.TYPE,i),s.setAttribute(Xo.MESSAGE,a),n&&(s[Xo.DATA]=JSON.stringify(n,Ic())),r&&Wo(s,r),yield zo(s,t),s.end()}))}reportString(e,t,n){return Sr(this,void 0,void 0,(function*(){const r=this.createSpan(e);$o(r),r.setAttribute(lc.SOURCE,e),r.setAttribute(Xo.MESSAGE,null==t?void 0:t.substring(0,1024)),n&&(yield zo(r,n)),r.end()}))}reportErrorEvent(e,{error:t,message:n}){const r=null!=t?t:n;this.report(e,r)}reportEvent(e,t){if(!t.target)return;const n=this.createSpan(e);$o(n),n.setAttribute(lc.SOURCE,e),t.target&&(n.setAttribute("target_element",t.target.tagName),n.setAttribute("target_xpath",Pr(t.target,!0)),n.setAttribute("target_src",t.target.src)),n.end()}createSpan(t){let n;return n=ko(e.CoralogixEventType.ERROR)?Do(t):this.tracer.startSpan(t),n}getPossibleEventMessage(e){const{message:t,statusMessage:n}=e||{};return t&&"string"==typeof t?t:n&&"string"==typeof n?n:JSON.stringify(e)}},confKey:Ho,disable:!1},{Instrument:class extends oi{constructor(e){ii(e),e.applyCustomAttributesOnSpan=(e,t,n)=>{Bo(e),fi(e),this.setNetworkSpanAttributes(e,t,n)},super(e),this.networkDataManager=new si,this.headersManager=new ui}setNetworkSpanAttributes(t,n,r){return Sr(this,void 0,void 0,(function*(){const{status:o}=r,{networkExtraConfig:i}=Oo(),s=t.attributes["http.url"]||"",a=this.networkDataManager.resolveConfigForUrl(s,i);a&&(yield this.setRequestAttributes(t,n,a),yield this.setResponseAttributes(t,r,a)),t.setAttributes({[lc.SEVERITY]:bc(o)?e.CoralogixLogSeverity.Error:e.CoralogixLogSeverity.Info,[lc.EVENT_TYPE]:e.CoralogixEventType.NETWORK_REQUEST,[lc.SOURCE]:gi.FETCH})}))}setRequestAttributes(e,t,n){return Sr(this,void 0,void 0,(function*(){const{reqHeaders:r,collectReqPayload:o}=n;try{const n=o?yield this.networkDataManager.stringifyRequestBody(t):void 0,i=(null==r?void 0:r.length)?this.headersManager.filterHeaders(t.headers,r):void 0;n&&(e[hi]=n),(null==i?void 0:i.size)&&(e[li]=Object.fromEntries(i))}catch(e){Oo().debug&&console.debug("Error setting request attributes on span:",e)}}))}setResponseAttributes(e,t,n){return Sr(this,void 0,void 0,(function*(){const{resHeaders:r,collectResPayload:o}=n;if(t instanceof Response)try{const n=o?yield this.networkDataManager.stringifyResponseBody(t):void 0,i=(null==r?void 0:r.length)?this.headersManager.filterHeaders(t.headers,r):void 0;n&&(e[pi]=n),(null==i?void 0:i.size)&&(e[di]=Object.fromEntries(i))}catch(e){Oo().debug&&console.debug("Error setting request attributes on span:",e)}}))}disable(){}},confKey:Zs,disable:!1},{Instrument:class extends Si{constructor(e){ii(e),e.applyCustomAttributesOnSpan=(e,t)=>{Bo(e),fi(e),this.setNetworkSpanAttributes(e,t)},super(e),this.networkDataManager=new si,this.headersManager=new ui}setNetworkSpanAttributes(t,n){const{status:r}=n,{networkExtraConfig:o}=Oo(),i=this.networkDataManager.resolveConfigForUrl(n.responseURL,o);t.setAttributes({[lc.SEVERITY]:bc(r)?e.CoralogixLogSeverity.Error:e.CoralogixLogSeverity.Info,[lc.EVENT_TYPE]:e.CoralogixEventType.NETWORK_REQUEST,[lc.SOURCE]:Ei.XHR}),i&&this.setResponseAttributes(t,n,i)}setResponseAttributes(e,t,n){const{resHeaders:r,collectResPayload:o}=n,i=o?this.networkDataManager.truncateIfExceedsLimit(t.responseText):void 0,s=(null==r?void 0:r.length)?this.headersManager.filterHeaders(t.getAllResponseHeaders(),r):void 0;i&&(e[pi]=i),(null==s?void 0:s.size)&&(e[di]=Object.fromEntries(s))}disable(){}},confKey:Ks,disable:!1},{Instrument:_i,confKey:"custom",disable:!1},{Instrument:class extends $r{constructor(e){super(Da,"1",e),this.handler=e=>{},this.stop=()=>{}}enable(){var t;this.handler=t=>{let n;n=ko(e.CoralogixEventType.USER_INTERACTION)?Do(e.CoralogixEventType.USER_INTERACTION):this.tracer.startSpan(e.CoralogixEventType.USER_INTERACTION);const r=t.target,o=Oo(),{id:i,type:s,className:a,nodeName:c}=r,u=La(r,o);n.setAttribute(lc.EVENT_TYPE,e.CoralogixEventType.USER_INTERACTION),n.setAttribute(lc.INTERACTION_EVENT_NAME,t.type),r&&r instanceof HTMLElement&&[[lc.ELEMENT_ID,i],[lc.ELEMENT_CLASSES,a],[lc.TARGET_ELEMENT_TYPE,s],[lc.ELEMENT_INNER_TEXT,null==u?void 0:u.slice(0,Ka)],[lc.TARGET_ELEMENT,c]].forEach((([e,t])=>{n.setAttribute(e,t)})),n.end()};const n=Object.assign(Object.assign({},Ua),null===(t=this._config)||void 0===t?void 0:t.events),r=Object.entries(n).filter((([e,t])=>t)).map((([e])=>e));this.stop=Aa(document,r,this.handler,{capture:!0,passive:!0}).stop}disable(){this.stop()}init(){}},confKey:Da,disable:!1},{Instrument:class extends $r{constructor(t){super(Hs,"1.0.0",t),this.observers=[],this.isSoftNavsEnabled=Oo().trackSoftNavigations,this.onReport=t=>{if(!t)return;"FCP"===t.name&&this.registerToTBTMetric();const n=this.tracer.startSpan(e.CoralogixEventType.WEB_VITALS);let r=t.entries?Gs(t,"entries"):t;r=Gs(r,"attribution.navigationEntry"),"INP"===r.name&&(r=Gs(r,"attribution")),n.setAttribute(lc.EVENT_TYPE,e.CoralogixEventType.WEB_VITALS),n.setAttribute(Hs,JSON.stringify(r,Ic())),n.end()},this.metrics=Vs(t.metrics)?qs:t.metrics,Ia()&&(this.registerToCoreWebVitalMetrics(),this.registerToCalculatedWebVitalMetrics(),this.isSoftNavsEnabled&&this.registerToSoftNavigations())}registerToCoreWebVitalMetrics(){const t=this.isSoftNavsEnabled&&vc.has(e.PerformanceTypes.SoftNavigation);this.metrics.fid&&js(this.onReport),this.metrics.cls&&function(e,t){!function(e,t){var n=Ui(t=t||{}),r=!1,o=0;Ji(Wi((function(){var i,s=Di("CLS",0),a=0,c=[],u=function(n,c){if(s=Di("CLS",0,n,c),i=Ni(e,s,qi,t.reportAllChanges),a=0,r=!1,"soft-navigation"===n){var u=Fi(c);o=u&&u.startTime||0}},l=function(e){e.forEach((function(e){if(n&&e.navigationId&&e.navigationId!==s.navigationId&&(a>s.value&&(s.value=a,s.entries=c),i(!0),u("soft-navigation",e.navigationId)),!e.hadRecentInput){var t=c[0],r=c[c.length-1];a&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(a+=e.value,c.push(e)):(a=e.value,c=[e])}})),a>s.value&&(s.value=a,s.entries=c,i())},d=ji("layout-shift",l,t);d&&(i=Ni(e,s,qi,t.reportAllChanges),Bi((function(){l(d.takeRecords()),i(!0),r=!0})),ki((function(){u("back-forward-cache",s.navigationId),Li((function(){return i()}))})),n&&ji("soft-navigation",(function(n){n.forEach((function(n){var a=n.navigationId,c=a?Fi(a):null;a&&a!==s.navigationId&&c&&(c.startTime||0)>o&&(r||i(!0),u("soft-navigation",n.navigationId),i=Ni(e,s,qi,t.reportAllChanges))}))}),t),setTimeout(i,0))})))}((function(t){var n=function(e){var t,n={};if(e.entries.length){var r=e.entries.reduce((function(e,t){return e&&e.value>t.value?e:t}));if(r&&r.sources&&r.sources.length){var o=(t=r.sources).find((function(e){return e.node&&1===e.node.nodeType}))||t[0];o&&(n={largestShiftTarget:Ai(o.node),largestShiftTime:r.startTime,largestShiftValue:r.value,largestShiftSource:o,largestShiftEntry:r,loadState:wi(r.startTime)})}}return Object.assign(e,{attribution:n})}(t);e(n)}),t)}(this.onReport,{reportSoftNavs:t}),this.metrics.lcp&&function(e,t){!function(e,t){var n,r=!1,o=Ui(t=t||{}),i=0,s=(null===(n=Oi())||void 0===n?void 0:n.navigationId)||"1",a="";Ki((function(){var n,c=zi(),u=Di("LCP"),l=function(o,s){if(u=Di("LCP",0,o,s),n=Ni(e,u,Rs,t.reportAllChanges),r=!1,"soft-navigation"===o){c=zi(!0);var a=Fi(s);i=a&&a.startTime?a.startTime:0}h()},d=function(e){e.forEach((function(e){if(e){o&&e.navigationId&&e.navigationId!==u.navigationId&&(r||n(!0),l("soft-navigation",e.navigationId));var t=0;if(e.navigationId&&e.navigationId!==s){var i=Fi(e.navigationId),a=i&&i.startTime?i.startTime:0;t=Math.max(e.startTime-a,0)}else t=Math.max(e.startTime-Pi(),0);e.startTime<c.firstHiddenTime&&(u.value=t,u.entries=[e],u.navigationId=e.navigationId||s,n())}}))},p=function(){f(),r||(d(m.takeRecords()),o||m.disconnect(),u.navigationId===a&&(r=!0,n(!0)))},h=function(){["keydown","click"].forEach((function(e){addEventListener(e,(function(){return g()}),!0)}))},f=function(){["keydown","click"].forEach((function(e){removeEventListener(e,(function(){return g()}),!0)}))},g=function(){a=u.navigationId,ds(p)},m=ji("largest-contentful-paint",d,t);m&&(n=Ni(e,u,Rs,t.reportAllChanges),h(),Bi((function(){a=u.navigationId,p()})),ki((function(e){l("back-forward-cache",u.navigationId),Li((function(){u.value=performance.now()-e.timeStamp,r=!0,n(!0)}))})),o&&ji("soft-navigation",(function(e){e.forEach((function(e){var t=e.navigationId?Fi(e.navigationId):null;e.navigationId&&e.navigationId!==u.navigationId&&t&&(t.startTime||0)>i&&(r||n(!0),l("soft-navigation",e.navigationId))}))}),t))}))}((function(t){var n=function(e){var t,n=(null===(t=Oi())||void 0===t?void 0:t.navigationId)||"1",r={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:e.value};if(e.entries.length){var o,i=0,s=0,a=0;if(e.navigationId&&e.navigationId!==n?i=a=(o=Fi(e.navigationId))?o.startTime:0:(i=(o=Oi())&&o.activationStart?o.activationStart:0,s=o&&o.responseStart?o.responseStart:0),o){var c=e.entries[e.entries.length-1],u=c.url&&performance.getEntriesByType("resource").filter((function(e){return e.name===c.url}))[0],l=Math.max(0,s-i),d=Math.max(l,u?(u.requestStart||u.startTime)-i:0),p=Math.max(d-a,u?u.responseEnd-i:0,0),h=Math.max(p-a,c?c.startTime-i:0,0);r={element:Ai(c.element),timeToFirstByte:l,resourceLoadDelay:d-l,resourceLoadDuration:p-d,elementRenderDelay:h-p,navigationEntry:o,lcpEntry:c},c.url&&(r.url=c.url),u&&(r.lcpResourceEntry=u)}}return Object.assign(e,{attribution:r})}(t);e(n)}),t)}(this.onReport,{reportSoftNavs:t}),this.metrics.fcp&&function(e,t){Ji((function(t){var n=function(e){var t,n=(null===(t=Oi())||void 0===t?void 0:t.navigationId)||"1",r={timeToFirstByte:0,firstByteToFCP:e.value,loadState:wi(xi())};if(e.entries.length){var o,i=e.entries[e.entries.length-1],s=0;if(e.navigationId&&e.navigationId!==n)s=(o=Fi(e.navigationId))?o.startTime:0;else if(o=Oi()){var a=o.responseStart,c=o.activationStart||0;s=Math.max(0,a-c)}o&&(r={timeToFirstByte:s,firstByteToFCP:e.value-s,loadState:wi(e.entries[0].startTime),navigationEntry:o,fcpEntry:i})}return Object.assign(e,{attribution:r})}(t);e(n)}),t)}(this.onReport,{reportSoftNavs:t}),this.metrics.inp&&function(e,t){Ii||(Ii=ji("long-animation-frame",bs)),hs((function(t){var n=function(e){var t=e.entries[0],n=vs.get(t),r=t.processingStart,o=n.processingEnd,i=n.entries.sort((function(e,t){return e.processingStart-t.processingStart})),s=ws(t.startTime,o),a=e.entries.find((function(e){return e.target})),c=a&&a.target||ys.get(t.interactionId),u=[t.startTime+t.duration,o].concat(s.map((function(e){return e.startTime+e.duration}))),l=Math.max.apply(Math,u),d={interactionTarget:Ai(c),interactionTargetElement:c,interactionType:t.name.startsWith("key")?"keyboard":"pointer",interactionTime:t.startTime,nextPaintTime:l,processedEventEntries:i,longAnimationFrameEntries:s,inputDelay:r-t.startTime,processingDuration:o-r,presentationDelay:Math.max(l-o,0),loadState:wi(t.startTime)};return Object.assign(e,{attribution:d})}(t);e(n)}),t)}(this.onReport,{reportSoftNavs:t}),this.metrics.ttfb&&function(e,t){Ls((function(t){var n=function(e){var t={waitingDuration:0,cacheDuration:0,dnsDuration:0,connectionDuration:0,requestDuration:0};if(e.entries.length){var n=e.entries[0],r=n.activationStart||0,o=Math.max((n.workerStart||n.fetchStart)-r,0),i=Math.max(n.domainLookupStart-r||0,0),s=Math.max(n.connectStart-r||0,0),a=Math.max(n.connectEnd-r||0,0);t={waitingDuration:o,cacheDuration:i-o,dnsDuration:s-i,connectionDuration:a-s,requestDuration:e.value-a,navigationEntry:n}}return Object.assign(e,{attribution:t})}(t);e(n)}),t)}(this.onReport,{reportSoftNavs:t})}registerToSoftNavigations(){if(vc.has(e.PerformanceTypes.SoftNavigation)){const t=new PerformanceObserver((e=>{let t;e.getEntries().forEach((e=>{const{duration:n,name:r,startTime:o,navigationId:i}=e;t={name:"SN",id:Tc(),value:n,url:r,navigationType:"soft-navigation",navigationId:i,startTime:o},this.onReport(t)}))}));this.observers.push(t),Ca(t,e.PerformanceTypes.SoftNavigation)}else console.warn("Coralogix Browser SDK - browser doesnt support soft navigation events")}registerToCalculatedWebVitalMetrics(){this.metrics.lt&&(vc.has(e.PerformanceTypes.Navigation)?this.calculateLoadingPageTime():console.warn("Coralogix Browser SDK - browser doesnt support navigation events"))}registerToTBTMetric(){this.metrics.tbt&&(vc.has(e.PerformanceTypes.LongTask)?this.calculateAllTotalBlockingTime():console.warn("Coralogix Browser SDK - browser doesnt support TBT events"))}calculateLoadingPageTime(){const t=new PerformanceObserver((e=>{let t;e.getEntries().forEach((e=>{const{duration:n,name:r,type:o}=e;t=Object.assign(Object.assign({},wc(e)),{name:"LT",id:Tc(),value:n,url:r,navigationType:o}),n&&this.onReport(t)}))}));this.observers.push(t),Ca(t,e.PerformanceTypes.Navigation)}calculateAllTotalBlockingTime(){let t;const n=new PerformanceObserver((e=>{var n;const r=function(e){return e.reduce(((e,t)=>e+=t.duration-50),0)}(e.getEntries());t={name:"TBT",id:Tc(),rating:_c(r),value:(null!==(n=null==t?void 0:t.value)&&void 0!==n?n:0)+r}}));this.observers.push(n),Ca(n,e.PerformanceTypes.LongTask),_a().then((e=>{var r,o;e&&(this.onReport(t),this.onReport({name:"TTI",value:e,id:Tc()}),n.disconnect(),null===(o=null===(r=To.__tti)||void 0===r?void 0:r.o)||void 0===o||o.disconnect())}))}enable(){}disable(){this.observers.forEach((e=>e.disconnect()))}init(){}},confKey:Hs,disable:!1},{Instrument:class extends $r{constructor(t){super(Xs,"1.0.0",t),vc.has(e.PerformanceTypes.LongTask)?this.registerToLongTasks():console.warn("Coralogix Browser SDK - browser doesnt support longtask events")}registerToLongTasks(){this.longTaskObserver=new PerformanceObserver((e=>{e.getEntries().forEach((e=>this.createSpanFromLongTask(e)))})),Ca(this.longTaskObserver,e.PerformanceTypes.LongTask)}createSpanFromLongTask(t){const n=this.tracer.startSpan(e.CoralogixEventType.LONG_TASK),r=Object.assign(Object.assign({},wc(t)),{id:Er()});t.toJSON&&delete r.toJSON,t.attribution&&delete r.attribution,n.setAttribute(lc.EVENT_TYPE,e.CoralogixEventType.LONG_TASK),n.setAttribute(e.CoralogixEventType.LONG_TASK,JSON.stringify(r)),n.end()}enable(){}disable(){var e;null===(e=this.longTaskObserver)||void 0===e||e.disconnect()}init(){}},confKey:Xs,disable:!1},{Instrument:class extends $r{constructor(t){var n;super(Ys,"1.0.0",t),this.ignoreUrls=null===(n=Oo())||void 0===n?void 0:n.ignoreUrls,vc.has(e.PerformanceTypes.Resource)?this.registerToResources():console.warn("Coralogix Browser SDK - browser doesnt support resource events")}registerToResources(){this.resourcesObserver=new PerformanceObserver((e=>{e.getEntries().forEach((e=>{if(this.isProcessableResourceEntry(e)){const t=this.mapResource(e);this.createSpanFromResource(t)}}))})),Ca(this.resourcesObserver,e.PerformanceTypes.Resource)}isProcessableResourceEntry(e){const t=![Ta.Xhr,Ta.Fetch].includes(e.initiatorType),n=!this.isResourceIgnored(e.name);return t&&n}isResourceIgnored(e){var t;return!(!e||!(null===(t=this.ignoreUrls)||void 0===t?void 0:t.length))&&wa(e,this.ignoreUrls,"ignoreUrls")}mapResource(e){const t=e.name;let n=e.initiatorType;switch(!0){case Oa(n,[Ta.Beacon])||yc(t,ea):n=Ta.Other;break;case n!==Ta.Css&&yc(t,Qs):n=Ta.Css;break;case n!==Ta.Script&&yc(t,ta):n=Ta.Script;break;case n!==Ta.Img&&yc(t,ia):n=Ta.Img;break;case t.includes("fonts.googleapis.com")||yc(t,oa):n=Ta.Font;break;case n!==Ta.Iframe&&yc(t,ra):n=Ta.Doc;break;case Oa(n,[Ta.Video,Ta.Audio,Ta.Track])||yc(t,na):n=Ta.Media}return Object.assign(Object.assign({},wc(e)),{initiatorType:n})}createSpanFromResource(t){var n;const r=this.tracer.startSpan(Ys);r.setAttribute(lc.EVENT_TYPE,e.CoralogixEventType.RESOURCES);const o=Object.assign(Object.assign({},wc(t)),{name:null===(n=t.name)||void 0===n?void 0:n.slice(0,Za)});r.setAttribute(Ys,JSON.stringify(o)),r.end()}enable(){}disable(){var e;null===(e=this.resourcesObserver)||void 0===e||e.disconnect()}init(){}},confKey:Ys,disable:!1},{Instrument:class extends $r{constructor(t){super(e.CoralogixEventType.INTERNAL,"1",t)}init(){}disable(){}enable(){}reportInternalEvent(t,n=""){const r=this.tracer.startSpan(e.CoralogixEventType.INTERNAL);let o;switch(r.setAttribute(lc.EVENT_TYPE,e.CoralogixEventType.INTERNAL),r.setAttribute(lc.SEVERITY,e.CoralogixLogSeverity.Info),t){case"init":{const e=Gs(Oo(),"public_key","coralogixDomain");o=this.stringifyConfig(e);break}case"recording-start":break;case"recording-stop":o=n}r.setAttribute(lc.INTERNAL,JSON.stringify({event:t,data:o})),r.end()}stringifyConfig(e){return JSON.stringify(e,((e,t)=>t instanceof RegExp?t.toString():"function"==typeof t?t.toString().slice(0,8)+"...":t),2)}},confKey:e.CoralogixEventType.INTERNAL,disable:!1},{Instrument:class extends $r{constructor(t){super("dom","1.0.0",t),this.visibilityChangeHandler=()=>{if(document.hidden){const t=this.tracer.startSpan("dom");t.setAttribute(lc.EVENT_TYPE,e.CoralogixEventType.DOM),t.end()}}}registerToDOMEvents(){document.addEventListener("visibilitychange",this.visibilityChangeHandler)}unregisterFromDOMEvents(){document.removeEventListener("visibilitychange",this.visibilityChangeHandler)}init(){}disable(){this.unregisterFromDOMEvents()}enable(){setTimeout((()=>{this.registerToDOMEvents()}))}},confKey:e.CoralogixEventType.DOM,disable:!1},{Instrument:Ba,confKey:e.CoralogixEventType.CUSTOM_MEASUREMENT,disable:!1},{Instrument:class extends $r{disable(){this.clearMeasurementsInterval()}enable(){this.startTrackingMemoryUsage()}init(){}constructor(e){super(Fa,"1.0.0",e),this.memoryUsageInterval=Oo().memoryUsageConfig.interval}startTrackingMemoryUsage(){this.clearMeasurementsInterval(),this.createMemorySample().then((()=>this.runMemoryMeasurements()))}createMemorySample(){return Sr(this,void 0,void 0,(function*(){try{const t=function(e){const t=Er(),n={uuid:t,isParent:!0,bytes:e.bytes},r=[];for(const n of e.breakdown)n.bytes>0&&r.push({uuid:t,bytes:n.bytes,attribution:n.attribution,types:n.types.sort().join(", ")});return[n,...r]}(yield performance.measureUserAgentSpecificMemory());for(const n of t){const t=this.tracer.startSpan(Fa);t[lc.EVENT_TYPE]=e.CoralogixEventType.MEMORY_USAGE,t[lc.MEMORY_USAGE_CONTEXT]=n,t.end()}}catch(e){console.warn("Memory usage measurement failed",e),this.clearMeasurementsInterval()}}))}runMemoryMeasurements(){this.timeoutId=setTimeout((()=>this.measureMemoryUsage()),this.memoryUsageInterval)}measureMemoryUsage(){return Sr(this,void 0,void 0,(function*(){yield this.createMemorySample(),this.runMemoryMeasurements()}))}clearMeasurementsInterval(){this.timeoutId&&clearTimeout(this.timeoutId)}},confKey:e.CoralogixEventType.MEMORY_USAGE,disable:!1},{Instrument:class extends $r{constructor(e){super("screenshot","1.0.0",e)}init(){}disable(){}enable(){}screenshot(t,n){if(!Io())return;const r=this.tracer.startSpan(e.CoralogixEventType.SCREENSHOT);r.setAttribute(lc.EVENT_TYPE,e.CoralogixEventType.SCREENSHOT),r.setAttribute(lc.SEVERITY,e.CoralogixLogSeverity.Info),r[lc.SCREENSHOT_CONTEXT]={id:t,description:n},r.end()}},confKey:e.CoralogixEventType.SCREENSHOT,disable:!1},{Instrument:class extends $r{constructor(e,t,n){super("web_worker","1.0.0",e),this.errorInstrumentation=t,this.coralogixRum=n,this.init()}disable(){}enable(){}init(){const e=To,t=e.Worker;e.Worker=this.createCxWorker(t)}createCxWorker(e){const t=this;function n(n,r){const o=new e(n,r);return o.CoralogixRum=t.coralogixRum,t.attachWorkerErrorHandlers(o,n),o}return n.prototype=e.prototype,Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)),n}attachWorkerErrorHandlers(e,t){const n=t.toString();e.addEventListener(Xa,(e=>{const t=e.message||Va;this.reportWorkerError(t,{scriptURL:n,filename:e.filename,lineno:e.lineno,colno:e.colno,originalError:e.error||null},{type:Wa})})),e.addEventListener(Ya,(e=>{this.reportWorkerError(Ha,{scriptURL:n,event:e},{type:Ga})}))}reportWorkerError(e,t,n){var r;null===(r=this.errorInstrumentation)||void 0===r||r.reportError(Yo.WEB_WORKER,new Error(e),t,n)}},confKey:e.CoralogixEventType.WORKER,disable:!1}],lc={EVENT_TYPE:"event_type",SEVERITY:"severity",APPLICATION_CONTEXT:"application_context",USER_CONTEXT:"user_context",CUSTOM_MEASUREMENT_CONTEXT:"custom_measurement_context",MEMORY_USAGE_CONTEXT:"memory_usage_context",SOURCE:"source",ERROR:Xo,LOG:"cx_log",CUSTOM_LABELS:"custom_labels",ENVIRONMENT:"environment",INTERACTION_EVENT_NAME:"interaction_event_name",ELEMENT_INNER_TEXT:"element_inner_text",ELEMENT_ID:"element_id",ELEMENT_CLASSES:"element_classes",TARGET_ELEMENT:"target_element",TARGET_ELEMENT_TYPE:"target_element_type",TIMESTAMP:"timestamp",INTERNAL:"internal",PAGE_CONTEXT:"page_context",IS_NAVIGATION_EVENT:"is_navigation_event",SCREENSHOT_CONTEXT:"screenshot_context"},dc={EU1:"https://ingress.eu1.rum-ingress-coralogix.com",EU2:"https://ingress.eu2.rum-ingress-coralogix.com",US1:"https://ingress.us1.rum-ingress-coralogix.com",US2:"https://ingress.us2.rum-ingress-coralogix.com",AP1:"https://ingress.ap1.rum-ingress-coralogix.com",AP2:"https://ingress.ap2.rum-ingress-coralogix.com",AP3:"https://ingress.ap3.rum-ingress-coralogix.com",STAGING:"https://ingress.staging.rum-ingress-coralogix.com"},pc="cx_mapped_span",hc="/";function fc(e,t){To[nc]||(To[nc]={}),To[nc][e]=t}function gc(e){var t;return null===(t=To[nc])||void 0===t?void 0:t[e]}var mc;const vc=(null===(mc=null==To?void 0:To.PerformanceObserver)||void 0===mc?void 0:mc.supportedEntryTypes)?new Set(To.PerformanceObserver.supportedEntryTypes):new Set;function yc(e,t){return t.some((t=>e.endsWith(t)||e.includes(t)))}const Ec=([e,t])=>1e3*e+Math.round(t/1e6),bc=e=>!!e&&e>=400,Sc=e=>{var t,n;if(!e)return"";const r=(null===(t=e.split("://"))||void 0===t?void 0:t[1])||e,o=null===(n=r.split(hc))||void 0===n?void 0:n[1];if(null==o?void 0:o.startsWith("#")){const e=r.split("#")[1].split("?")[0].split(hc);return e.length&&e.shift(),e.join(hc)||hc}try{return e.startsWith("blob:")?e:new URL(e).pathname.substring(1)||hc}catch(t){return console.warn("Coralogix Browser SDK - Error parsing URL",t),e}};function Tc(){return`v3-${uo()}-${Math.floor(8999999999999*Math.random())+1e12}`}function _c(e){switch(!0){case e>600:return"poor";case e>200&&e<=600:return"needs-improvement";default:return"good"}}function Cc(e){const t=JSON.parse(e[lc.CUSTOM_LABELS]),n=Gs(e,lc.CUSTOM_LABELS);for(const[e,r]of Object.entries(t))n[e]="string"!=typeof r?JSON.stringify(r):r;return n}const Ic=()=>{const e=new WeakSet;return(t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}};function Oc({url:e,blueprinters:t}){let n=e;return null==t||t.forEach((e=>n=e(n))),n}function wc(e){return JSON.parse(JSON.stringify(e))}class Rc{constructor(e){this.labels={[lc.CUSTOM_LABELS]:"{}"},e&&(this.labels=e)}setCustomLabels(e){this.labels[lc.CUSTOM_LABELS]=JSON.stringify(null!=e?e:{})}setInternalLabels(e){this.labels=Object.assign({[lc.CUSTOM_LABELS]:this.labels[lc.CUSTOM_LABELS]},e?this.stringifyValues(e):{})}getLabels(){return JSON.parse(JSON.stringify(this.labels))}getCustomLabels(){return JSON.parse(this.labels[lc.CUSTOM_LABELS])}getInternalLabels(){const e=Object.assign({},this.labels);return delete e[lc.CUSTOM_LABELS],e}getUserContext(){const e=this.labels[lc.USER_CONTEXT];return e?JSON.parse(`${e}`):void 0}forceFlush(){return Promise.resolve()}onStart(e){e.setAttribute(lc.TIMESTAMP,uo()),e.setAttributes(this.labels)}onEnd(){}shutdown(){return Promise.resolve()}stringifyValues(e){const t={};for(const n in e)t[n]="string"==typeof e[n]?e[n]:JSON.stringify(e[n]);return t}}e.CoralogixEventType.WEB_VITALS;let Ac=class{constructor(e){this.requestConfig=e,this.resolvedUrl="",this.resolvedHeaders={},this.init()}init(){const{proxyUrl:e,coralogixDomain:t,public_key:n}=Oo(),{suffix:r,headers:o}=this.requestConfig,i=`${dc[t]}${r}`;this.resolvedUrl=e?`${e}?cxforward=${encodeURIComponent(i)}`:i,n&&(o.Authorization=`Bearer ${n}`),this.resolvedHeaders=o}send(e){return fetch(this.resolvedUrl,{method:"POST",headers:this.resolvedHeaders,body:e}).catch((e=>e))}};class Nc{shouldSample(){return{decision:Ln.RECORD}}}function Lc(t){var n,r,o;return t?Object.assign(Object.assign({},t),{maxRumEvents:(o=t.maxRumEvents,o?o>2e4?2e4:o:5e3),maxRecordTime:(r=t.maxRecordTime,r?r>6e4?6e4:r:1e4),instrumentationsToSend:null!==(n=t.instrumentationsToSend)&&void 0!==n?n:{[e.CoralogixEventType.WEB_VITALS]:!0}}):{enable:!1}}function Mc(e){var t;return e?Object.assign(Object.assign({},e),{sessionSampleRate:null!==(t=e.sessionSampleRate)&&void 0!==t?t:100,onlyWithErrorConfig:Lc(e.onlyWithErrorConfig)}):go}function xc(e){var t;if(e)return Object.assign(Object.assign({},e),{sessionRecordingSampleRate:null!==(t=e.sessionRecordingSampleRate)&&void 0!==t?t:100})}function kc(e){return e>0&&100*Math.random()<=e}function Pc(e){var t;return!e||!!(null===(t=Co())||void 0===t?void 0:t.isIdleActive)}class Dc{constructor(){this.isActive=!0,this.sdkConfig=Oo(),this.request=new Ac({suffix:za,headers:{"Content-Type":"application/json"}}),this.batchTimeDelay=po,this.invokeLogRequest=(e,t)=>{(null==e?void 0:e.length)&&this.request.send(JSON.stringify({logs:e,skip_enrichment_with_ip:!this.sdkConfig.collectIPData})).then((()=>{t&&(Co().cachedLogsSent=!0)}))}}export(e,t){if(Pc(this.isActive))return void t({code:Bt.SUCCESS});const n=e.reduce(((e,t)=>(t[pc]&&e.push(t[pc]),e)),[]);(()=>{const{onlySessionWithErrorMode:e,cachedLogsSent:t}=Co();return e&&!t})()?this.handleSessionWithError(n):this.invokeLogRequest(n),t({code:Bt.SUCCESS})}handleSessionWithError(e){const{maxRumEventsForSessionWithError:t,instrumentationsToSend:n,sessionHasError:r}=Co(),o=[];e=e.reduce(((e,t)=>(n&&n[t.text.cx_rum.event_context.type]?o.push(t):e.push(t),e)),[]),this.invokeLogRequest(o);const i=To.cachedLogs=[...To.cachedLogs||[],...e],s=i.length;if(s>t&&!r)this.clearCachedDataForSessionWithError();else if(r)if(s>500){const e=[];for(let t=0;t<s;t+=500)e.push(i.slice(t,t+500));e.forEach((e=>{setTimeout((()=>this.invokeLogRequest(e,!0)),this.batchTimeDelay),this.batchTimeDelay+=po})),this.clearCachedDataForSessionWithError()}else this.invokeLogRequest(i,!0),this.clearCachedDataForSessionWithError()}clearCachedDataForSessionWithError(){To.cachedLogs=[],this.batchTimeDelay=po}shutdown(){return this.isActive=!1,Promise.resolve()}}class Uc extends Rr{}class Fc{constructor(e){this.idleConfig=e,this._isIdleActive=!1,this.stopCallbacks={},this.resetTimeout=()=>{var e,t;null===(t=(e=this.stopCallbacks).clearTimeout)||void 0===t||t.call(e);const n=setTimeout((()=>{this._isIdleActive=!0,this.idleConfig.onIdle()}),this.idleConfig.timeoutDelay);this.stopCallbacks.clearTimeout=()=>clearTimeout(n)},this.idlenessEventsHandler=()=>{this._isIdleActive&&(this._isIdleActive=!1,this.idleConfig.onActive()),this.resetTimeout()}}get isIdleActive(){return this._isIdleActive}startIdleListener(){this.resetTimeout(),this.trackActivity()}stopIdleListener(){Object.values(this.stopCallbacks).forEach((e=>e()))}trackActivity(){var e,t;if(null===(t=(e=this.stopCallbacks).removeActivityListeners)||void 0===t||t.call(e),"function"==typeof To.addEventListener){const{stop:e}=Aa(To,["touchstart","keydown","mousemove"],this.idlenessEventsHandler,{capture:!0,passive:!0});this.stopCallbacks.removeActivityListeners=e}}}const jc={[Ks]:{browsers:[{name:"Chrome",minVersion:43}],warningText:"XHR"},[Js]:{browsers:[{name:"Chrome",minVersion:45}],warningText:"Session Recording"}};function Bc(e){const{browserVersion:t,browser:n}=wo(),r=parseInt(t.split(".")[0]),o=jc[e];if(!o)return!0;const i=o.browsers.find((e=>e.name===n));return!i||(!(!isNaN(r)&&r<i.minVersion)||(console.debug(`Coralogix Browser SDK - ${o.warningText} is not supported on this browser`),!1))}class Wc extends Fc{constructor(e){var t;super({timeoutDelay:9e5,onIdle:()=>this.clearSessionWhenIdle(),onActive:()=>this.setSession(!0)}),this._sessionConfig=Oo().sessionConfig,this._sessionHasError=!1,this._cachedLogsSent=!1,this._currentPageTimestamp=uo(),this.debugMode=!!(null===(t=Oo())||void 0===t?void 0:t.debug),this.getPrevSession=()=>{var e;return JSON.parse(null===(e=To.sessionStorage)||void 0===e?void 0:e.getItem(fo))},this.getSession=()=>{var e;const t=JSON.parse(null===(e=To.sessionStorage)||void 0===e?void 0:e.getItem(ho)),n=uo();let r;return t&&(t.sessionExpirationDate>n?r=t:(this.clearSessionWhenIdle(),r=this.setSession(!0))),r},this.setSession=(e=!1)=>{var t,n,r,o;(null===(t=this._sessionConfig)||void 0===t?void 0:t.keepSessionAfterReload)?this.handleRefreshedSessions():this.createNewSession(),null===(n=To.sessionStorage)||void 0===n||n.setItem(ho,JSON.stringify(this.activeSession));const i=Io();return(e&&!!(null==i?void 0:i.recordingStopDueToTimeout)&&!!(null===(r=this.sessionRecorderConfig)||void 0===r?void 0:r.enable)||(null==i?void 0:i.getIsAutoStartRecording()))&&(null===(o=this.sessionRecorder)||void 0===o||o.startRecording()),this.activeSession},this.initializeSession(e)}get currentPageTimestamp(){return this._currentPageTimestamp}get currentPageFragment(){return this._currentPageFragment}get sessionConfig(){return this._sessionConfig}get onlySessionWithErrorMode(){return this._sessionConfig.onlyWithErrorConfig.enable}get maxRumEventsForSessionWithError(){return this._sessionConfig.onlyWithErrorConfig.maxRumEvents||0}get maxRecordTimeForSessionWithError(){return this._sessionConfig.onlyWithErrorConfig.maxRecordTime||0}get instrumentationsToSend(){return this._sessionConfig.onlyWithErrorConfig.instrumentationsToSend}get cachedLogsSent(){return this._cachedLogsSent}get sessionHasError(){return this._sessionHasError}get fingerPrint(){return this._fingerPrint}set sessionHasError(e){this._sessionHasError=e}set cachedLogsSent(e){this._cachedLogsSent=e}updateCurrentPage(e){this.isIdleActive?this._currentPageFragment=void 0:(this._currentPageFragment=e,this._currentPageTimestamp=uo())}getSessionKey(){return ho}getActiveSession(){return this.activeSession}start(){this.startIdleListener(),this.clearPrevSession(),this.setSession(),this.setFingerPrint()}stop(){this.stopIdleListener()}initializeSession(e){return Sr(this,void 0,void 0,(function*(){if(To[mo]=this,this.sessionRecorderConfig=e,null==e?void 0:e.enable){const t=kc(e.sessionRecordingSampleRate),n=Bc(Js);if(t&&n){const{SessionRecorder:t}=yield Promise.resolve().then((function(){return sh}));this.sessionRecorder=new t(this,e)}else Oo().debug&&console.debug("Coralogix Browser SDK - Session recording is disabled")}}))}clearSessionWhenIdle(){var e;(null===(e=this.sessionRecorder)||void 0===e?void 0:e.getSessionHasRecording())&&(this.sessionRecorder.recordingStopDueToTimeout=!0),this.clearSession()}clearPrevSession(){var e;null===(e=To.sessionStorage)||void 0===e||e.removeItem(fo)}clearSession(){var e,t,n,r,o,i;this.debugMode&&console.debug("Coralogix Browser SDK - Session expired, clearing session"),null===(e=To.sessionStorage)||void 0===e||e.setItem(fo,JSON.stringify(Object.assign(Object.assign({},this.activeSession),{hasRecording:null===(t=this.sessionRecorder)||void 0===t?void 0:t.getSessionHasRecording(),hasScreenshot:null===(n=this.sessionRecorder)||void 0===n?void 0:n.getSessionHasScreenshot()}))),this.clearGlobalSpans(),this.clearSessionWithErrorMode(),null===(r=_o())||void 0===r||r.resetSnapshot(),this._currentPageFragment=void 0,null===(o=this.sessionRecorder)||void 0===o||o.stopRecording(),null===(i=To.sessionStorage)||void 0===i||i.removeItem(ho)}clearGlobalSpans(){var e;null===(e=Mo())||void 0===e||e.endSpan(),xo(),function(){const e=To[Ao];Object.keys(e||{}).forEach((t=>{const n=e[t];null==n||n.endSpan()})),delete To[Ao]}()}clearSessionWithErrorMode(){this.sessionHasError=!1,this.cachedLogsSent=!1}handleRefreshedSessions(){var e,t;this.activeSession=this.getSession();const n=JSON.parse((null===(e=To.sessionStorage)||void 0===e?void 0:e.getItem(yo))||"{}");this.activeSession?null===(t=Io())||void 0===t||t.updateSegmentIndexCounter(n):this.createNewSession()}createNewSession(){const e=uo();this.debugMode&&console.debug("Coralogix Browser SDK - Creating new session"),this.activeSession={sessionId:Er(),sessionCreationDate:e,sessionExpirationDate:e+36e5}}setFingerPrint(){const e=To.localStorage.getItem(ic);if(e)return void(this._fingerPrint=e);const t=Er();To.localStorage.setItem(ic,t),this._fingerPrint=t}}const Gc=(e,t)=>{const n=gc($s);null==n||n.reportInternalEvent(e,t)};var Vc=I("OpenTelemetry Context Key B3 Debug Flag"),Hc="b3",Xc="x-b3-traceid",Yc="x-b3-spanid",zc="x-b3-sampled",Kc="x-b3-flags",Zc=new Set([!0,"true","True","1",1]),Jc=new Set([!1,"false","False","0",0]);function qc(e,t,n){return function(e){return Array.isArray(e)?e[0]:e}(t.get(e,n))}function $c(e,t){return"1"===qc(e,t,Kc)?"1":void 0}var Qc=function(){function e(){}return e.prototype.inject=function(e,t,n){var r=ze.getSpanContext(e);if(r&&be(r)&&!Ze(e)){var o=e.getValue(Vc);n.set(t,Xc,r.traceId),n.set(t,Yc,r.spanId),"1"===o?n.set(t,Kc,o):void 0!==r.traceFlags&&n.set(t,zc,(w.SAMPLED&r.traceFlags)===w.SAMPLED?"1":"0")}},e.prototype.extract=function(e,t,n){var r,o=function(e,t){var n=qc(e,t,Xc);return"string"==typeof n?n.padStart(32,"0"):""}(t,n),i=function(e,t){var n=qc(e,t,Yc);return"string"==typeof n?n:""}(t,n),s=function(e,t){var n=qc(e,t,zc);return"1"===$c(e,t)||Zc.has(n)?w.SAMPLED:void 0===n||Jc.has(n)?w.NONE:void 0}(t,n),a=$c(t,n);return ye(o)&&Ee(i)&&((r=s)===w.SAMPLED||r===w.NONE)?(e=e.setValue(Vc,a),ze.setSpanContext(e,{traceId:o,spanId:i,isRemote:!0,traceFlags:s})):e},e.prototype.fields=function(){return[Xc,Yc,Kc,zc,"x-b3-parentspanid"]},e}(),eu=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},tu=/((?:[0-9a-f]{16}){1,2})-([0-9a-f]{16})(?:-([01d](?![0-9a-f])))?(?:-([0-9a-f]{16}))?/,nu="0".repeat(16),ru=new Set(["d","1"]);var ou,iu=function(){function e(){}return e.prototype.inject=function(e,t,n){var r=ze.getSpanContext(e);if(r&&be(r)&&!Ze(e)){var o=e.getValue(Vc)||1&r.traceFlags,i=r.traceId+"-"+r.spanId+"-"+o;n.set(t,Hc,i)}},e.prototype.extract=function(e,t,n){var r=n.get(t,Hc),o=Array.isArray(r)?r[0]:r;if("string"!=typeof o)return e;var i=o.match(tu);if(!i)return e;var s=eu(i,4),a=s[1],c=s[2],u=s[3],l=function(e){return 32===e.length?e:""+nu+e}(a);if(!ye(l)||!Ee(c))return e;var d=function(e){return e&&ru.has(e)?w.SAMPLED:w.NONE}(u);return"d"===u&&(e=e.setValue(Vc,u)),ze.setSpanContext(e,{traceId:l,spanId:c,isRemote:!0,traceFlags:d})},e.prototype.fields=function(){return[Hc]},e}();!function(e){e[e.SINGLE_HEADER=0]="SINGLE_HEADER",e[e.MULTI_HEADER=1]="MULTI_HEADER"}(ou||(ou={}));var su=function(){function e(e){void 0===e&&(e={}),this._b3MultiPropagator=new Qc,this._b3SinglePropagator=new iu,e.injectEncoding===ou.MULTI_HEADER?(this._inject=this._b3MultiPropagator.inject,this._fields=this._b3MultiPropagator.fields()):(this._inject=this._b3SinglePropagator.inject,this._fields=this._b3SinglePropagator.fields())}return e.prototype.inject=function(e,t,n){Ze(e)||this._inject(e,t,n)},e.prototype.extract=function(e,t,n){var r=n.get(t,Hc);return(Array.isArray(r)?r[0]:r)?this._b3SinglePropagator.extract(e,t,n):this._b3MultiPropagator.extract(e,t,n)},e.prototype.fields=function(){return this._fields},e}(),au="x-amzn-trace-id",cu=function(){function e(){}return e.prototype.inject=function(e,t,n){var r,o=null===(r=ze.getSpan(e))||void 0===r?void 0:r.spanContext();if(o&&be(o)){var i=o.traceId,s="Root=1-"+i.substring(0,8)+"-"+i.substring(8)+";Parent="+o.spanId+";Sampled="+((w.SAMPLED&o.traceFlags)===w.SAMPLED?"1":"0");n.set(t,au,s)}},e.prototype.extract=function(e,t,n){var r=this.getSpanContextFromHeader(t,n);return be(r)?ze.setSpan(e,ze.wrapSpanContext(r)):e},e.prototype.fields=function(){return[au]},e.prototype.getSpanContextFromHeader=function(t,n){var r=n.keys(t).find((function(e){return e.toLowerCase()===au}));if(!r)return ae;var o=n.get(t,r);if(!o||"string"!=typeof o)return ae;for(var i,s=0,a=se,c=ie,u=null;s<o.length;){var l=o.indexOf(";",s);l>=0?(i=o.substring(s,l).trim(),s=l+1):(i=o.substring(s).trim(),s=o.length);var d=i.indexOf("="),p=i.substring(d+1);i.startsWith("Root")?a=e._parseTraceId(p):i.startsWith("Parent")?c=e._parseSpanId(p):i.startsWith("Sampled")&&(u=e._parseTraceFlag(p))}if(null===u)return ae;var h={traceId:a,spanId:c,traceFlags:u,isRemote:!0};return be(h)?h:ae},e._parseTraceId=function(e){if(35!==e.length)return se;if(!e.startsWith("1"))return se;if("-"!==e.charAt(1)||"-"!==e.charAt(10))return se;var t=e.substring(2,10)+e.substring(11,35);return ye(t)?t:se},e._parseSpanId=function(e){return Ee(e)?e:ie},e._parseTraceFlag=function(e){return"0"===e?w.NONE:"1"===e?w.SAMPLED:null},e}();class uu{constructor(e,t){this.config=e,this.internalPropagator=t}extract(e,t,n){return this.internalPropagator.extract(e,t,n)}fields(){return this.internalPropagator.fields()}inject(t,n,r){var o,i;const s=null===(i=null===(o=this.config.traceParentInHeader)||void 0===o?void 0:o.options)||void 0===i?void 0:i.allowedTracingUrls;let a=!0;if(s){a=wa(ze.getSpan(t).attributes[e.OtelNetworkAttrs.URL],s,"allowedTracingUrls")}a&&(!function(){if(ko(e.CoralogixEventType.NETWORK_REQUEST)){const e=Mo(),n=ze.getSpanContext(t),{traceId:r}=e.span.spanContext();n&&(n.traceId=r,t=ze.setSpanContext(t,n))}}(),this.internalPropagator.inject(t,n,r))}}function lu(e){var t,n,r;if(!function(e){if(e){if(e.proxyUrl||e.public_key){for(const t of Ja)if(Bs(e[t]))return void console.error(`CoralogixRum: Initialization aborted. Please provide the required property "${t}".`);return!0}console.warn("CoralogixRum: Public key is missing")}else console.warn("CoralogixRum: Initialization configuration missing")}(e))return;const{ignoreUrls:o,urlBlueprinters:i,proxyUrl:s}=e,a=[];return o&&a.push(...o),s&&a.push(new RegExp(s)),cc.ignoreUrls&&a.push(...cc.ignoreUrls),Object.assign(Object.assign(Object.assign({},cc),e),{maskInputTypes:null!==(t=e.maskInputTypes)&&void 0!==t?t:oc,maskClass:null!==(n=e.maskClass)&&void 0!==n?n:"cx-mask",ignoreUrls:a,urlBlueprinters:pu(i),sessionSampleRate:null!==(r=e.sessionSampleRate)&&void 0!==r?r:100,sessionConfig:Mc(e.sessionConfig),sessionRecordingConfig:xc(e.sessionRecordingConfig),memoryUsageConfig:du(e.memoryUsageConfig),trackSoftNavigations:!!e.trackSoftNavigations,supportMfe:!!e.supportMfe})}function du(e){var t;return e?Object.assign(Object.assign({},e),{interval:null!==(t=e.interval)&&void 0!==t?t:3e5}):{enabled:!1}}function pu(e){if(!e)return cc.urlBlueprinters;const t={pageUrlBlueprinters:[],networkUrlBlueprinters:[]},n=e=>{const{pageUrlBlueprinters:n,networkUrlBlueprinters:r}=e||{};n&&t.pageUrlBlueprinters.push(...n),r&&t.networkUrlBlueprinters.push(...r)};return n(e),cc.urlBlueprinters&&n(cc.urlBlueprinters),t}function hu(t,n){return function(t){const{event_context:n,error_context:r}=t||{};return n.type===e.CoralogixEventType.ERROR&&n.source===Yo.DOCUMENT&&!(null==r?void 0:r.error_message)}(t)?(n.debug&&console.warn("Document error without message dropped."),!0):!!function(e,t){if(!e.error_context||!(null==t?void 0:t.length))return!1;const n=e.error_context.error_message||"";return function(e,t=[],n=!1){return t.some((t=>yr(e,t,n)))}(n,t)}(t,n.ignoreErrors)&&(n.debug&&console.warn("Ignored error dropped."),!0)}function fu(e,t){if(!(null==t?void 0:t.beforeSend))return e;const n=e.text.cx_rum,r=function(e){const{session_context:{user_id:t,user_name:n,user_email:r,user_metadata:o},browser_sdk:i,timestamp:s}=e,a=br(e,["session_context","browser_sdk","timestamp"]);return Object.assign(Object.assign({},a),{session_context:{user_id:t,user_email:r,user_name:n,user_metadata:o}})}(n),o=t.beforeSend(r);if(!function(e){if(null==e)return null;const t=["version_metadata","session_context","page_context","event_context"],n=()=>t.some((t=>!(null==e?void 0:e[t])));if(!Ws(e)||n())return console.warn("CoralogixRum: beforeSend must return null, undefined or a valid event."),null;return e}(o))return null;const{version_metadata:{app_name:i},event_context:{severity:s}}=o;return Object.assign(Object.assign({},e),{applicationName:i,severity:s,text:{cx_rum:gu(o,n)}})}function gu(e,t){return Object.assign(Object.assign(Object.assign({},t),e),{session_context:Object.assign(Object.assign({},t.session_context),e.session_context)})}class mu{constructor(){this.sdkConfig=Oo(),this.isActive=!0}onEnd(t){var n,r;if(Pc(this.isActive))return;const{onlySessionWithErrorMode:o,getPrevSession:i,getSession:s,setSession:a}=Co(),c=s()||a(),u=!!(null===(n=Io())||void 0===n?void 0:n.getSessionHasRecording()),l=!!(null===(r=Io())||void 0===r?void 0:r.getSessionHasScreenshot()),d=this._mapToCxSpan(t,c,i(),u,l,o);if(!hu(d.text.cx_rum,this.sdkConfig)){const n=fu(d,this.sdkConfig);if(n){const r=n.severity===e.CoralogixLogSeverity.Error,i=Co().sessionHasError;o&&(r||i)&&(Co().sessionHasError=!0,n.text.cx_rum.session_context.hasError=!0),t[pc]=n}}}onStart(){}shutdown(){return this.isActive=!1,Promise.resolve()}forceFlush(){return Promise.resolve(void 0)}_mapToCxSpan(t,n,r,o,i,s){var a,c;const{sessionId:u,sessionCreationDate:l}=n||{},{sessionId:d,sessionCreationDate:p,hasRecording:h,hasScreenshot:f}=r||{},{attributes:g,startTime:m,parentSpanId:v,name:y,endTime:E,status:b,duration:S,kind:T}=t,_=JSON.parse(g[lc.USER_CONTEXT]),C=JSON.parse(g[lc.APPLICATION_CONTEXT]),{application:I,version:O}=C,w=g[lc.EVENT_TYPE]||t[lc.EVENT_TYPE],R=this._getEventTypeContext(g,w,t),{spanId:A,traceId:N}=t.spanContext(),L=Object.assign(Object.assign({},null===(a=t.resource)||void 0===a?void 0:a.attributes),{"service.name":I}),M=Co().fingerPrint,x=JSON.parse(g[lc.CUSTOM_LABELS]),k=!!(null===(c=null==R?void 0:R.error_context)||void 0===c?void 0:c.original_stacktrace),P={app_name:I,app_version:O},D=(null==g?void 0:g[lc.SEVERITY])||e.CoralogixLogSeverity.Info;let U=g[lc.TIMESTAMP]||uo();U<l&&(U=uo());const F={version_metadata:P,applicationName:I,subsystemName:"cx_rum",isErrorWithStacktrace:k,severity:D,timestamp:U,text:{cx_rum:Object.assign(Object.assign({fingerPrint:M,platform:"browser",timestamp:U},R),{browser_sdk:{version:"2.9.0"},version_metadata:P,session_context:Object.assign(Object.assign(Object.assign(Object.assign({},_),{session_id:u,session_creation_date:l,prev_session:d?{session_id:d,session_creation_date:p,hasRecording:h,hasScreenshot:f}:void 0,hasRecording:o,hasScreenshot:i,user_agent:navigator.userAgent}),wo()),{onlyWithErrorMode:s}),page_context:t[lc.PAGE_CONTEXT],isNavigationEvent:!!t[lc.IS_NAVIGATION_EVENT],event_context:{type:w,source:g[lc.SOURCE],severity:D},labels:x,environment:g[lc.ENVIRONMENT]||""})}};return function(e){return!!e[Uo]}(t)&&(F.text.cx_rum.spanId=A,F.text.cx_rum.traceId=N,F.text.cx_rum.parentSpanId=v,F.instrumentation_data={otelSpan:{spanId:A,traceId:N,parentSpanId:v,name:y,attributes:Object.assign(Object.assign(Object.assign({},Cc(g)),this.resolveLabels(F.text.cx_rum)),{sessionId:u}),startTime:m,endTime:E,status:D===e.CoralogixLogSeverity.Error?Object.assign(Object.assign({},b),{code:jo.ERROR}):b,kind:T,duration:S,sessionId:u},otelResource:{attributes:L}}),this.resolveContextFromSpan(F,t,w),F.text.cx_rum.labels=this.resolveLabels(F.text.cx_rum),F}resolveContextFromSpan(t,n,r){switch(r){case e.CoralogixEventType.CUSTOM_MEASUREMENT:t.text.cx_rum.custom_measurement_context=n[lc.CUSTOM_MEASUREMENT_CONTEXT];break;case e.CoralogixEventType.MEMORY_USAGE:t.text.cx_rum.memory_usage_context=n[lc.MEMORY_USAGE_CONTEXT];break;case e.CoralogixEventType.SCREENSHOT:t.text.cx_rum.screenshot_context=n[lc.SCREENSHOT_CONTEXT]}}_getEventTypeContext(t,n,r){var o;switch(n){case e.CoralogixEventType.ERROR:{const e=t[lc.ERROR.MESSAGE],n=r[Xo.DATA],o=r[Xo.STACK];return{error_context:{error_type:t[lc.ERROR.TYPE],error_message:e,original_stacktrace:o,error_custom_data:n}}}case e.CoralogixEventType.NETWORK_REQUEST:{const n=t[e.OtelNetworkAttrs.URL],i=Oc({url:n,blueprinters:null===(o=this.sdkConfig.urlBlueprinters)||void 0===o?void 0:o.networkUrlBlueprinters});return{network_request_context:{method:t[e.OtelNetworkAttrs.METHOD],status_code:t[e.OtelNetworkAttrs.STATUS_CODE],url:n,url_blueprint:i,fragments:Sc(i),host:t[e.OtelNetworkAttrs.HOST],schema:t[e.OtelNetworkAttrs.SCHEME],status_text:t[e.OtelNetworkAttrs.STATUS_TEXT],duration:Ec(null==r?void 0:r.duration),source:t[lc.SOURCE],response_content_length:t[e.OtelNetworkAttrs.RESPONSE_CONTENT_LENGTH],request_headers:r[li],request_payload:r[hi],response_headers:r[di],response_payload:r[pi]}}}case e.CoralogixEventType.LOG:if(t[lc.LOG]){const e=JSON.parse(t[lc.LOG]);return{log_context:{message:e.message,data:null==e?void 0:e.data}}}return{log_context:{message:""}};case e.CoralogixEventType.INTERNAL:{const e=JSON.parse(t[lc.INTERNAL]),{event:n,data:r}=e||{};return{internal_context:{event:n,data:r}}}case e.CoralogixEventType.USER_INTERACTION:return{interaction_context:{target_element:t[lc.TARGET_ELEMENT],event_name:t[lc.INTERACTION_EVENT_NAME],target_element_inner_text:t[lc.ELEMENT_INNER_TEXT],element_id:t[lc.ELEMENT_ID],element_classes:t[lc.ELEMENT_CLASSES],target_element_type:t[lc.TARGET_ELEMENT_TYPE]}};case e.CoralogixEventType.WEB_VITALS:return{web_vitals_context:JSON.parse(t[Hs])};case e.CoralogixEventType.LONG_TASK:return{longtask_context:JSON.parse(t[e.CoralogixEventType.LONG_TASK])};case e.CoralogixEventType.RESOURCES:{const e=JSON.parse(t[Ys]),n=Sc(e.name);return{resource_context:Object.assign(Object.assign({},e),{fragments:n})}}}return{}}resolveLabels(e){var t,n;let r=e.labels;const o=null===(t=this.sdkConfig)||void 0===t?void 0:t.labelProviders;if(null==o?void 0:o.length){const t=gc(ec),o=gc(tc),i=null===(n=e.network_request_context)||void 0===n?void 0:n.fragments,s=Object.assign(Object.assign({},this.getLabelsByLabelProviders(t,e,e.page_context.page_fragments)),i?this.getLabelsByLabelProviders(o,e,i):{});r=Object.assign(Object.assign({},r),s)}return r}getLabelsByLabelProviders(e,t,n){let r={};const o=wc(t);for(const t of e)r=Object.assign(Object.assign({},r),t.providerFunc(n,o));return r}}class vu{constructor(){this.isActive=!0}forceFlush(){return Promise.resolve()}onEnd(e){if(Pc(this.isActive)||!e[pc])return;const t=e[pc];this.isSnapshotPrepared(e)?this.createSnapshot(t):t.text.cx_rum.isSnapshotEvent=!1}onStart(e,t){}shutdown(){return this.isActive=!1,Promise.resolve()}createSnapshot(e){const t=_o().currentSnapshot,{timestamp:n}=t,r=br(t,["timestamp"]);e.text.cx_rum.isSnapshotEvent=!0,e.text.cx_rum.snapshot_context=r}isSnapshotPrepared(t){var n;const{[lc.TIMESTAMP]:r,[lc.EVENT_TYPE]:o,[lc.SEVERITY]:i}=t.attributes;let s=!1;const{fragmentsState:a,updateSnapshot:c,currentSnapshot:u,isSnapshotSentDueToRecording:l}=_o(),{timestamp:d,actionCount:p,errorCount:h}=u,f=t[lc.PAGE_CONTEXT];return f&&!a.has(f.page_fragments)&&(a.add(f.page_fragments),c({timestamp:uo(),viewCount:a.size}),s=!0),i===e.CoralogixLogSeverity.Error&&(c({timestamp:uo(),errorCount:h+1}),s=!0),(null===(n=Io())||void 0===n?void 0:n.getSessionHasRecording())&&!l&&(c({timestamp:uo(),hasRecording:!0}),_o().isSnapshotSentDueToRecording=!0,s=!0),o===e.CoralogixEventType.DOM&&(c({timestamp:uo()}),s=!0),o===e.CoralogixEventType.SCREENSHOT&&c({hasScreenshot:!0}),r-d>=co&&(c({timestamp:uo()}),s=!0),o===e.CoralogixEventType.USER_INTERACTION&&c({actionCount:p+1}),s}}class yu{constructor(){this.updateSnapshot=e=>{this._currentSnapshot=Object.assign(Object.assign({},this._currentSnapshot),e)},this.resetSnapshot=()=>{this._currentSnapshot=Object.assign(Object.assign({},bo),{timestamp:uo()}),this._fragmentsState=new Set,this._isSnapshotSentDueToRecording=!1},To[Eo]=this,this.resetSnapshot()}get fragmentsState(){return this._fragmentsState}get currentSnapshot(){return this._currentSnapshot}get isSnapshotSentDueToRecording(){return this._isSnapshotSentDueToRecording}set isSnapshotSentDueToRecording(e){this._isSnapshotSentDueToRecording=e}}class Eu{forceFlush(){return Promise.resolve()}onEnd(e){}onStart(e){const t=function(e){var t;const n=Oc({url:e,blueprinters:null===(t=Oo().urlBlueprinters)||void 0===t?void 0:t.pageUrlBlueprinters}),r=Sc(n);return{page_url:e.slice(0,Za),page_url_blueprint:n,page_fragments:r,referrer:document.referrer}}(location.href);if(t){e[lc.PAGE_CONTEXT]=t;const{currentPageFragment:n}=Co(),{page_fragments:r}=t;n!==r&&(Co().updateCurrentPage(r),e[lc.IS_NAVIGATION_EVENT]=!0)}}shutdown(){return Promise.resolve()}}if(null==vc?void 0:vc.has(e.PerformanceTypes.LongTask)){const t=To.__tti={e:[]};t.o=new PerformanceObserver((e=>{t.e=t.e.concat(e.getEntries())})),Ca(t.o,e.PerformanceTypes.LongTask)}let bu,Su,Tu,_u,Cu,Iu,Ou,wu,Ru,Au,Nu,Lu,Mu,xu=!1;const ku={get isInited(){return xu},init:function(t){try{if(xu)return void((null==t?void 0:t.debug)&&console.debug("CoralogixRum already initialized, skipping init"));if(!To.sessionStorage)return void console.warn("CoralogixRum: Non-browser environment detected, aborting");if("function"!=typeof Symbol)return void console.warn("CoralogixRum: browser not supported, disabling instrumentation.");const r=lu(t);if(!r)return;To[$a]=function(e){var t,n,r;const o={Edge:/Edge\/([\d.]+)|Edg\/([\d.]+)/,Chrome:/Chrome\/([\d.]+)/,Firefox:/Firefox\/([\d.]+)/,Safari:/Version\/([\d.]+).*Safari|Safari\/([\d.]+)/,Opera:/Opera\/([\d.]+)/,IE:/Trident.*rv:([\d.]+)/},i={Windows:/Windows NT ([\d.]+)/,MacOS:/Mac OS X ([\d._]+)/,webOS:/Web0S/,Linux:/Linux(?: ([\d.]+))?/,iOS:/CPU(?: iPhone)? OS (\d+([._]\d+)*)/,Android:/Android (\d+([._]\d+)*)/,Tizen:/Tizen ([\d.]+)/},s={Mobile:/Mobile|Android|iPhone|iPod|BlackBerry|IEMobile|Windows Phone|webOS|Opera Mini/,Tablet:/Tablet|iPad/,"Smart-TV":/SMART-TV|SmartTV/};let a="Unknown",c="Unknown",u="Unknown",l="Unknown",d="Desktop";for(const[n,r]of Object.entries(o)){const o=e.match(r);if(o){a=n,c=(null===(t=o.slice(1))||void 0===t?void 0:t.find((e=>!!e)))||"Unknown";break}}for(const[t,o]of Object.entries(i)){const i=e.match(o);if(i){u=t,l=(null===(r=null===(n=i[1])||void 0===n?void 0:n.split("_"))||void 0===r?void 0:r.join("."))||"Unknown";break}}for(const[t,n]of Object.entries(s))if(e.match(n)){d=t;break}return{browser:a,browserVersion:c,os:u,osVersion:l,device:d}}(navigator.userAgent),To[qa]=r;let o=function(e){let t=new Wn;const{sessionSampleRate:n,sessionConfig:r,debug:o,sessionRecordingConfig:i}=e;kc(n)&&kc(r.sessionSampleRate)||((null==r?void 0:r.alwaysTrackSessionsWithErrors)?r.onlyWithErrorConfig=Object.assign(Object.assign({},r.onlyWithErrorConfig),{enable:!0}):(o&&console.debug("CoralogixRum: Session tracking is disabled due to sampling rate"),t=new Nc,i&&(i.enable=!1),e.instrumentations=Object.assign(Object.assign({},e.instrumentations),{errors:!1,custom:!1,web_vitals:!1,interactions:!1,long_tasks:!1,resources:!1})));return t}(r);r.debug||r.public_key||console.warn("rumAuth will be required in the future"),Mu=new ja,new Wc(r.sessionRecordingConfig).start();const{ignoreUrls:i,labels:s,user_context:a,application:c,version:u,traceParentInHeader:l,environment:d}=r;Ou=new Uc({sampler:o});const p={},h=uc.map((({Instrument:t,confKey:n,disable:o})=>{var s,a;const c=(u=null===(s=null==r?void 0:r.instrumentations)||void 0===s?void 0:s[n],d=p,h=o,!1===u?u:(void 0!==u||!h)&&!1!==(null==u?void 0:u.enabled)&&Object.assign({},d,u));var u,d,h;if(c){let o;switch(n){case e.CoralogixEventType.WORKER:r.workerSupport&&(o=new t(c,Tu,this));break;case Ho:o=new t(c),Tu=o;break;case Zs:case Ks:if(n===Ks){if(!Bc(Ks))return}o=new t(Object.assign(Object.assign({},c),{ignoreUrls:i,traceParentInHeader:l}));break;case e.CoralogixEventType.INTERNAL:o=new t(c),fc($s,o);break;case e.CoralogixEventType.SCREENSHOT:(null===(a=r.sessionRecordingConfig)||void 0===a?void 0:a.enable)&&(o=new t(c),Iu=o);break;case e.CoralogixEventType.MEMORY_USAGE:r.memoryUsageConfig.enabled&&(To.crossOriginIsolated?performance.measureUserAgentSpecificMemory||(console.debug("Coralogix Browser SDK - measureUserAgentSpecificMemory() is not available in this browser"),0):(console.debug("Coralogix Browser SDK - measureUserAgentSpecificMemory() is only available in cross-origin-isolated pages."),0))&&(o=new t(c),Cu=o);break;default:o=new t(c)}return o instanceof _i&&(Su=o),o instanceof Ba&&(_u=o),o}return null})).filter((e=>Boolean(e))),f=Object.assign(Object.assign({},cc.user_context),a);wu=new Rc(Object.assign({[lc.APPLICATION_CONTEXT]:JSON.stringify({application:c,version:u}),[lc.USER_CONTEXT]:JSON.stringify(f)},d?{[lc.ENVIRONMENT]:d}:{})),s&&wu.setCustomLabels(s),n=wu,To[Fo]=n,Ou.addSpanProcessor(wu),Nu=new Eu,Ou.addSpanProcessor(Nu),Au=new mu,Ou.addSpanProcessor(Au),new yu,Ru=new vu,Ou.addSpanProcessor(Ru),Ou.addSpanProcessor(new $n(Lu=new Dc,{maxExportBatchSize:50,scheduledDelayMillis:2e3})),function(e,t){Sr(this,void 0,void 0,(function*(){var n,r;if(null===(n=e.traceParentInHeader)||void 0===n?void 0:n.enabled){let n=[];const{propagateB3TraceHeader:o,propagateAwsXrayTraceHeader:i}=(null===(r=e.traceParentInHeader)||void 0===r?void 0:r.options)||{};if(i||o||(n=[...n,new Qe,new ln]),i&&n.push(new cu),o){const{singleHeader:e,multiHeader:t}=o;e&&n.push(new su),t&&n.push(new su({injectEncoding:ou.MULTI_HEADER}))}t.register({propagator:new uu(e,new $t({propagators:n}))})}}))}(t,Ou),bu=function(e){var t,n,r=e.tracerProvider||ze.getTracerProvider(),o=e.meterProvider||Pe.getMeterProvider(),i=e.loggerProvider||Xr.getLoggerProvider(),s=null!==(n=null===(t=e.instrumentations)||void 0===t?void 0:t.flat())&&void 0!==n?n:[];return function(e,t,n,r){for(var o=0,i=e.length;o<i;o++){var s=e[o];t&&s.setTracerProvider(t),n&&s.setMeterProvider(n),r&&s.setLoggerProvider&&s.setLoggerProvider(r),s.getConfig().enabled||s.enable()}}(s,r,o,i),function(){!function(e){e.forEach((function(e){return e.disable()}))}(s)}}({tracerProvider:Ou,instrumentations:h});const[g,m]=function(e,t){const n=[],r=[];for(const o of e)t(o)?n.push(o):r.push(o);return[n,r]}(r.labelProviders||[],(({urlType:t})=>t===e.UrlType.PAGE||!t));fc(ec,g),fc(tc,m),xu=!0,(null==t?void 0:t.debug)&&console.debug("Coralogix Browser SDK - initialization has completed"),Gc("init")}catch(e){console.warn("Coralogix Browser SDK - initialization failed: ",e)}var n},getCustomTracer(t){var n,r;if(!xu)return void console.debug("CoralogixRum must be initiated before getting custom tracer");if(!(null===(r=null===(n=Oo())||void 0===n?void 0:n.traceParentInHeader)||void 0===r?void 0:r.enabled))return void console.debug("Coralogix Browser SDK - TraceParentInHeader is not enabled");if(To[No])return void console.warn("Coralogix Browser SDK - Custom tracer already exists");const o=Ou.getTracer("@");var i;return i=o,To[No]=i,{startGlobalSpan:(n,r)=>{if(Mo())return void console.warn("Coralogix Browser SDK - Global span already exists");var i;i=(null==t?void 0:t.ignoredInstruments)||[],To[Lo]=i;const s=o.startSpan(n);s[lc.EVENT_TYPE]=e.CoralogixEventType.CUSTOM_SPAN,r&&Wo(s,r),Bo(s);const a={span:s,withContext:e=>Le.with(ze.setSpan(Le.active(),s),e),endSpan:()=>{null==s||s.end(),xo()},startCustomSpan:(t,n)=>{let r;return Le.with(ze.setSpan(Le.active(),s),(()=>{r=o.startSpan(t),r[lc.EVENT_TYPE]=e.CoralogixEventType.CUSTOM_SPAN,n&&Wo(r,n),Bo(r)})),{span:r,endSpan:()=>{null==r||r.end()}}}};return function(e){To[Ro]=e}(a),function(e,t){To[Ao]=Object.assign(Object.assign({},To[Ao]||{}),{[e]:t})}(s.spanContext().traceId,a),a}}},shutdown(){var e,t;xu&&(null==bu||bu(),bu=void 0,this.stopSessionRecording(),null===(e=Co())||void 0===e||e.stop(),null==wu||wu.shutdown(),null==Nu||Nu.shutdown(),null==Au||Au.shutdown(),null==Ru||Ru.shutdown(),null==Lu||Lu.shutdown(),xu=!1,(null===(t=Oo())||void 0===t?void 0:t.debug)&&console.debug("Coralogix Browser SDK - shutdown has completed"))},setApplicationContext(e){xu?null==wu||wu.setInternalLabels(Object.assign(Object.assign({},wu.getInternalLabels()),{[lc.APPLICATION_CONTEXT]:e})):console.debug("CoralogixRum must be initiated before setting application context")},captureError(e,t,n){xu?null==Tu||Tu.reportError(Yo.CAPTURED,e,t,n):console.debug("CoralogixRum must be initiated before reporting errors")},sendCustomMeasurement(e,t){xu?null==_u||_u.createCustomMeasurement(e,t):console.debug("CoralogixRum must be initiated before sending custom measurement")},addTiming(e,t){xu?this.sendCustomMeasurement(e,function(e){return"number"==typeof e?e:uo()-Co().currentPageTimestamp}(t)):console.debug("CoralogixRum must be initiated before adding timing")},measureUserAgentSpecificMemory(){xu?Cu?Cu.startTrackingMemoryUsage():console.debug("Memory usage instrumentation is not enabled"):console.debug("CoralogixRum must be initiated before measuring user agent specific memory")},stopSessionRecording(){var e;null===(e=Io())||void 0===e||e.stopRecording()},startSessionRecording(){var e;if(!xu)return void((null===(e=Oo())||void 0===e?void 0:e.debug)&&console.debug("Coralogix Browser SDK - CoralogixRum must be initiated before starting session recording"));if(Io())return void Io().startRecording();const t=setInterval((()=>{Io()&&(clearInterval(t),Io().startRecording())}),300);setTimeout((()=>clearInterval(t)),3e3)},screenshot(e){var t;if(!xu)return void console.debug("CoralogixRum must be initiated before capturing screenshot");const n=Er();return null==Iu||Iu.screenshot(n,e),null===(t=Io())||void 0===t||t.screenshot(n),n},setUserContext(e){xu?null==wu||wu.setInternalLabels(Object.assign(Object.assign({},wu.getInternalLabels()),{[lc.USER_CONTEXT]:e})):console.debug("CoralogixRum must be initiated before setting user context")},getUserContext:()=>null==wu?void 0:wu.getUserContext(),setLabels(e){null==wu||wu.setCustomLabels(e)},getLabels:()=>(null==wu?void 0:wu.getCustomLabels())||{},getSessionId(){var e,t;return null===(t=null===(e=Co())||void 0===e?void 0:e.getSession())||void 0===t?void 0:t.sessionId},log(e,t,n,r){xu?Su?null==Su||Su.log({severity:e,message:t,data:n,labels:r}):console.warn("Log was reported, but custom instrumentation is disabled."):console.debug("CoralogixRum must be initiated before using log")},debug(t,n,r){this.log(e.CoralogixLogSeverity.Debug,t,n,r)},verbose(t,n,r){this.log(e.CoralogixLogSeverity.Verbose,t,n,r)},info(t,n,r){this.log(e.CoralogixLogSeverity.Info,t,n,r)},warn(t,n,r){this.log(e.CoralogixLogSeverity.Warn,t,n,r)},error(t,n,r){this.log(e.CoralogixLogSeverity.Error,t,n,r)},critical(t,n,r){this.log(e.CoralogixLogSeverity.Critical,t,n,r)},startTimeMeasure(e,t){xu?null==Mu||Mu.startMeasurement(e,t):console.debug("CoralogixRum must be initiated before starting time measurement.")},endTimeMeasure(e){const t=null==Mu?void 0:Mu.getMeasurement(e);if(t){const{duration:n,labels:r}=t;null==_u||_u.createCustomMeasurement(e,n,Go(r))}}};To.CoralogixRum=ku;var Pu;e.SessionRecordingEventType=void 0,(Pu=e.SessionRecordingEventType||(e.SessionRecordingEventType={}))[Pu.DomContentLoaded=0]="DomContentLoaded",Pu[Pu.Load=1]="Load",Pu[Pu.FullSnapshot=2]="FullSnapshot",Pu[Pu.IncrementalSnapshot=3]="IncrementalSnapshot",Pu[Pu.Meta=4]="Meta",Pu[Pu.Custom=5]="Custom",Pu[Pu.Plugin=6]="Plugin";var Du,Uu=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(Uu||{}),Fu=Object.defineProperty,ju=(e,t,n)=>(((e,t,n)=>{t in e?Fu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Bu=Object.defineProperty,Wu=(e,t,n)=>(((e,t,n)=>{t in e?Bu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Gu=(e=>(e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment",e))(Gu||{});function Vu(e){const t=null==e?void 0:e.host;return Boolean((null==t?void 0:t.shadowRoot)===e)}function Hu(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function Xu(e){try{const n=e.rules||e.cssRules;return n?((t=Array.from(n,Yu).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),t):null}catch(e){return null}var t}function Yu(e){let t;if(function(e){return"styleSheet"in e}(e))try{t=Xu(e.styleSheet)||function(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const n=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(e)}catch(e){}else if(function(e){return"selectorText"in e}(e)&&e.selectorText.includes(":"))return function(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}(e.cssText);return t||e.cssText}let zu=class{constructor(){Wu(this,"idNodeMap",new Map),Wu(this,"nodeMetaMap",new WeakMap)}getId(e){var t;if(!e)return-1;return(null==(t=this.getMeta(e))?void 0:t.id)??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach((e=>this.removeNodeFromMap(e)))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function Ku({element:e,maskInputOptions:t,tagName:n,type:r,value:o,maskInputFn:i}){let s=o||"";const a=r&&Zu(r);return(t[n.toLowerCase()]||a&&t[a])&&(s=i?i(s,e):"*".repeat(s.length)),s}function Zu(e){return e.toLowerCase()}const Ju="__rrweb_original__";function qu(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?Zu(t):null}function $u(e,t){let n;try{n=new URL(e,t??window.location.href)}catch(e){return null}const r=n.pathname.match(/\.([0-9a-z]+)(?:$)/i);return(null==r?void 0:r[1])??null}let Qu=1;const el=new RegExp("[^a-z0-9-_:]");function tl(){return Qu++}let nl,rl;const ol=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,il=/^(?:[a-z+]+:)?\/\//i,sl=/^www\..*/i,al=/^(data:)([^,]*),(.*)/i;function cl(e,t){return(e||"").replace(ol,((e,n,r,o,i,s)=>{const a=r||i||s,c=n||o||"";if(!a)return e;if(il.test(a)||sl.test(a))return`url(${c}${a}${c})`;if(al.test(a))return`url(${c}${a}${c})`;if("/"===a[0])return`url(${c}${function(e){let t="";return t=e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0],t=t.split("?")[0],t}(t)+a}${c})`;const u=t.split("/"),l=a.split("/");u.pop();for(const e of l)"."!==e&&(".."===e?u.pop():u.push(e));return`url(${c}${u.join("/")}${c})`}))}const ul=/^[^ \t\n\r\u000c]+/,ll=/^[, \t\n\r\u000c]+/;const dl=new WeakMap;function pl(e,t){return t&&""!==t.trim()?fl(e,t):t}function hl(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}function fl(e,t){let n=dl.get(e);if(n||(n=e.createElement("a"),dl.set(e,n)),t){if(t.startsWith("blob:")||t.startsWith("data:"))return t}else t="";return n.setAttribute("href",t),n.href}function gl(e,t,n,r){return r?"src"===n||"href"===n&&("use"!==t||"#"!==r[0])||"xlink:href"===n&&"#"!==r[0]?pl(e,r):"background"!==n||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n?function(e,t){if(""===t.trim())return t;let n=0;function r(e){let r;const o=e.exec(t.substring(n));return o?(r=o[0],n+=r.length,r):""}const o=[];for(;r(ll),!(n>=t.length);){let i=r(ul);if(","===i.slice(-1))i=pl(e,i.substring(0,i.length-1)),o.push(i);else{let r="";i=pl(e,i);let s=!1;for(;;){const e=t.charAt(n);if(""===e){o.push((i+r).trim());break}if(s)")"===e&&(s=!1);else{if(","===e){n+=1,o.push((i+r).trim());break}"("===e&&(s=!0)}r+=e,n+=1}}}return o.join(", ")}(e,r):"style"===n?cl(r,fl(e)):"object"===t&&"data"===n?pl(e,r):r:pl(e,r):r}function ml(e,t,n){return("video"===e||"audio"===e)&&"autoplay"===t}function vl(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!n&&vl(e.parentNode,t,n);for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!!n&&vl(e.parentNode,t,n)}function yl(e,t,n,r){try{const o=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===o)return!1;if("string"==typeof t){if(r){if(o.closest(`.${t}`))return!0}else if(o.classList.contains(t))return!0}else if(vl(o,t,r))return!0;if(n)if(r){if(o.closest(n))return!0}else if(o.matches(n))return!0}catch(e){}return!1}function El(e,t){const{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:s,inlineStylesheet:a,maskInputOptions:c={},maskTextFn:u,maskInputFn:l,dataURLOptions:d={},inlineImages:p,recordCanvas:h,keepIframeSrcFn:f,newlyAddedElement:g=!1}=t,m=function(e,t){if(!t.hasNode(e))return;const n=t.getId(e);return 1===n?void 0:n}(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:Gu.Document,childNodes:[],compatMode:e.compatMode}:{type:Gu.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:Gu.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:m};case e.ELEMENT_NODE:return function(e,t){const{doc:n,blockClass:r,blockSelector:o,inlineStylesheet:i,maskInputOptions:s={},maskInputFn:a,dataURLOptions:c={},inlineImages:u,recordCanvas:l,keepIframeSrcFn:d,newlyAddedElement:p=!1,rootId:h}=t,f=function(e,t,n){try{if("string"==typeof t){if(e.classList.contains(t))return!0}else for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}if(n)return e.matches(n)}catch(e){}return!1}(e,r,o),g=function(e){if(e instanceof HTMLFormElement)return"form";const t=Zu(e.tagName);return el.test(t)?"div":t}(e);let m={};const v=e.attributes.length;for(let t=0;t<v;t++){const r=e.attributes[t];ml(g,r.name,r.value)||(m[r.name]=gl(n,g,Zu(r.name),r.value))}if("link"===g&&i){const t=Array.from(n.styleSheets).find((t=>t.href===e.href));let r=null;t&&(r=Xu(t)),r&&(delete m.rel,delete m.href,m._cssText=cl(r,t.href))}if("style"===g&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const t=Xu(e.sheet);t&&(m._cssText=cl(t,fl(n)))}if("input"===g||"textarea"===g||"select"===g){const t=e.value,n=e.checked;"radio"!==m.type&&"checkbox"!==m.type&&"submit"!==m.type&&"button"!==m.type&&t?m.value=Ku({element:e,type:qu(e),tagName:g,value:t,maskInputOptions:s,maskInputFn:a}):n&&(m.checked=n)}"option"===g&&(e.selected&&!s.select?m.selected=!0:delete m.selected);if("canvas"===g&&l)if("2d"===e.__context)(function(e){const t=e.getContext("2d");if(!t)return!0;for(let n=0;n<e.width;n+=50)for(let r=0;r<e.height;r+=50){const o=t.getImageData,i=Ju in o?o[Ju]:o;if(new Uint32Array(i.call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some((e=>0!==e)))return!1}return!0})(e)||(m.rr_dataURL=e.toDataURL(c.type,c.quality));else if(!("__context"in e)){const t=e.toDataURL(c.type,c.quality),r=n.createElement("canvas");r.width=e.width,r.height=e.height;t!==r.toDataURL(c.type,c.quality)&&(m.rr_dataURL=t)}if("img"===g&&u){nl||(nl=n.createElement("canvas"),rl=nl.getContext("2d"));const t=e,r=t.currentSrc||t.getAttribute("src")||"<unknown-src>",o=t.crossOrigin,i=()=>{t.removeEventListener("load",i);try{nl.width=t.naturalWidth,nl.height=t.naturalHeight,rl.drawImage(t,0,0),m.rr_dataURL=nl.toDataURL(c.type,c.quality)}catch(e){if("anonymous"!==t.crossOrigin)return t.crossOrigin="anonymous",void(t.complete&&0!==t.naturalWidth?i():t.addEventListener("load",i));console.warn(`Cannot inline img src=${r}! Error: ${e}`)}"anonymous"===t.crossOrigin&&(o?m.crossOrigin=o:t.removeAttribute("crossorigin"))};t.complete&&0!==t.naturalWidth?i():t.addEventListener("load",i)}if("audio"===g||"video"===g){const t=m;t.rr_mediaState=e.paused?"paused":"played",t.rr_mediaCurrentTime=e.currentTime,t.rr_mediaPlaybackRate=e.playbackRate,t.rr_mediaMuted=e.muted,t.rr_mediaLoop=e.loop,t.rr_mediaVolume=e.volume}p||(e.scrollLeft&&(m.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(m.rr_scrollTop=e.scrollTop));if(f){const{width:t,height:n}=e.getBoundingClientRect();m={class:m.class,rr_width:`${t}px`,rr_height:`${n}px`}}"iframe"!==g||d(m.src)||(e.contentDocument||(m.rr_src=m.src),delete m.src);let y;try{customElements.get(g)&&(y=!0)}catch(e){}return{type:Gu.Element,tagName:g,attributes:m,childNodes:[],isSVG:hl(e)||void 0,needBlock:f,rootId:h,isCustom:y}}(e,{doc:n,blockClass:o,blockSelector:i,inlineStylesheet:a,maskInputOptions:c,maskInputFn:l,dataURLOptions:d,inlineImages:p,recordCanvas:h,keepIframeSrcFn:f,newlyAddedElement:g,rootId:m});case e.TEXT_NODE:return function(e,t){var n;const{needsMask:r,maskTextFn:o,rootId:i}=t,s=e.parentNode&&e.parentNode.tagName;let a=e.textContent;const c="STYLE"===s||void 0,u="SCRIPT"===s||void 0;if(c&&a){try{e.nextSibling||e.previousSibling||(null==(n=e.parentNode.sheet)?void 0:n.cssRules)&&(a=Xu(e.parentNode.sheet))}catch(t){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${t}`,e)}a=cl(a,fl(t.doc))}u&&(a="SCRIPT_PLACEHOLDER");!c&&!u&&a&&r&&(a=o?o(a,e.parentElement):a.replace(/[\S]/g,"*"));return{type:Gu.Text,textContent:a||"",isStyle:c,rootId:i}}(e,{doc:n,needsMask:s,maskTextFn:u,rootId:m});case e.CDATA_SECTION_NODE:return{type:Gu.CDATA,textContent:"",rootId:m};case e.COMMENT_NODE:return{type:Gu.Comment,textContent:e.textContent||"",rootId:m};default:return!1}}function bl(e){return null==e?"":e.toLowerCase()}function Sl(e,t){const{doc:n,mirror:r,blockClass:o,blockSelector:i,maskTextClass:s,maskTextSelector:a,skipChild:c=!1,inlineStylesheet:u=!0,maskInputOptions:l={},maskTextFn:d,maskInputFn:p,slimDOMOptions:h,dataURLOptions:f={},inlineImages:g=!1,recordCanvas:m=!1,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E=5e3,onStylesheetLoad:b,stylesheetLoadTimeout:S=5e3,keepIframeSrcFn:T=()=>!1,newlyAddedElement:_=!1}=t;let{needsMask:C}=t,{preserveWhiteSpace:I=!0}=t;if(!C&&e.childNodes){C=yl(e,s,a,void 0===C)}const O=El(e,{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:C,inlineStylesheet:u,maskInputOptions:l,maskTextFn:d,maskInputFn:p,dataURLOptions:f,inlineImages:g,recordCanvas:m,keepIframeSrcFn:T,newlyAddedElement:_});if(!O)return console.warn(e,"not serialized"),null;let w;w=r.hasNode(e)?r.getId(e):!function(e,t){if(t.comment&&e.type===Gu.Comment)return!0;if(e.type===Gu.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&"js"===$u(e.attributes.href)))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(bl(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===bl(e.attributes.name)||"icon"===bl(e.attributes.rel)||"apple-touch-icon"===bl(e.attributes.rel)||"shortcut icon"===bl(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&bl(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(bl(e.attributes.property).match(/^(og|twitter|fb):/)||bl(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===bl(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===bl(e.attributes.name)||"googlebot"===bl(e.attributes.name)||"bingbot"===bl(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===bl(e.attributes.name)||"generator"===bl(e.attributes.name)||"framework"===bl(e.attributes.name)||"publisher"===bl(e.attributes.name)||"progid"===bl(e.attributes.name)||bl(e.attributes.property).match(/^article:/)||bl(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===bl(e.attributes.name)||"yandex-verification"===bl(e.attributes.name)||"csrf-token"===bl(e.attributes.name)||"p:domain_verify"===bl(e.attributes.name)||"verify-v1"===bl(e.attributes.name)||"verification"===bl(e.attributes.name)||"shopify-checkout-api-token"===bl(e.attributes.name)))return!0}}return!1}(O,h)&&(I||O.type!==Gu.Text||O.isStyle||O.textContent.replace(/^\s+|\s+$/gm,"").length)?tl():-2;const R=Object.assign(O,{id:w});if(r.add(e,R),-2===w)return null;v&&v(e);let A=!c;if(R.type===Gu.Element){A=A&&!R.needBlock,delete R.needBlock;const t=e.shadowRoot;t&&Hu(t)&&(R.isShadowHost=!0)}if((R.type===Gu.Document||R.type===Gu.Element)&&A){h.headWhitespace&&R.type===Gu.Element&&"head"===R.tagName&&(I=!1);const t={doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:C,maskTextClass:s,maskTextSelector:a,skipChild:c,inlineStylesheet:u,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:h,dataURLOptions:f,inlineImages:g,recordCanvas:m,preserveWhiteSpace:I,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:b,stylesheetLoadTimeout:S,keepIframeSrcFn:T};if(R.type===Gu.Element&&"textarea"===R.tagName&&void 0!==R.attributes.value);else for(const n of Array.from(e.childNodes)){const e=Sl(n,t);e&&R.childNodes.push(e)}if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot)for(const n of Array.from(e.shadowRoot.childNodes)){const r=Sl(n,t);r&&(Hu(e.shadowRoot)&&(r.isShadow=!0),R.childNodes.push(r))}}return e.parentNode&&Vu(e.parentNode)&&Hu(e.parentNode)&&(R.isShadow=!0),R.type===Gu.Element&&"iframe"===R.tagName&&function(e,t,n){const r=e.contentWindow;if(!r)return;let o,i=!1;try{o=r.document.readyState}catch(e){return}if("complete"!==o){const r=setTimeout((()=>{i||(t(),i=!0)}),n);return void e.addEventListener("load",(()=>{clearTimeout(r),i=!0,t()}))}const s="about:blank";if(r.location.href!==s||e.src===s||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}(e,(()=>{const t=e.contentDocument;if(t&&y){const n=Sl(t,{doc:t,mirror:r,blockClass:o,blockSelector:i,needsMask:C,maskTextClass:s,maskTextSelector:a,skipChild:!1,inlineStylesheet:u,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:h,dataURLOptions:f,inlineImages:g,recordCanvas:m,preserveWhiteSpace:I,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:b,stylesheetLoadTimeout:S,keepIframeSrcFn:T});n&&y(e,n)}}),E),R.type===Gu.Element&&"link"===R.tagName&&"string"==typeof R.attributes.rel&&("stylesheet"===R.attributes.rel||"preload"===R.attributes.rel&&"string"==typeof R.attributes.href&&"css"===$u(R.attributes.href))&&function(e,t,n){let r,o=!1;try{r=e.sheet}catch(e){return}if(r)return;const i=setTimeout((()=>{o||(t(),o=!0)}),n);e.addEventListener("load",(()=>{clearTimeout(i),o=!0,t()}))}(e,(()=>{if(b){const t=Sl(e,{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:C,maskTextClass:s,maskTextSelector:a,skipChild:!1,inlineStylesheet:u,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:h,dataURLOptions:f,inlineImages:g,recordCanvas:m,preserveWhiteSpace:I,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:b,stylesheetLoadTimeout:S,keepIframeSrcFn:T});t&&b(e,t)}}),S),R}function Tl(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const _l="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let Cl={map:{},getId:()=>(console.error(_l),-1),getNode:()=>(console.error(_l),null),removeNodeFromMap(){console.error(_l)},has:()=>(console.error(_l),!1),reset(){console.error(_l)}};function Il(e,t,n={}){let r=null,o=0;return function(...i){const s=Date.now();o||!1!==n.leading||(o=s);const a=t-(s-o),c=this;a<=0||a>t?(r&&(clearTimeout(r),r=null),o=s,e.apply(c,i)):r||!1===n.trailing||(r=setTimeout((()=>{o=!1===n.leading?0:Date.now(),r=null,e.apply(c,i)}),a))}}function Ol(e,t,n,r,o=window){const i=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,r?n:{set(e){setTimeout((()=>{n.set.call(this,e)}),0),i&&i.set&&i.set.call(this,e)}}),()=>Ol(e,t,i||{},!0)}function wl(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],o=n(r);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,()=>{e[t]=r}}catch{return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Cl=new Proxy(Cl,{get:(e,t,n)=>("map"===t&&console.error(_l),Reflect.get(e,t,n))}));let Rl=Date.now;function Al(e){var t,n,r,o,i,s;const a=e.document;return{left:a.scrollingElement?a.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:(null==a?void 0:a.documentElement.scrollLeft)||(null==(n=null==(t=null==a?void 0:a.body)?void 0:t.parentElement)?void 0:n.scrollLeft)||(null==(r=null==a?void 0:a.body)?void 0:r.scrollLeft)||0,top:a.scrollingElement?a.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:(null==a?void 0:a.documentElement.scrollTop)||(null==(i=null==(o=null==a?void 0:a.body)?void 0:o.parentElement)?void 0:i.scrollTop)||(null==(s=null==a?void 0:a.body)?void 0:s.scrollTop)||0}}function Nl(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Ll(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Ml(e){if(!e)return null;return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}function xl(e,t,n,r){if(!e)return!1;const o=Ml(e);if(!o)return!1;try{if("string"==typeof t){if(o.classList.contains(t))return!0;if(r&&null!==o.closest("."+t))return!0}else if(vl(o,t,r))return!0}catch(e){}if(n){if(o.matches(n))return!0;if(r&&null!==o.closest(n))return!0}return!1}function kl(e,t,n){return!("TITLE"!==e.tagName||!n.headTitleMutations)||-2===t.getId(e)}function Pl(e,t){if(Vu(e))return!1;const n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||Pl(e.parentNode,t))}function Dl(e){return Boolean(e.changedTouches)}function Ul(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function Fl(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function jl(e){return Boolean(null==e?void 0:e.shadowRoot)}/[1-9][0-9]{12}/.test(Date.now().toString())||(Rl=()=>(new Date).getTime());let Bl=class{constructor(){ju(this,"id",1),ju(this,"styleIDMap",new WeakMap),ju(this,"idStyleMap",new Map)}getId(e){return this.styleIDMap.get(e)??-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let n;return n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}};function Wl(e){var t,n;let r=null;return(null==(n=null==(t=e.getRootNode)?void 0:t.call(e))?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(r=e.getRootNode().host),r}function Gl(e){const t=e.ownerDocument;if(!t)return!1;const n=function(e){let t,n=e;for(;t=Wl(n);)n=t;return n}(e);return t.contains(n)}function Vl(e){const t=e.ownerDocument;return!!t&&(t.contains(e)||Gl(e))}var Hl=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(Hl||{}),Xl=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(Xl||{}),Yl=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(Yl||{}),zl=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(zl||{}),Kl=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(Kl||{}),Zl=(e=>(e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange",e[e.RateChange=4]="RateChange",e))(Zl||{});function Jl(e){return"__ln"in e}class ql{constructor(){ju(this,"length",0),ju(this,"head",null),ju(this,"tail",null)}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let n=0;n<e;n++)t=(null==t?void 0:t.next)||null;return t}addNode(e){const t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&Jl(e.previousSibling)){const n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&Jl(e.nextSibling)&&e.nextSibling.__ln.previous){const n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}removeNode(e){const t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const $l=(e,t)=>`${e}@${t}`;class Ql{constructor(){ju(this,"frozen",!1),ju(this,"locked",!1),ju(this,"texts",[]),ju(this,"attributes",[]),ju(this,"attributeMap",new WeakMap),ju(this,"removes",[]),ju(this,"mapRemoves",[]),ju(this,"movedMap",{}),ju(this,"addedSet",new Set),ju(this,"movedSet",new Set),ju(this,"droppedSet",new Set),ju(this,"mutationCb"),ju(this,"blockClass"),ju(this,"blockSelector"),ju(this,"maskTextClass"),ju(this,"maskTextSelector"),ju(this,"inlineStylesheet"),ju(this,"maskInputOptions"),ju(this,"maskTextFn"),ju(this,"maskInputFn"),ju(this,"keepIframeSrcFn"),ju(this,"recordCanvas"),ju(this,"inlineImages"),ju(this,"slimDOMOptions"),ju(this,"dataURLOptions"),ju(this,"doc"),ju(this,"mirror"),ju(this,"iframeManager"),ju(this,"stylesheetManager"),ju(this,"shadowDomManager"),ju(this,"canvasManager"),ju(this,"processedNodeManager"),ju(this,"unattachedDoc"),ju(this,"processMutations",(e=>{e.forEach(this.processMutation),this.emit()})),ju(this,"emit",(()=>{if(this.frozen||this.locked)return;const e=[],t=new Set,n=new ql,r=e=>{let t=e,n=-2;for(;-2===n;)t=t&&t.nextSibling,n=t&&this.mirror.getId(t);return n},o=o=>{if(!o.parentNode||!Vl(o)||"TEXTAREA"===o.parentNode.tagName)return;const i=Vu(o.parentNode)?this.mirror.getId(Wl(o)):this.mirror.getId(o.parentNode),s=r(o);if(-1===i||-1===s)return n.addNode(o);const a=Sl(o,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{Ul(e,this.mirror)&&this.iframeManager.addIframe(e),Fl(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),jl(o)&&this.shadowDomManager.addShadowRoot(o.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}});a&&(e.push({parentId:i,nextId:s,node:a}),t.add(a.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const e of this.movedSet)td(this.removes,e,this.mirror)&&!this.movedSet.has(e.parentNode)||o(e);for(const e of this.addedSet)nd(this.droppedSet,e)||td(this.removes,e,this.mirror)?nd(this.movedSet,e)?o(e):this.droppedSet.add(e):o(e);let i=null;for(;n.length;){let e=null;if(i){const t=this.mirror.getId(i.value.parentNode),n=r(i.value);-1!==t&&-1!==n&&(e=i)}if(!e){let t=n.tail;for(;t;){const n=t;if(t=t.previous,n){const t=this.mirror.getId(n.value.parentNode);if(-1===r(n.value))continue;if(-1!==t){e=n;break}{const t=n.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const r=t.parentNode.host;if(-1!==this.mirror.getId(r)){e=n;break}}}}}}if(!e){for(;n.head;)n.removeNode(n.head.value);break}i=e.previous,n.removeNode(e.value),o(e.value)}const s={texts:this.texts.map((e=>{const t=e.node;return t.parentNode&&"TEXTAREA"===t.parentNode.tagName&&this.genTextAreaValueMutation(t.parentNode),{id:this.mirror.getId(t),value:e.value}})).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),attributes:this.attributes.map((e=>{const{attributes:t}=e;if("string"==typeof t.style){const n=JSON.stringify(e.styleDiff),r=JSON.stringify(e._unchangedStyles);n.length<t.style.length&&(n+r).split("var(").length===t.style.split("var(").length&&(t.style=e.styleDiff)}return{id:this.mirror.getId(e.node),attributes:t}})).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),removes:this.removes,adds:e};(s.texts.length||s.attributes.length||s.removes.length||s.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(s))})),ju(this,"genTextAreaValueMutation",(e=>{let t=this.attributeMap.get(e);t||(t={node:e,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(t),this.attributeMap.set(e,t)),t.attributes.value=Array.from(e.childNodes,(e=>e.textContent||"")).join("")})),ju(this,"processMutation",(e=>{if(!kl(e.target,this.mirror,this.slimDOMOptions))switch(e.type){case"characterData":{const t=e.target.textContent;xl(e.target,this.blockClass,this.blockSelector,!1)||t===e.oldValue||this.texts.push({value:yl(e.target,this.maskTextClass,this.maskTextSelector,!0)&&t?this.maskTextFn?this.maskTextFn(t,Ml(e.target)):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{const t=e.target;let n=e.attributeName,r=e.target.getAttribute(n);if("value"===n){const e=qu(t);r=Ku({element:t,maskInputOptions:this.maskInputOptions,tagName:t.tagName,type:e,value:r,maskInputFn:this.maskInputFn})}if(xl(e.target,this.blockClass,this.blockSelector,!1)||r===e.oldValue)return;let o=this.attributeMap.get(e.target);if("IFRAME"===t.tagName&&"src"===n&&!this.keepIframeSrcFn(r)){if(t.contentDocument)return;n="rr_src"}if(o||(o={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(o),this.attributeMap.set(e.target,o)),"type"===n&&"INPUT"===t.tagName&&"password"===(e.oldValue||"").toLowerCase()&&t.setAttribute("data-rr-is-password","true"),!ml(t.tagName,n)&&(o.attributes[n]=gl(this.doc,Zu(t.tagName),Zu(n),r),"style"===n)){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(e){this.unattachedDoc=this.doc}const n=this.unattachedDoc.createElement("span");e.oldValue&&n.setAttribute("style",e.oldValue);for(const e of Array.from(t.style)){const r=t.style.getPropertyValue(e),i=t.style.getPropertyPriority(e);r!==n.style.getPropertyValue(e)||i!==n.style.getPropertyPriority(e)?o.styleDiff[e]=""===i?r:[r,i]:o._unchangedStyles[e]=[r,i]}for(const e of Array.from(n.style))""===t.style.getPropertyValue(e)&&(o.styleDiff[e]=!1)}break}case"childList":if(xl(e.target,this.blockClass,this.blockSelector,!0))return;if("TEXTAREA"===e.target.tagName)return void this.genTextAreaValueMutation(e.target);e.addedNodes.forEach((t=>this.genAdds(t,e.target))),e.removedNodes.forEach((t=>{const n=this.mirror.getId(t),r=Vu(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);xl(e.target,this.blockClass,this.blockSelector,!1)||kl(t,this.mirror,this.slimDOMOptions)||!function(e,t){return-1!==t.getId(e)}(t,this.mirror)||(this.addedSet.has(t)?(ed(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===n||Pl(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[$l(n,r)]?ed(this.movedSet,t):this.removes.push({parentId:r,id:n,isShadow:!(!Vu(e.target)||!Hu(e.target))||void 0})),this.mapRemoves.push(t))}))}})),ju(this,"genAdds",((e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!this.addedSet.has(e)&&!this.movedSet.has(e)){if(this.mirror.hasNode(e)){if(kl(e,this.mirror,this.slimDOMOptions))return;this.movedSet.add(e);let n=null;t&&this.mirror.hasNode(t)&&(n=this.mirror.getId(t)),n&&-1!==n&&(this.movedMap[$l(this.mirror.getId(e),n)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);xl(e,this.blockClass,this.blockSelector,!1)||(e.childNodes.forEach((e=>this.genAdds(e))),jl(e)&&e.shadowRoot.childNodes.forEach((t=>{this.processedNodeManager.add(t,this),this.genAdds(t,e)})))}}))}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((t=>{this[t]=e[t]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function ed(e,t){e.delete(t),t.childNodes.forEach((t=>ed(e,t)))}function td(e,t,n){return 0!==e.length&&function(e,t,n){let r=t.parentNode;for(;r;){const t=n.getId(r);if(e.some((e=>e.id===t)))return!0;r=r.parentNode}return!1}(e,t,n)}function nd(e,t){return 0!==e.size&&rd(e,t)}function rd(e,t){const{parentNode:n}=t;return!!n&&(!!e.has(n)||rd(e,n))}let od;const id=e=>{if(!od)return e;return(...t)=>{try{return e(...t)}catch(e){if(od&&!0===od(e))return;throw e}}},sd=[];function ad(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function cd(e,t){var n,r;const o=new Ql;sd.push(o),o.init(e);let i=window.MutationObserver||window.__rrMutationObserver;const s=null==(r=null==(n=null==window?void 0:window.Zone)?void 0:n.__symbol__)?void 0:r.call(n,"MutationObserver");s&&window[s]&&(i=window[s]);const a=new i(id(o.processMutations.bind(o)));return a.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function ud({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,sampling:i}){if(!1===i.mouseInteraction)return()=>{};const s=!0===i.mouseInteraction||void 0===i.mouseInteraction?{}:i.mouseInteraction,a=[];let c=null;return Object.keys(Yl).filter((e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==s[e])).forEach((i=>{let s=Zu(i);const u=(t=>i=>{const s=ad(i);if(xl(s,r,o,!0))return;let a=null,u=t;if("pointerType"in i){switch(i.pointerType){case"mouse":a=zl.Mouse;break;case"touch":a=zl.Touch;break;case"pen":a=zl.Pen}a===zl.Touch?Yl[t]===Yl.MouseDown?u="TouchStart":Yl[t]===Yl.MouseUp&&(u="TouchEnd"):zl.Pen}else Dl(i)&&(a=zl.Touch);null!==a?(c=a,(u.startsWith("Touch")&&a===zl.Touch||u.startsWith("Mouse")&&a===zl.Mouse)&&(a=null)):Yl[t]===Yl.Click&&(a=c,c=null);const l=Dl(i)?i.changedTouches[0]:i;if(!l)return;const d=n.getId(s),{clientX:p,clientY:h}=l;id(e)({type:Yl[u],id:d,x:p,y:h,...null!==a&&{pointerType:a}})})(i);if(window.PointerEvent)switch(Yl[i]){case Yl.MouseDown:case Yl.MouseUp:s=s.replace("mouse","pointer");break;case Yl.TouchStart:case Yl.TouchEnd:return}a.push(Tl(s,u,t))})),id((()=>{a.forEach((e=>e()))}))}function ld({scrollCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,sampling:i}){return Tl("scroll",id(Il(id((i=>{const s=ad(i);if(!s||xl(s,r,o,!0))return;const a=n.getId(s);if(s===t&&t.defaultView){const n=Al(t.defaultView);e({id:a,x:n.left,y:n.top})}else e({id:a,x:s.scrollLeft,y:s.scrollTop})})),i.scroll||100)),t)}const dd=["INPUT","TEXTAREA","SELECT"],pd=new WeakMap;function hd(e){return function(e,t){if(vd("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||vd("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||vd("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||vd("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule){const n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else if(e.parentStyleSheet){const n=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(n)}return t}(e,[])}function fd(e,t,n){let r,o;return e?(e.ownerNode?r=t.getId(e.ownerNode):o=n.getId(e),{styleId:o,id:r}):{}}function gd({mirror:e,stylesheetManager:t},n){var r,o,i;let s=null;s="#document"===n.nodeName?e.getId(n):e.getId(n.host);const a="#document"===n.nodeName?null==(r=n.defaultView)?void 0:r.Document:null==(i=null==(o=n.ownerDocument)?void 0:o.defaultView)?void 0:i.ShadowRoot,c=(null==a?void 0:a.prototype)?Object.getOwnPropertyDescriptor(null==a?void 0:a.prototype,"adoptedStyleSheets"):void 0;return null!==s&&-1!==s&&a&&c?(Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get(){var e;return null==(e=c.get)?void 0:e.call(this)},set(e){var n;const r=null==(n=c.set)?void 0:n.call(this,e);if(null!==s&&-1!==s)try{t.adoptStyleSheets(e,s)}catch(e){}return r}}),id((()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get:c.get,set:c.set})}))):()=>{}}function md(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};let r;!function(e,t){const{mutationCb:n,mousemoveCb:r,mouseInteractionCb:o,scrollCb:i,viewportResizeCb:s,inputCb:a,mediaInteractionCb:c,styleSheetRuleCb:u,styleDeclarationCb:l,canvasMutationCb:d,fontCb:p,selectionCb:h,customElementCb:f}=e;e.mutationCb=(...e)=>{t.mutation&&t.mutation(...e),n(...e)},e.mousemoveCb=(...e)=>{t.mousemove&&t.mousemove(...e),r(...e)},e.mouseInteractionCb=(...e)=>{t.mouseInteraction&&t.mouseInteraction(...e),o(...e)},e.scrollCb=(...e)=>{t.scroll&&t.scroll(...e),i(...e)},e.viewportResizeCb=(...e)=>{t.viewportResize&&t.viewportResize(...e),s(...e)},e.inputCb=(...e)=>{t.input&&t.input(...e),a(...e)},e.mediaInteractionCb=(...e)=>{t.mediaInteaction&&t.mediaInteaction(...e),c(...e)},e.styleSheetRuleCb=(...e)=>{t.styleSheetRule&&t.styleSheetRule(...e),u(...e)},e.styleDeclarationCb=(...e)=>{t.styleDeclaration&&t.styleDeclaration(...e),l(...e)},e.canvasMutationCb=(...e)=>{t.canvasMutation&&t.canvasMutation(...e),d(...e)},e.fontCb=(...e)=>{t.font&&t.font(...e),p(...e)},e.selectionCb=(...e)=>{t.selection&&t.selection(...e),h(...e)},e.customElementCb=(...e)=>{t.customElement&&t.customElement(...e),f(...e)}}(e,t),e.recordDOM&&(r=cd(e,e.doc));const o=function({mousemoveCb:e,sampling:t,doc:n,mirror:r}){if(!1===t.mousemove)return()=>{};const o="number"==typeof t.mousemove?t.mousemove:50,i="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500;let s,a=[];const c=Il(id((t=>{const n=Date.now()-s;e(a.map((e=>(e.timeOffset-=n,e))),t),a=[],s=null})),i),u=id(Il(id((e=>{const t=ad(e),{clientX:n,clientY:o}=Dl(e)?e.changedTouches[0]:e;s||(s=Rl()),a.push({x:n,y:o,id:r.getId(t),timeOffset:Rl()-s}),c("undefined"!=typeof DragEvent&&e instanceof DragEvent?Xl.Drag:e instanceof MouseEvent?Xl.MouseMove:Xl.TouchMove)})),o,{trailing:!1})),l=[Tl("mousemove",u,n),Tl("touchmove",u,n),Tl("drag",u,n)];return id((()=>{l.forEach((e=>e()))}))}(e),i=ud(e),s=ld(e),a=function({viewportResizeCb:e},{win:t}){let n=-1,r=-1;return Tl("resize",id(Il(id((()=>{const t=Nl(),o=Ll();n===t&&r===o||(e({width:Number(o),height:Number(t)}),n=t,r=o)})),200)),t)}(e,{win:n}),c=function({inputCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,ignoreClass:i,ignoreSelector:s,maskInputOptions:a,maskInputFn:c,sampling:u,userTriggeredOnInput:l}){function d(e){let n=ad(e);const u=e.isTrusted,d=n&&n.tagName;if(n&&"OPTION"===d&&(n=n.parentElement),!n||!d||dd.indexOf(d)<0||xl(n,r,o,!0))return;if(n.classList.contains(i)||s&&n.matches(s))return;let h=n.value,f=!1;const g=qu(n)||"";"radio"===g||"checkbox"===g?f=n.checked:(a[d.toLowerCase()]||a[g])&&(h=Ku({element:n,maskInputOptions:a,tagName:d,type:g,value:h,maskInputFn:c})),p(n,l?{text:h,isChecked:f,userTriggered:u}:{text:h,isChecked:f});const m=n.name;"radio"===g&&m&&f&&t.querySelectorAll(`input[type="radio"][name="${m}"]`).forEach((e=>{if(e!==n){const t=e.value;p(e,l?{text:t,isChecked:!f,userTriggered:!1}:{text:t,isChecked:!f})}}))}function p(t,r){const o=pd.get(t);if(!o||o.text!==r.text||o.isChecked!==r.isChecked){pd.set(t,r);const o=n.getId(t);id(e)({...r,id:o})}}const h=("last"===u.input?["change"]:["input","change"]).map((e=>Tl(e,id(d),t))),f=t.defaultView;if(!f)return()=>{h.forEach((e=>e()))};const g=f.Object.getOwnPropertyDescriptor(f.HTMLInputElement.prototype,"value"),m=[[f.HTMLInputElement.prototype,"value"],[f.HTMLInputElement.prototype,"checked"],[f.HTMLSelectElement.prototype,"value"],[f.HTMLTextAreaElement.prototype,"value"],[f.HTMLSelectElement.prototype,"selectedIndex"],[f.HTMLOptionElement.prototype,"selected"]];return g&&g.set&&h.push(...m.map((e=>Ol(e[0],e[1],{set(){id(d)({target:this,isTrusted:!1})}},!1,f)))),id((()=>{h.forEach((e=>e()))}))}(e),u=function({mediaInteractionCb:e,blockClass:t,blockSelector:n,mirror:r,sampling:o,doc:i}){const s=id((i=>Il(id((o=>{const s=ad(o);if(!s||xl(s,t,n,!0))return;const{currentTime:a,volume:c,muted:u,playbackRate:l,loop:d}=s;e({type:i,id:r.getId(s),currentTime:a,volume:c,muted:u,playbackRate:l,loop:d})})),o.media||500))),a=[Tl("play",s(Zl.Play),i),Tl("pause",s(Zl.Pause),i),Tl("seeked",s(Zl.Seeked),i),Tl("volumechange",s(Zl.VolumeChange),i),Tl("ratechange",s(Zl.RateChange),i)];return id((()=>{a.forEach((e=>e()))}))}(e);let l=()=>{},d=()=>{},p=()=>{},h=()=>{};e.recordDOM&&(l=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const o=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(o,{apply:id(((r,o,i)=>{const[s,a]=i,{id:c,styleId:u}=fd(o,t,n.styleMirror);return(c&&-1!==c||u&&-1!==u)&&e({id:c,styleId:u,adds:[{rule:s,index:a}]}),r.apply(o,i)}))});const i=r.CSSStyleSheet.prototype.deleteRule;let s,a;r.CSSStyleSheet.prototype.deleteRule=new Proxy(i,{apply:id(((r,o,i)=>{const[s]=i,{id:a,styleId:c}=fd(o,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:s}]}),r.apply(o,i)}))}),r.CSSStyleSheet.prototype.replace&&(s=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(s,{apply:id(((r,o,i)=>{const[s]=i,{id:a,styleId:c}=fd(o,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replace:s}),r.apply(o,i)}))})),r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:id(((r,o,i)=>{const[s]=i,{id:a,styleId:c}=fd(o,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replaceSync:s}),r.apply(o,i)}))}));const c={};yd("CSSGroupingRule")?c.CSSGroupingRule=r.CSSGroupingRule:(yd("CSSMediaRule")&&(c.CSSMediaRule=r.CSSMediaRule),yd("CSSConditionRule")&&(c.CSSConditionRule=r.CSSConditionRule),yd("CSSSupportsRule")&&(c.CSSSupportsRule=r.CSSSupportsRule));const u={};return Object.entries(c).forEach((([r,o])=>{u[r]={insertRule:o.prototype.insertRule,deleteRule:o.prototype.deleteRule},o.prototype.insertRule=new Proxy(u[r].insertRule,{apply:id(((r,o,i)=>{const[s,a]=i,{id:c,styleId:u}=fd(o.parentStyleSheet,t,n.styleMirror);return(c&&-1!==c||u&&-1!==u)&&e({id:c,styleId:u,adds:[{rule:s,index:[...hd(o),a||0]}]}),r.apply(o,i)}))}),o.prototype.deleteRule=new Proxy(u[r].deleteRule,{apply:id(((r,o,i)=>{const[s]=i,{id:a,styleId:c}=fd(o.parentStyleSheet,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:[...hd(o),s]}]}),r.apply(o,i)}))})})),id((()=>{r.CSSStyleSheet.prototype.insertRule=o,r.CSSStyleSheet.prototype.deleteRule=i,s&&(r.CSSStyleSheet.prototype.replace=s),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(c).forEach((([e,t])=>{t.prototype.insertRule=u[e].insertRule,t.prototype.deleteRule=u[e].deleteRule}))}))}(e,{win:n}),d=gd(e,e.doc),p=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:r},{win:o}){const i=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=new Proxy(i,{apply:id(((o,s,a)=>{var c;const[u,l,d]=a;if(n.has(u))return i.apply(s,[u,l,d]);const{id:p,styleId:h}=fd(null==(c=s.parentRule)?void 0:c.parentStyleSheet,t,r.styleMirror);return(p&&-1!==p||h&&-1!==h)&&e({id:p,styleId:h,set:{property:u,value:l,priority:d},index:hd(s.parentRule)}),o.apply(s,a)}))});const s=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=new Proxy(s,{apply:id(((o,i,a)=>{var c;const[u]=a;if(n.has(u))return s.apply(i,[u]);const{id:l,styleId:d}=fd(null==(c=i.parentRule)?void 0:c.parentStyleSheet,t,r.styleMirror);return(l&&-1!==l||d&&-1!==d)&&e({id:l,styleId:d,remove:{property:u},index:hd(i.parentRule)}),o.apply(i,a)}))}),id((()=>{o.CSSStyleDeclaration.prototype.setProperty=i,o.CSSStyleDeclaration.prototype.removeProperty=s}))}(e,{win:n}),e.collectFonts&&(h=function({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const r=[],o=new WeakMap,i=n.FontFace;n.FontFace=function(e,t,n){const r=new i(e,t,n);return o.set(r,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};const s=wl(t.fonts,"add",(function(t){return function(n){return setTimeout(id((()=>{const t=o.get(n);t&&(e(t),o.delete(n))})),0),t.apply(this,[n])}}));return r.push((()=>{n.FontFace=i})),r.push(s),id((()=>{r.forEach((e=>e()))}))}(e)));const f=function(e){const{doc:t,mirror:n,blockClass:r,blockSelector:o,selectionCb:i}=e;let s=!0;const a=id((()=>{const e=t.getSelection();if(!e||s&&(null==e?void 0:e.isCollapsed))return;s=e.isCollapsed||!1;const a=[],c=e.rangeCount||0;for(let t=0;t<c;t++){const i=e.getRangeAt(t),{startContainer:s,startOffset:c,endContainer:u,endOffset:l}=i;xl(s,r,o,!0)||xl(u,r,o,!0)||a.push({start:n.getId(s),startOffset:c,end:n.getId(u),endOffset:l})}i({ranges:a})}));return a(),Tl("selectionchange",a)}(e),g=function({doc:e,customElementCb:t}){const n=e.defaultView;return n&&n.customElements?wl(n.customElements,"define",(function(e){return function(n,r,o){try{t({define:{name:n}})}catch(e){console.warn(`Custom element callback failed for ${n}`)}return e.apply(this,[n,r,o])}})):()=>{}}(e),m=[];for(const t of e.plugins)m.push(t.observer(t.callback,n,t.options));return id((()=>{sd.forEach((e=>e.reset())),null==r||r.disconnect(),o(),i(),s(),a(),c(),u(),l(),d(),p(),h(),f(),g(),m.forEach((e=>e()))}))}function vd(e){return void 0!==window[e]}function yd(e){return Boolean(void 0!==window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class Ed{constructor(e){ju(this,"iframeIdToRemoteIdMap",new WeakMap),ju(this,"iframeRemoteIdToIdMap",new WeakMap),this.generateIdFn=e}getId(e,t,n,r){const o=n||this.getIdToRemoteIdMap(e),i=r||this.getRemoteIdToIdMap(e);let s=o.get(t);return s||(s=this.generateIdFn(),o.set(t,s),i.set(s,t)),s}getIds(e,t){const n=this.getIdToRemoteIdMap(e),r=this.getRemoteIdToIdMap(e);return t.map((t=>this.getId(e,t,n,r)))}getRemoteId(e,t,n){const r=n||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;const o=r.get(t);return o||-1}getRemoteIds(e,t){const n=this.getRemoteIdToIdMap(e);return t.map((t=>this.getRemoteId(e,t,n)))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class bd{constructor(e){ju(this,"iframes",new WeakMap),ju(this,"crossOriginIframeMap",new WeakMap),ju(this,"crossOriginIframeMirror",new Ed(tl)),ju(this,"crossOriginIframeStyleMirror"),ju(this,"crossOriginIframeRootIdMap",new WeakMap),ju(this,"mirror"),ju(this,"mutationCb"),ju(this,"wrappedEmit"),ju(this,"loadListener"),ju(this,"stylesheetManager"),ju(this,"recordCrossOriginIframes"),this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Ed(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){var n,r;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&(null==(n=e.contentWindow)||n.addEventListener("message",this.handleMessage.bind(this))),null==(r=this.loadListener)||r.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const t=e;if("rrweb"!==t.data.type||t.origin!==t.data.origin)return;if(!e.source)return;const n=this.crossOriginIframeMap.get(e.source);if(!n)return;const r=this.transformCrossOriginEvent(n,t.data.event);r&&this.wrappedEmit(r,t.data.isCheckout)}transformCrossOriginEvent(e,t){var n;switch(t.type){case Hl.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);const n=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,n),this.patchRootIdOnNode(t.data.node,n),{timestamp:t.timestamp,type:Hl.IncrementalSnapshot,data:{source:Xl.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case Hl.Meta:case Hl.Load:case Hl.DomContentLoaded:return!1;case Hl.Plugin:return t;case Hl.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case Hl.IncrementalSnapshot:switch(t.data.source){case Xl.Mutation:return t.data.adds.forEach((t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);const n=this.crossOriginIframeRootIdMap.get(e);n&&this.patchRootIdOnNode(t.node,n)})),t.data.removes.forEach((t=>{this.replaceIds(t,e,["parentId","id"])})),t.data.attributes.forEach((t=>{this.replaceIds(t,e,["id"])})),t.data.texts.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case Xl.Drag:case Xl.TouchMove:case Xl.MouseMove:return t.data.positions.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case Xl.ViewportResize:return!1;case Xl.MediaInteraction:case Xl.MouseInteraction:case Xl.Scroll:case Xl.CanvasMutation:case Xl.Input:return this.replaceIds(t.data,e,["id"]),t;case Xl.StyleSheetRule:case Xl.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case Xl.Font:return t;case Xl.Selection:return t.data.ranges.forEach((t=>{this.replaceIds(t,e,["start","end"])})),t;case Xl.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),null==(n=t.data.styles)||n.forEach((t=>{this.replaceStyleIds(t,e,["styleId"])})),t}}return!1}replace(e,t,n,r){for(const o of r)(Array.isArray(t[o])||"number"==typeof t[o])&&(Array.isArray(t[o])?t[o]=e.getIds(n,t[o]):t[o]=e.getId(n,t[o]));return t}replaceIds(e,t,n){return this.replace(this.crossOriginIframeMirror,e,t,n)}replaceStyleIds(e,t,n){return this.replace(this.crossOriginIframeStyleMirror,e,t,n)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach((e=>{this.replaceIdOnNode(e,t)}))}patchRootIdOnNode(e,t){e.type===Gu.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach((e=>{this.patchRootIdOnNode(e,t)}))}}class Sd{constructor(e){ju(this,"shadowDoms",new WeakSet),ju(this,"mutationCb"),ju(this,"scrollCb"),ju(this,"bypassOptions"),ju(this,"mirror"),ju(this,"restoreHandlers",[]),this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,t){if(!Hu(e))return;if(this.shadowDoms.has(e))return;this.shadowDoms.add(e);const n=cd({...this.bypassOptions,doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},e);this.restoreHandlers.push((()=>n.disconnect())),this.restoreHandlers.push(ld({...this.bypassOptions,scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),setTimeout((()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(gd({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))}),0)}observeAttachShadow(e){e.contentWindow&&e.contentDocument&&this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,t){const n=this;this.restoreHandlers.push(wl(e.prototype,"attachShadow",(function(e){return function(r){const o=e.call(this,r);return this.shadowRoot&&Vl(this)&&n.addShadowRoot(this.shadowRoot,t),o}})))}reset(){this.restoreHandlers.forEach((e=>{try{e()}catch(e){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}for(var Td="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_d="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Cd=0;Cd<64;Cd++)_d[Td.charCodeAt(Cd)]=Cd;const Id=new Map;const Od=(e,t,n)=>{if(!e||!Ad(e,t)&&"object"!=typeof e)return;const r=function(e,t){let n=Id.get(e);return n||(n=new Map,Id.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}(n,e.constructor.name);let o=r.indexOf(e);return-1===o&&(o=r.length,r.push(e)),o};function wd(e,t,n){if(e instanceof Array)return e.map((e=>wd(e,t,n)));if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray){return{rr_type:e.constructor.name,args:[Object.values(e)]}}if(e instanceof ArrayBuffer){return{rr_type:e.constructor.name,base64:function(e){var t,n=new Uint8Array(e),r=n.length,o="";for(t=0;t<r;t+=3)o+=Td[n[t]>>2],o+=Td[(3&n[t])<<4|n[t+1]>>4],o+=Td[(15&n[t+1])<<2|n[t+2]>>6],o+=Td[63&n[t+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o}(e)}}if(e instanceof DataView){return{rr_type:e.constructor.name,args:[wd(e.buffer,t,n),e.byteOffset,e.byteLength]}}if(e instanceof HTMLImageElement){const t=e.constructor.name,{src:n}=e;return{rr_type:t,src:n}}if(e instanceof HTMLCanvasElement){return{rr_type:"HTMLImageElement",src:e.toDataURL()}}if(e instanceof ImageData){return{rr_type:e.constructor.name,args:[wd(e.data,t,n),e.width,e.height]}}if(Ad(e,t)||"object"==typeof e){return{rr_type:e.constructor.name,index:Od(e,t,n)}}return e}const Rd=(e,t,n)=>e.map((e=>wd(e,t,n))),Ad=(e,t)=>{const n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((e=>"function"==typeof t[e]));return Boolean(n.find((n=>e instanceof t[n])))};function Nd(e,t,n,r){const o=[];try{const i=wl(e.HTMLCanvasElement.prototype,"getContext",(function(e){return function(o,...i){if(!xl(this,t,n,!0)){const e=function(e){return"experimental-webgl"===e?"webgl":e}(o);if("__context"in this||(this.__context=e),r&&["webgl","webgl2"].includes(e))if(i[0]&&"object"==typeof i[0]){const e=i[0];e.preserveDrawingBuffer||(e.preserveDrawingBuffer=!0)}else i.splice(0,1,{preserveDrawingBuffer:!0})}return e.apply(this,[o,...i])}}));o.push(i)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{o.forEach((e=>e()))}}function Ld(e,t,n,r,o,i,s){const a=[],c=Object.getOwnPropertyNames(e);for(const i of c)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(i))try{if("function"!=typeof e[i])continue;const c=wl(e,i,(function(e){return function(...a){const c=e.apply(this,a);if(Od(c,s,this),"tagName"in this.canvas&&!xl(this.canvas,r,o,!0)){const e=Rd(a,s,this),r={type:t,property:i,args:e};n(this.canvas,r)}return c}}));a.push(c)}catch{const r=Ol(e,i,{set(e){n(this.canvas,{type:t,property:i,args:[e],setter:!0})}});a.push(r)}return a}const Md="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpCiAgICAgICAgcmV0dXJuIHRyYW5zcGFyZW50QmxvYk1hcC5nZXQoaWQpOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIHRyYW5zcGFyZW50QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgIHJldHVybiBiYXNlNjQ7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gIiI7CiAgICB9CiAgfQogIGNvbnN0IHdvcmtlciA9IHNlbGY7CiAgd29ya2VyLm9ubWVzc2FnZSA9IGFzeW5jIGZ1bmN0aW9uKGUpIHsKICAgIGlmICgiT2Zmc2NyZWVuQ2FudmFzIiBpbiBnbG9iYWxUaGlzKSB7CiAgICAgIGNvbnN0IHsgaWQsIGJpdG1hcCwgd2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMgfSA9IGUuZGF0YTsKICAgICAgY29uc3QgdHJhbnNwYXJlbnRCYXNlNjQgPSBnZXRUcmFuc3BhcmVudEJsb2JGb3IoCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIGRhdGFVUkxPcHRpb25zCiAgICAgICk7CiAgICAgIGNvbnN0IG9mZnNjcmVlbiA9IG5ldyBPZmZzY3JlZW5DYW52YXMod2lkdGgsIGhlaWdodCk7CiAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCIyZCIpOwogICAgICBjdHguZHJhd0ltYWdlKGJpdG1hcCwgMCwgMCk7CiAgICAgIGJpdG1hcC5jbG9zZSgpOwogICAgICBjb25zdCBibG9iID0gYXdhaXQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOwogICAgICBjb25zdCB0eXBlID0gYmxvYi50eXBlOwogICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKTsKICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsKICAgICAgaWYgKCFsYXN0QmxvYk1hcC5oYXMoaWQpICYmIGF3YWl0IHRyYW5zcGFyZW50QmFzZTY0ID09PSBiYXNlNjQpIHsKICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB9CiAgICAgIGlmIChsYXN0QmxvYk1hcC5nZXQoaWQpID09PSBiYXNlNjQpCiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB3b3JrZXIucG9zdE1lc3NhZ2UoewogICAgICAgIGlkLAogICAgICAgIHR5cGUsCiAgICAgICAgYmFzZTY0LAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodAogICAgICB9KTsKICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkOiBlLmRhdGEuaWQgfSk7CiAgICB9CiAgfTsKfSkoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hZ2UtYml0bWFwLWRhdGEtdXJsLXdvcmtlci1CWjFyN1JKRC5qcy5tYXAK",xd="undefined"!=typeof window&&window.Blob&&new Blob([(kd=Md,Uint8Array.from(atob(kd),(e=>e.charCodeAt(0))))],{type:"text/javascript;charset=utf-8"});var kd;function Pd(e){let t;try{if(t=xd&&(window.URL||window.webkitURL).createObjectURL(xd),!t)throw"";const n=new Worker(t,{name:null==e?void 0:e.name});return n.addEventListener("error",(()=>{(window.URL||window.webkitURL).revokeObjectURL(t)})),n}catch(t){return new Worker("data:text/javascript;base64,"+Md,{name:null==e?void 0:e.name})}finally{t&&(window.URL||window.webkitURL).revokeObjectURL(t)}}class Dd{constructor(e){ju(this,"pendingCanvasMutations",new Map),ju(this,"rafStamps",{latestId:0,invokeId:null}),ju(this,"mirror"),ju(this,"mutationCb"),ju(this,"resetObservers"),ju(this,"frozen",!1),ju(this,"locked",!1),ju(this,"processMutation",((e,t)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)}));const{sampling:t="all",win:n,blockClass:r,blockSelector:o,recordCanvas:i,dataURLOptions:s}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,i&&"all"===t&&this.initCanvasMutationObserver(n,r,o),i&&"number"==typeof t&&this.initCanvasFPSObserver(t,n,r,o,{dataURLOptions:s})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(e,t,n,r,o){const i=Nd(t,n,r,!0),s=new Map,a=new Pd;a.onmessage=e=>{const{id:t}=e.data;if(s.set(t,!1),!("base64"in e.data))return;const{base64:n,type:r,width:o,height:i}=e.data;this.mutationCb({id:t,type:Kl["2D"],commands:[{property:"clearRect",args:[0,0,o,i]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:n}],type:r}]},0,0]}]})};const c=1e3/e;let u,l=0;const d=e=>{l&&e-l<c||(l=e,(()=>{const e=[];return t.document.querySelectorAll("canvas").forEach((t=>{xl(t,n,r,!0)||e.push(t)})),e})().forEach((async e=>{var t;const n=this.mirror.getId(e);if(s.get(n))return;if(0===e.width||0===e.height)return;if(s.set(n,!0),["webgl","webgl2"].includes(e.__context)){const n=e.getContext(e.__context);!1===(null==(t=null==n?void 0:n.getContextAttributes())?void 0:t.preserveDrawingBuffer)&&n.clear(n.COLOR_BUFFER_BIT)}const r=await createImageBitmap(e);a.postMessage({id:n,bitmap:r,width:e.width,height:e.height,dataURLOptions:o.dataURLOptions},[r])}))),u=requestAnimationFrame(d)};u=requestAnimationFrame(d),this.resetObservers=()=>{i(),cancelAnimationFrame(u)}}initCanvasMutationObserver(e,t,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const r=Nd(e,t,n,!1),o=function(e,t,n,r){const o=[],i=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const s of i)try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[s])continue;const i=wl(t.CanvasRenderingContext2D.prototype,s,(function(o){return function(...i){return xl(this.canvas,n,r,!0)||setTimeout((()=>{const n=Rd(i,t,this);e(this.canvas,{type:Kl["2D"],property:s,args:n})}),0),o.apply(this,i)}}));o.push(i)}catch{const n=Ol(t.CanvasRenderingContext2D.prototype,s,{set(t){e(this.canvas,{type:Kl["2D"],property:s,args:[t],setter:!0})}});o.push(n)}return()=>{o.forEach((e=>e()))}}(this.processMutation.bind(this),e,t,n),i=function(e,t,n,r){const o=[];return o.push(...Ld(t.WebGLRenderingContext.prototype,Kl.WebGL,e,n,r,0,t)),void 0!==t.WebGL2RenderingContext&&o.push(...Ld(t.WebGL2RenderingContext.prototype,Kl.WebGL2,e,n,r,0,t)),()=>{o.forEach((e=>e()))}}(this.processMutation.bind(this),e,t,n,this.mirror);this.resetObservers=()=>{r(),o(),i()}}startPendingCanvasMutationFlusher(){requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){const e=t=>{this.rafStamps.latestId=t,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((e,t)=>{const n=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,n)})),requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(e);if(!n||-1===t)return;const r=n.map((e=>{const{type:t,...n}=e;return n})),{type:o}=n[0];this.mutationCb({id:t,type:o,commands:r}),this.pendingCanvasMutations.delete(e)}}class Ud{constructor(e){ju(this,"trackedLinkElements",new WeakSet),ju(this,"mutationCb"),ju(this,"adoptedStyleSheetCb"),ju(this,"styleMirror",new Bl),this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;const n={id:t,styleIds:[]},r=[];for(const t of e){let e;this.styleMirror.has(t)?e=this.styleMirror.getId(t):(e=this.styleMirror.add(t),r.push({styleId:e,rules:Array.from(t.rules||CSSRule,((e,t)=>({rule:Yu(e),index:t})))})),n.styleIds.push(e)}r.length>0&&(n.styles=r),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class Fd{constructor(){ju(this,"nodeMap",new WeakMap),ju(this,"active",!1)}inOtherBuffer(e,t){const n=this.nodeMap.get(e);return n&&Array.from(n).some((e=>e!==t))}add(e,t){this.active||(this.active=!0,requestAnimationFrame((()=>{this.nodeMap=new WeakMap,this.active=!1}))),this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}destroy(){}}let jd,Bd,Wd,Gd=!1;try{if(2!==Array.from([1],(e=>2*e))[0]){const e=document.createElement("iframe");document.body.appendChild(e),Array.from=(null==(Du=e.contentWindow)?void 0:Du.Array.from)||Array.from,document.body.removeChild(e)}}catch(e){console.debug("Unable to override Array.from",e)}const Vd=new zu;function Hd(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:o="rr-block",blockSelector:i=null,ignoreClass:s="rr-ignore",ignoreSelector:a=null,maskTextClass:c="rr-mask",maskTextSelector:u=null,inlineStylesheet:l=!0,maskAllInputs:d,maskInputOptions:p,slimDOMOptions:h,maskInputFn:f,maskTextFn:g,hooks:m,packFn:v,sampling:y={},dataURLOptions:E={},mousemoveWait:b,recordDOM:S=!0,recordCanvas:T=!1,recordCrossOriginIframes:_=!1,recordAfter:C=("DOMContentLoaded"===e.recordAfter?e.recordAfter:"load"),userTriggeredOnInput:I=!1,collectFonts:O=!1,inlineImages:w=!1,plugins:R,keepIframeSrcFn:A=()=>!1,ignoreCSSAttributes:N=new Set([]),errorHandler:L}=e;od=L;const M=!_||window.parent===window;let x=!1;if(!M)try{window.parent.document&&(x=!1)}catch(e){x=!0}if(M&&!t)throw new Error("emit function is required");if(!M&&!x)return()=>{};void 0!==b&&void 0===y.mousemove&&(y.mousemove=b),Vd.reset();const k=!0===d?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==p?p:{password:!0},P=!0===h||"all"===h?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===h,headMetaDescKeywords:"all"===h,headTitleMutations:"all"===h}:h||{};let D;!function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}();let U=0;const F=e=>{for(const t of R||[])t.eventProcessor&&(e=t.eventProcessor(e));return v&&!x&&(e=v(e)),e};jd=(e,o)=>{var i;const s=e;if(s.timestamp=Rl(),!(null==(i=sd[0])?void 0:i.isFrozen())||s.type===Hl.FullSnapshot||s.type===Hl.IncrementalSnapshot&&s.data.source===Xl.Mutation||sd.forEach((e=>e.unfreeze())),M)null==t||t(F(s),o);else if(x){const e={type:"rrweb",event:F(s),origin:window.location.origin,isCheckout:o};window.parent.postMessage(e,"*")}if(s.type===Hl.FullSnapshot)D=s,U=0;else if(s.type===Hl.IncrementalSnapshot){if(s.data.source===Xl.Mutation&&s.data.isAttachIframe)return;U++;const e=r&&U>=r,t=n&&s.timestamp-D.timestamp>n;(e||t)&&Bd(!0)}};const j=e=>{jd({type:Hl.IncrementalSnapshot,data:{source:Xl.Mutation,...e}})},B=e=>jd({type:Hl.IncrementalSnapshot,data:{source:Xl.Scroll,...e}}),W=e=>jd({type:Hl.IncrementalSnapshot,data:{source:Xl.CanvasMutation,...e}}),G=new Ud({mutationCb:j,adoptedStyleSheetCb:e=>jd({type:Hl.IncrementalSnapshot,data:{source:Xl.AdoptedStyleSheet,...e}})}),V=new bd({mirror:Vd,mutationCb:j,stylesheetManager:G,recordCrossOriginIframes:_,wrappedEmit:jd});for(const e of R||[])e.getMirror&&e.getMirror({nodeMirror:Vd,crossOriginIframeMirror:V.crossOriginIframeMirror,crossOriginIframeStyleMirror:V.crossOriginIframeStyleMirror});const H=new Fd;Wd=new Dd({recordCanvas:T,mutationCb:W,win:window,blockClass:o,blockSelector:i,mirror:Vd,sampling:y.canvas,dataURLOptions:E});const X=new Sd({mutationCb:j,scrollCb:B,bypassOptions:{blockClass:o,blockSelector:i,maskTextClass:c,maskTextSelector:u,inlineStylesheet:l,maskInputOptions:k,dataURLOptions:E,maskTextFn:g,maskInputFn:f,recordCanvas:T,inlineImages:w,sampling:y,slimDOMOptions:P,iframeManager:V,stylesheetManager:G,canvasManager:Wd,keepIframeSrcFn:A,processedNodeManager:H},mirror:Vd});Bd=(e=!1)=>{if(!S)return;jd({type:Hl.Meta,data:{href:window.location.href,width:Ll(),height:Nl()}},e),G.reset(),X.init(),sd.forEach((e=>e.lock()));const t=function(e,t){const{mirror:n=new zu,blockClass:r="rr-block",blockSelector:o=null,maskTextClass:i="rr-mask",maskTextSelector:s=null,inlineStylesheet:a=!0,inlineImages:c=!1,recordCanvas:u=!1,maskAllInputs:l=!1,maskTextFn:d,maskInputFn:p,slimDOM:h=!1,dataURLOptions:f,preserveWhiteSpace:g,onSerialize:m,onIframeLoad:v,iframeLoadTimeout:y,onStylesheetLoad:E,stylesheetLoadTimeout:b,keepIframeSrcFn:S=()=>!1}=t||{};return Sl(e,{doc:e,mirror:n,blockClass:r,blockSelector:o,maskTextClass:i,maskTextSelector:s,skipChild:!1,inlineStylesheet:a,maskInputOptions:!0===l?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===l?{password:!0}:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:!0===h||"all"===h?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===h,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===h?{}:h,dataURLOptions:f,inlineImages:c,recordCanvas:u,preserveWhiteSpace:g,onSerialize:m,onIframeLoad:v,iframeLoadTimeout:y,onStylesheetLoad:E,stylesheetLoadTimeout:b,keepIframeSrcFn:S,newlyAddedElement:!1})}(document,{mirror:Vd,blockClass:o,blockSelector:i,maskTextClass:c,maskTextSelector:u,inlineStylesheet:l,maskAllInputs:k,maskTextFn:g,slimDOM:P,dataURLOptions:E,recordCanvas:T,inlineImages:w,onSerialize:e=>{Ul(e,Vd)&&V.addIframe(e),Fl(e,Vd)&&G.trackLinkElement(e),jl(e)&&X.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{V.attachIframe(e,t),X.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{G.attachLinkElement(e,t)},keepIframeSrcFn:A});if(!t)return console.warn("Failed to snapshot the document");jd({type:Hl.FullSnapshot,data:{node:t,initialOffset:Al(window)}},e),sd.forEach((e=>e.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&G.adoptStyleSheets(document.adoptedStyleSheets,Vd.getId(document))};try{const e=[],t=e=>{var t;return id(md)({mutationCb:j,mousemoveCb:(e,t)=>jd({type:Hl.IncrementalSnapshot,data:{source:t,positions:e}}),mouseInteractionCb:e=>jd({type:Hl.IncrementalSnapshot,data:{source:Xl.MouseInteraction,...e}}),scrollCb:B,viewportResizeCb:e=>jd({type:Hl.IncrementalSnapshot,data:{source:Xl.ViewportResize,...e}}),inputCb:e=>jd({type:Hl.IncrementalSnapshot,data:{source:Xl.Input,...e}}),mediaInteractionCb:e=>jd({type:Hl.IncrementalSnapshot,data:{source:Xl.MediaInteraction,...e}}),styleSheetRuleCb:e=>jd({type:Hl.IncrementalSnapshot,data:{source:Xl.StyleSheetRule,...e}}),styleDeclarationCb:e=>jd({type:Hl.IncrementalSnapshot,data:{source:Xl.StyleDeclaration,...e}}),canvasMutationCb:W,fontCb:e=>jd({type:Hl.IncrementalSnapshot,data:{source:Xl.Font,...e}}),selectionCb:e=>{jd({type:Hl.IncrementalSnapshot,data:{source:Xl.Selection,...e}})},customElementCb:e=>{jd({type:Hl.IncrementalSnapshot,data:{source:Xl.CustomElement,...e}})},blockClass:o,ignoreClass:s,ignoreSelector:a,maskTextClass:c,maskTextSelector:u,maskInputOptions:k,inlineStylesheet:l,sampling:y,recordDOM:S,recordCanvas:T,inlineImages:w,userTriggeredOnInput:I,collectFonts:O,doc:e,maskInputFn:f,maskTextFn:g,keepIframeSrcFn:A,blockSelector:i,slimDOMOptions:P,dataURLOptions:E,mirror:Vd,iframeManager:V,stylesheetManager:G,shadowDomManager:X,processedNodeManager:H,canvasManager:Wd,ignoreCSSAttributes:N,plugins:(null==(t=null==R?void 0:R.filter((e=>e.observer)))?void 0:t.map((e=>({observer:e.observer,options:e.options,callback:t=>jd({type:Hl.Plugin,data:{plugin:e.name,payload:t}})}))))||[]},m)};V.addLoadListener((n=>{try{e.push(t(n.contentDocument))}catch(e){console.warn(e)}}));const n=()=>{Bd(),e.push(t(document)),Gd=!0};return"interactive"===document.readyState||"complete"===document.readyState?n():(e.push(Tl("DOMContentLoaded",(()=>{jd({type:Hl.DomContentLoaded,data:{}}),"DOMContentLoaded"===C&&n()}))),e.push(Tl("load",(()=>{jd({type:Hl.Load,data:{}}),"load"===C&&n()}),window))),()=>{e.forEach((e=>e())),H.destroy(),Gd=!1,od=void 0}}catch(e){console.warn(e)}}var Xd,Yd;Hd.addCustomEvent=(e,t)=>{if(!Gd)throw new Error("please add custom event after start recording");jd({type:Hl.Custom,data:{tag:e,payload:t}})},Hd.freezePage=()=>{sd.forEach((e=>e.freeze()))},Hd.takeFullSnapshot=e=>{if(!Gd)throw new Error("please take full snapshot after start recording");Bd(e)},Hd.mirror=Vd,(Yd=Xd||(Xd={}))[Yd.NotStarted=0]="NotStarted",Yd[Yd.Running=1]="Running",Yd[Yd.Stopped=2]="Stopped";var zd=Object.defineProperty,Kd=(e,t,n)=>(((e,t,n)=>{t in e?zd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Zd=(e=>(e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment",e))(Zd||{});function Jd(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function qd(e){try{const n=e.rules||e.cssRules;return n?((t=Array.from(n,$d).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),t):null}catch(e){return null}var t}function $d(e){let t;if(function(e){return"styleSheet"in e}(e))try{t=qd(e.styleSheet)||function(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const n=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(e)}catch(e){}else if(function(e){return"selectorText"in e}(e)&&e.selectorText.includes(":"))return function(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}(e.cssText);return t||e.cssText}let Qd=class{constructor(){Kd(this,"idNodeMap",new Map),Kd(this,"nodeMetaMap",new WeakMap)}getId(e){var t;if(!e)return-1;return(null==(t=this.getMeta(e))?void 0:t.id)??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach((e=>this.removeNodeFromMap(e)))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function ep(e){return e.toLowerCase()}const tp="__rrweb_original__";function np(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?ep(t):null}function rp(e,t){let n;try{n=new URL(e,t??window.location.href)}catch(e){return null}const r=n.pathname.match(/\.([0-9a-z]+)(?:$)/i);return(null==r?void 0:r[1])??null}let op=1;const ip=new RegExp("[^a-z0-9-_:]");let sp,ap;const cp=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,up=/^(?:[a-z+]+:)?\/\//i,lp=/^www\..*/i,dp=/^(data:)([^,]*),(.*)/i;function pp(e,t){return(e||"").replace(cp,((e,n,r,o,i,s)=>{const a=r||i||s,c=n||o||"";if(!a)return e;if(up.test(a)||lp.test(a))return`url(${c}${a}${c})`;if(dp.test(a))return`url(${c}${a}${c})`;if("/"===a[0])return`url(${c}${function(e){let t="";return t=e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0],t=t.split("?")[0],t}(t)+a}${c})`;const u=t.split("/"),l=a.split("/");u.pop();for(const e of l)"."!==e&&(".."===e?u.pop():u.push(e));return`url(${c}${u.join("/")}${c})`}))}const hp=/^[^ \t\n\r\u000c]+/,fp=/^[, \t\n\r\u000c]+/;const gp=new WeakMap;function mp(e,t){return t&&""!==t.trim()?yp(e,t):t}function vp(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}function yp(e,t){let n=gp.get(e);if(n||(n=e.createElement("a"),gp.set(e,n)),t){if(t.startsWith("blob:")||t.startsWith("data:"))return t}else t="";return n.setAttribute("href",t),n.href}function Ep(e,t,n,r){return r?"src"===n||"href"===n&&("use"!==t||"#"!==r[0])||"xlink:href"===n&&"#"!==r[0]?mp(e,r):"background"!==n||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n?function(e,t){if(""===t.trim())return t;let n=0;function r(e){let r;const o=e.exec(t.substring(n));return o?(r=o[0],n+=r.length,r):""}const o=[];for(;r(fp),!(n>=t.length);){let i=r(hp);if(","===i.slice(-1))i=mp(e,i.substring(0,i.length-1)),o.push(i);else{let r="";i=mp(e,i);let s=!1;for(;;){const e=t.charAt(n);if(""===e){o.push((i+r).trim());break}if(s)")"===e&&(s=!1);else{if(","===e){n+=1,o.push((i+r).trim());break}"("===e&&(s=!0)}r+=e,n+=1}}}return o.join(", ")}(e,r):"style"===n?pp(r,yp(e)):"object"===t&&"data"===n?mp(e,r):r:mp(e,r):r}function bp(e,t,n){return("video"===e||"audio"===e)&&"autoplay"===t}function Sp(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!n&&Sp(e.parentNode,t,n);for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!!n&&Sp(e.parentNode,t,n)}function Tp(e,t,n,r){try{const o=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===o)return!1;if("string"==typeof t){if(r){if(o.closest(`.${t}`))return!0}else if(o.classList.contains(t))return!0}else if(Sp(o,t,r))return!0;if(n)if(r){if(o.closest(n))return!0}else if(o.matches(n))return!0}catch(e){}return!1}function _p(e,t){const{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:s,inlineStylesheet:a,maskInputOptions:c={},maskTextFn:u,maskInputFn:l,dataURLOptions:d={},inlineImages:p,recordCanvas:h,keepIframeSrcFn:f,newlyAddedElement:g=!1}=t,m=function(e,t){if(!t.hasNode(e))return;const n=t.getId(e);return 1===n?void 0:n}(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:Zd.Document,childNodes:[],compatMode:e.compatMode}:{type:Zd.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:Zd.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:m};case e.ELEMENT_NODE:return function(e,t){const{doc:n,blockClass:r,blockSelector:o,inlineStylesheet:i,maskInputOptions:s={},maskInputFn:a,dataURLOptions:c={},inlineImages:u,recordCanvas:l,keepIframeSrcFn:d,newlyAddedElement:p=!1,rootId:h}=t,f=function(e,t,n){try{if("string"==typeof t){if(e.classList.contains(t))return!0}else for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}if(n)return e.matches(n)}catch(e){}return!1}(e,r,o),g=function(e){if(e instanceof HTMLFormElement)return"form";const t=ep(e.tagName);return ip.test(t)?"div":t}(e);let m={};const v=e.attributes.length;for(let t=0;t<v;t++){const r=e.attributes[t];bp(g,r.name,r.value)||(m[r.name]=Ep(n,g,ep(r.name),r.value))}if("link"===g&&i){const t=Array.from(n.styleSheets).find((t=>t.href===e.href));let r=null;t&&(r=qd(t)),r&&(delete m.rel,delete m.href,m._cssText=pp(r,t.href))}if("style"===g&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const t=qd(e.sheet);t&&(m._cssText=pp(t,yp(n)))}if("input"===g||"textarea"===g||"select"===g){const t=e.value,n=e.checked;"radio"!==m.type&&"checkbox"!==m.type&&"submit"!==m.type&&"button"!==m.type&&t?m.value=function({element:e,maskInputOptions:t,tagName:n,type:r,value:o,maskInputFn:i}){let s=o||"";const a=r&&ep(r);return(t[n.toLowerCase()]||a&&t[a])&&(s=i?i(s,e):"*".repeat(s.length)),s}({element:e,type:np(e),tagName:g,value:t,maskInputOptions:s,maskInputFn:a}):n&&(m.checked=n)}"option"===g&&(e.selected&&!s.select?m.selected=!0:delete m.selected);if("canvas"===g&&l)if("2d"===e.__context)(function(e){const t=e.getContext("2d");if(!t)return!0;for(let n=0;n<e.width;n+=50)for(let r=0;r<e.height;r+=50){const o=t.getImageData,i=tp in o?o[tp]:o;if(new Uint32Array(i.call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some((e=>0!==e)))return!1}return!0})(e)||(m.rr_dataURL=e.toDataURL(c.type,c.quality));else if(!("__context"in e)){const t=e.toDataURL(c.type,c.quality),r=n.createElement("canvas");r.width=e.width,r.height=e.height;t!==r.toDataURL(c.type,c.quality)&&(m.rr_dataURL=t)}if("img"===g&&u){sp||(sp=n.createElement("canvas"),ap=sp.getContext("2d"));const t=e,r=t.currentSrc||t.getAttribute("src")||"<unknown-src>",o=t.crossOrigin,i=()=>{t.removeEventListener("load",i);try{sp.width=t.naturalWidth,sp.height=t.naturalHeight,ap.drawImage(t,0,0),m.rr_dataURL=sp.toDataURL(c.type,c.quality)}catch(e){if("anonymous"!==t.crossOrigin)return t.crossOrigin="anonymous",void(t.complete&&0!==t.naturalWidth?i():t.addEventListener("load",i));console.warn(`Cannot inline img src=${r}! Error: ${e}`)}"anonymous"===t.crossOrigin&&(o?m.crossOrigin=o:t.removeAttribute("crossorigin"))};t.complete&&0!==t.naturalWidth?i():t.addEventListener("load",i)}if("audio"===g||"video"===g){const t=m;t.rr_mediaState=e.paused?"paused":"played",t.rr_mediaCurrentTime=e.currentTime,t.rr_mediaPlaybackRate=e.playbackRate,t.rr_mediaMuted=e.muted,t.rr_mediaLoop=e.loop,t.rr_mediaVolume=e.volume}p||(e.scrollLeft&&(m.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(m.rr_scrollTop=e.scrollTop));if(f){const{width:t,height:n}=e.getBoundingClientRect();m={class:m.class,rr_width:`${t}px`,rr_height:`${n}px`}}"iframe"!==g||d(m.src)||(e.contentDocument||(m.rr_src=m.src),delete m.src);let y;try{customElements.get(g)&&(y=!0)}catch(e){}return{type:Zd.Element,tagName:g,attributes:m,childNodes:[],isSVG:vp(e)||void 0,needBlock:f,rootId:h,isCustom:y}}(e,{doc:n,blockClass:o,blockSelector:i,inlineStylesheet:a,maskInputOptions:c,maskInputFn:l,dataURLOptions:d,inlineImages:p,recordCanvas:h,keepIframeSrcFn:f,newlyAddedElement:g,rootId:m});case e.TEXT_NODE:return function(e,t){var n;const{needsMask:r,maskTextFn:o,rootId:i}=t,s=e.parentNode&&e.parentNode.tagName;let a=e.textContent;const c="STYLE"===s||void 0,u="SCRIPT"===s||void 0;if(c&&a){try{e.nextSibling||e.previousSibling||(null==(n=e.parentNode.sheet)?void 0:n.cssRules)&&(a=qd(e.parentNode.sheet))}catch(t){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${t}`,e)}a=pp(a,yp(t.doc))}u&&(a="SCRIPT_PLACEHOLDER");!c&&!u&&a&&r&&(a=o?o(a,e.parentElement):a.replace(/[\S]/g,"*"));return{type:Zd.Text,textContent:a||"",isStyle:c,rootId:i}}(e,{doc:n,needsMask:s,maskTextFn:u,rootId:m});case e.CDATA_SECTION_NODE:return{type:Zd.CDATA,textContent:"",rootId:m};case e.COMMENT_NODE:return{type:Zd.Comment,textContent:e.textContent||"",rootId:m};default:return!1}}function Cp(e){return null==e?"":e.toLowerCase()}function Ip(e,t){const{doc:n,mirror:r,blockClass:o,blockSelector:i,maskTextClass:s,maskTextSelector:a,skipChild:c=!1,inlineStylesheet:u=!0,maskInputOptions:l={},maskTextFn:d,maskInputFn:p,slimDOMOptions:h,dataURLOptions:f={},inlineImages:g=!1,recordCanvas:m=!1,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E=5e3,onStylesheetLoad:b,stylesheetLoadTimeout:S=5e3,keepIframeSrcFn:T=()=>!1,newlyAddedElement:_=!1}=t;let{needsMask:C}=t,{preserveWhiteSpace:I=!0}=t;if(!C&&e.childNodes){C=Tp(e,s,a,void 0===C)}const O=_p(e,{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:C,inlineStylesheet:u,maskInputOptions:l,maskTextFn:d,maskInputFn:p,dataURLOptions:f,inlineImages:g,recordCanvas:m,keepIframeSrcFn:T,newlyAddedElement:_});if(!O)return console.warn(e,"not serialized"),null;let w;w=r.hasNode(e)?r.getId(e):!function(e,t){if(t.comment&&e.type===Zd.Comment)return!0;if(e.type===Zd.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&"js"===rp(e.attributes.href)))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(Cp(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===Cp(e.attributes.name)||"icon"===Cp(e.attributes.rel)||"apple-touch-icon"===Cp(e.attributes.rel)||"shortcut icon"===Cp(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&Cp(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(Cp(e.attributes.property).match(/^(og|twitter|fb):/)||Cp(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===Cp(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===Cp(e.attributes.name)||"googlebot"===Cp(e.attributes.name)||"bingbot"===Cp(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===Cp(e.attributes.name)||"generator"===Cp(e.attributes.name)||"framework"===Cp(e.attributes.name)||"publisher"===Cp(e.attributes.name)||"progid"===Cp(e.attributes.name)||Cp(e.attributes.property).match(/^article:/)||Cp(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===Cp(e.attributes.name)||"yandex-verification"===Cp(e.attributes.name)||"csrf-token"===Cp(e.attributes.name)||"p:domain_verify"===Cp(e.attributes.name)||"verify-v1"===Cp(e.attributes.name)||"verification"===Cp(e.attributes.name)||"shopify-checkout-api-token"===Cp(e.attributes.name)))return!0}}return!1}(O,h)&&(I||O.type!==Zd.Text||O.isStyle||O.textContent.replace(/^\s+|\s+$/gm,"").length)?op++:-2;const R=Object.assign(O,{id:w});if(r.add(e,R),-2===w)return null;v&&v(e);let A=!c;if(R.type===Zd.Element){A=A&&!R.needBlock,delete R.needBlock;const t=e.shadowRoot;t&&Jd(t)&&(R.isShadowHost=!0)}if((R.type===Zd.Document||R.type===Zd.Element)&&A){h.headWhitespace&&R.type===Zd.Element&&"head"===R.tagName&&(I=!1);const t={doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:C,maskTextClass:s,maskTextSelector:a,skipChild:c,inlineStylesheet:u,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:h,dataURLOptions:f,inlineImages:g,recordCanvas:m,preserveWhiteSpace:I,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:b,stylesheetLoadTimeout:S,keepIframeSrcFn:T};if(R.type===Zd.Element&&"textarea"===R.tagName&&void 0!==R.attributes.value);else for(const n of Array.from(e.childNodes)){const e=Ip(n,t);e&&R.childNodes.push(e)}if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot)for(const n of Array.from(e.shadowRoot.childNodes)){const r=Ip(n,t);r&&(Jd(e.shadowRoot)&&(r.isShadow=!0),R.childNodes.push(r))}}return e.parentNode&&function(e){const t=null==e?void 0:e.host;return Boolean((null==t?void 0:t.shadowRoot)===e)}(e.parentNode)&&Jd(e.parentNode)&&(R.isShadow=!0),R.type===Zd.Element&&"iframe"===R.tagName&&function(e,t,n){const r=e.contentWindow;if(!r)return;let o,i=!1;try{o=r.document.readyState}catch(e){return}if("complete"!==o){const r=setTimeout((()=>{i||(t(),i=!0)}),n);return void e.addEventListener("load",(()=>{clearTimeout(r),i=!0,t()}))}const s="about:blank";if(r.location.href!==s||e.src===s||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}(e,(()=>{const t=e.contentDocument;if(t&&y){const n=Ip(t,{doc:t,mirror:r,blockClass:o,blockSelector:i,needsMask:C,maskTextClass:s,maskTextSelector:a,skipChild:!1,inlineStylesheet:u,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:h,dataURLOptions:f,inlineImages:g,recordCanvas:m,preserveWhiteSpace:I,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:b,stylesheetLoadTimeout:S,keepIframeSrcFn:T});n&&y(e,n)}}),E),R.type===Zd.Element&&"link"===R.tagName&&"string"==typeof R.attributes.rel&&("stylesheet"===R.attributes.rel||"preload"===R.attributes.rel&&"string"==typeof R.attributes.href&&"css"===rp(R.attributes.href))&&function(e,t,n){let r,o=!1;try{r=e.sheet}catch(e){return}if(r)return;const i=setTimeout((()=>{o||(t(),o=!0)}),n);e.addEventListener("load",(()=>{clearTimeout(i),o=!0,t()}))}(e,(()=>{if(b){const t=Ip(e,{doc:n,mirror:r,blockClass:o,blockSelector:i,needsMask:C,maskTextClass:s,maskTextSelector:a,skipChild:!1,inlineStylesheet:u,maskInputOptions:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:h,dataURLOptions:f,inlineImages:g,recordCanvas:m,preserveWhiteSpace:I,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:E,onStylesheetLoad:b,stylesheetLoadTimeout:S,keepIframeSrcFn:T});t&&b(e,t)}}),S),R}var Op,wp=Object.defineProperty,Rp=(e,t,n)=>(((e,t,n)=>{t in e?wp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Ap=Object.defineProperty,Np=(e,t,n)=>(((e,t,n)=>{t in e?Ap(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Lp=Object.defineProperty,Mp=(e,t,n)=>(((e,t,n)=>{t in e?Lp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class xp{constructor(){Mp(this,"idNodeMap",new Map),Mp(this,"nodeMetaMap",new WeakMap)}getId(e){var t;if(!e)return-1;return(null==(t=this.getMeta(e))?void 0:t.id)??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach((e=>this.removeNodeFromMap(e)))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function kp(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!n&&kp(e.parentNode,t,n);for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!!n&&kp(e.parentNode,t,n)}const Pp="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let Dp={map:{},getId:()=>(console.error(Pp),-1),getNode:()=>(console.error(Pp),null),removeNodeFromMap(){console.error(Pp)},has:()=>(console.error(Pp),!1),reset(){console.error(Pp)}};"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Dp=new Proxy(Dp,{get:(e,t,n)=>("map"===t&&console.error(Pp),Reflect.get(e,t,n))}));let Up=Date.now;function Fp(e){if(!e)return null;return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}/[1-9][0-9]{12}/.test(Date.now().toString())||(Up=()=>(new Date).getTime());function jp(e){var t,n;let r=null;return(null==(n=null==(t=e.getRootNode)?void 0:t.call(e))?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(r=e.getRootNode().host),r}function Bp(e){let t,n=e;for(;t=jp(n);)n=t;return n}function Wp(e){const t=e.ownerDocument;if(!t)return!1;const n=Bp(e);return t.contains(n)}const Gp=Object.freeze(Object.defineProperty({__proto__:null,StyleSheetMirror:class{constructor(){Np(this,"id",1),Np(this,"styleIDMap",new WeakMap),Np(this,"idStyleMap",new Map)}getId(e){return this.styleIDMap.get(e)??-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let n;return n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}},get _mirror(){return Dp},closestElementOfNode:Fp,getBaseDimension:function e(t,n){var r,o;const i=null==(o=null==(r=t.ownerDocument)?void 0:r.defaultView)?void 0:o.frameElement;if(!i||i===n)return{x:0,y:0,relativeScale:1,absoluteScale:1};const s=i.getBoundingClientRect(),a=e(i,n),c=s.height/i.clientHeight;return{x:s.x*a.relativeScale+a.x,y:s.y*a.relativeScale+a.y,relativeScale:c,absoluteScale:a.absoluteScale*c}},getNestedRule:function e(t,n){const r=t[n[0]];return 1===n.length?r:e(r.cssRules[n[1]].cssRules,n.slice(2))},getPositionsAndIndex:function(e){const t=[...e],n=t.pop();return{positions:t,index:n}},getRootShadowHost:Bp,getShadowHost:jp,getWindowHeight:function(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight},getWindowScroll:function(e){var t,n,r,o,i,s;const a=e.document;return{left:a.scrollingElement?a.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:(null==a?void 0:a.documentElement.scrollLeft)||(null==(n=null==(t=null==a?void 0:a.body)?void 0:t.parentElement)?void 0:n.scrollLeft)||(null==(r=null==a?void 0:a.body)?void 0:r.scrollLeft)||0,top:a.scrollingElement?a.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:(null==a?void 0:a.documentElement.scrollTop)||(null==(i=null==(o=null==a?void 0:a.body)?void 0:o.parentElement)?void 0:i.scrollTop)||(null==(s=null==a?void 0:a.body)?void 0:s.scrollTop)||0}},getWindowWidth:function(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth},hasShadowRoot:function(e){return Boolean(null==e?void 0:e.shadowRoot)},hookSetter:function e(t,n,r,o,i=window){const s=i.Object.getOwnPropertyDescriptor(t,n);return i.Object.defineProperty(t,n,o?r:{set(e){setTimeout((()=>{r.set.call(this,e)}),0),s&&s.set&&s.set.call(this,e)}}),()=>e(t,n,s||{},!0)},inDom:function(e){const t=e.ownerDocument;return!!t&&(t.contains(e)||Wp(e))},isAncestorRemoved:function e(t,n){if(function(e){const t=null==e?void 0:e.host;return Boolean((null==t?void 0:t.shadowRoot)===e)}(t))return!1;const r=n.getId(t);return!n.has(r)||(!t.parentNode||t.parentNode.nodeType!==t.DOCUMENT_NODE)&&(!t.parentNode||e(t.parentNode,n))},isBlocked:function(e,t,n,r){if(!e)return!1;const o=Fp(e);if(!o)return!1;try{if("string"==typeof t){if(o.classList.contains(t))return!0;if(r&&null!==o.closest("."+t))return!0}else if(kp(o,t,r))return!0}catch(e){}if(n){if(o.matches(n))return!0;if(r&&null!==o.closest(n))return!0}return!1},isIgnored:function(e,t,n){return!("TITLE"!==e.tagName||!n.headTitleMutations)||-2===t.getId(e)},isSerialized:function(e,t){return-1!==t.getId(e)},isSerializedIframe:function(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))},isSerializedStylesheet:function(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))},iterateResolveTree:function e(t,n){n(t.value);for(let r=t.children.length-1;r>=0;r--)e(t.children[r],n)},legacy_isTouchEvent:function(e){return Boolean(e.changedTouches)},get nowTimestamp(){return Up},on:function(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)},patch:function(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],o=n(r);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,()=>{e[t]=r}}catch{return()=>{}}},polyfill:function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})},queueToResolveTrees:function(e){const t={},n=(e,n)=>{const r={value:e,parent:n,children:[]};return t[e.node.id]=r,r},r=[];for(const o of e){const{nextId:e,parentId:i}=o;if(e&&e in t){const i=t[e];if(i.parent){const e=i.parent.children.indexOf(i);i.parent.children.splice(e,0,n(o,i.parent))}else{const e=r.indexOf(i);r.splice(e,0,n(o,null))}}else if(i in t){const e=t[i];e.children.push(n(o,e))}else r.push(n(o,null))}return r},shadowHostInDom:Wp,throttle:function(e,t,n={}){let r=null,o=0;return function(...i){const s=Date.now();o||!1!==n.leading||(o=s);const a=t-(s-o),c=this;a<=0||a>t?(r&&(clearTimeout(r),r=null),o=s,e.apply(c,i)):r||!1===n.trailing||(r=setTimeout((()=>{o=!1===n.leading?0:Date.now(),r=null,e.apply(c,i)}),a))}},uniqueTextMutations:function(e){const t=new Set,n=[];for(let r=e.length;r--;){const o=e[r];t.has(o.id)||(n.push(o),t.add(o.id))}return n}},Symbol.toStringTag,{value:"Module"}));for(var Vp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hp="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Xp=0;Xp<64;Xp++)Hp[Vp.charCodeAt(Xp)]=Xp;"undefined"!=typeof window&&window.Blob&&new Blob([(e=>Uint8Array.from(atob(e),(e=>e.charCodeAt(0))))("KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpCiAgICAgICAgcmV0dXJuIHRyYW5zcGFyZW50QmxvYk1hcC5nZXQoaWQpOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIHRyYW5zcGFyZW50QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgIHJldHVybiBiYXNlNjQ7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gIiI7CiAgICB9CiAgfQogIGNvbnN0IHdvcmtlciA9IHNlbGY7CiAgd29ya2VyLm9ubWVzc2FnZSA9IGFzeW5jIGZ1bmN0aW9uKGUpIHsKICAgIGlmICgiT2Zmc2NyZWVuQ2FudmFzIiBpbiBnbG9iYWxUaGlzKSB7CiAgICAgIGNvbnN0IHsgaWQsIGJpdG1hcCwgd2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMgfSA9IGUuZGF0YTsKICAgICAgY29uc3QgdHJhbnNwYXJlbnRCYXNlNjQgPSBnZXRUcmFuc3BhcmVudEJsb2JGb3IoCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIGRhdGFVUkxPcHRpb25zCiAgICAgICk7CiAgICAgIGNvbnN0IG9mZnNjcmVlbiA9IG5ldyBPZmZzY3JlZW5DYW52YXMod2lkdGgsIGhlaWdodCk7CiAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCIyZCIpOwogICAgICBjdHguZHJhd0ltYWdlKGJpdG1hcCwgMCwgMCk7CiAgICAgIGJpdG1hcC5jbG9zZSgpOwogICAgICBjb25zdCBibG9iID0gYXdhaXQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOwogICAgICBjb25zdCB0eXBlID0gYmxvYi50eXBlOwogICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKTsKICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsKICAgICAgaWYgKCFsYXN0QmxvYk1hcC5oYXMoaWQpICYmIGF3YWl0IHRyYW5zcGFyZW50QmFzZTY0ID09PSBiYXNlNjQpIHsKICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB9CiAgICAgIGlmIChsYXN0QmxvYk1hcC5nZXQoaWQpID09PSBiYXNlNjQpCiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB3b3JrZXIucG9zdE1lc3NhZ2UoewogICAgICAgIGlkLAogICAgICAgIHR5cGUsCiAgICAgICAgYmFzZTY0LAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodAogICAgICB9KTsKICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkOiBlLmRhdGEuaWQgfSk7CiAgICB9CiAgfTsKfSkoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hZ2UtYml0bWFwLWRhdGEtdXJsLXdvcmtlci1CWjFyN1JKRC5qcy5tYXAK")],{type:"text/javascript;charset=utf-8"});try{if(2!==Array.from([1],(e=>2*e))[0]){const e=document.createElement("iframe");document.body.appendChild(e),Array.from=(null==(Op=e.contentWindow)?void 0:Op.Array.from)||Array.from,document.body.removeChild(e)}}catch(e){console.debug("Unable to override Array.from",e)}var Yp;new xp,function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"}(Yp||(Yp={}));class zp{constructor(e){Rp(this,"fileName"),Rp(this,"functionName"),Rp(this,"lineNumber"),Rp(this,"columnNumber"),this.fileName=e.fileName||"",this.functionName=e.functionName||"",this.lineNumber=e.lineNumber,this.columnNumber=e.columnNumber}toString(){const e=this.lineNumber||"",t=this.columnNumber||"";return this.functionName?`${this.functionName} (${this.fileName}:${e}:${t})`:`${this.fileName}:${e}:${t}`}}const Kp=/(^|@)\S+:\d+/,Zp=/^\s*at .*(\S+:\d+|\(native\))/m,Jp=/^(eval@)?(\[native code])?$/,qp={parse:function(e){return e?void 0!==e.stacktrace||void 0!==e["opera#sourceloc"]?this.parseOpera(e):e.stack&&e.stack.match(Zp)?this.parseV8OrIE(e):e.stack?this.parseFFOrSafari(e):(console.warn("[console-record-plugin]: Failed to parse error object:",e),[]):[]},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];const t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));if(!t)throw new Error(`Cannot parse given url: ${e}`);return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(Zp)}),this).map((function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(");const n=t.match(/ (\((.+):(\d+):(\d+)\)$)/);t=n?t.replace(n[0],""):t;const r=t.split(/\s+/).slice(1),o=this.extractLocation(n?n[1]:r.pop()),i=r.join(" ")||void 0,s=["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0];return new zp({functionName:i,fileName:s,lineNumber:o[1],columnNumber:o[2]})}),this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter((function(e){return!e.match(Jp)}),this).map((function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new zp({functionName:e});{const t=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=e.match(t),r=n&&n[1]?n[1]:void 0,o=this.extractLocation(e.replace(t,""));return new zp({functionName:r,fileName:o[0],lineNumber:o[1],columnNumber:o[2]})}}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){const t=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),r=[];for(let e=2,o=n.length;e<o;e+=2){const o=t.exec(n[e]);o&&r.push(new zp({fileName:o[2],lineNumber:parseFloat(o[1])}))}return r},parseOpera10:function(e){const t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),r=[];for(let e=0,o=n.length;e<o;e+=2){const o=t.exec(n[e]);o&&r.push(new zp({functionName:o[3]||void 0,fileName:o[2],lineNumber:parseFloat(o[1])}))}return r},parseOpera11:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(Kp)&&!e.match(/^Error created at/)}),this).map((function(e){const t=e.split("@"),n=this.extractLocation(t.pop()),r=(t.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new zp({functionName:r,fileName:n[0],lineNumber:n[1],columnNumber:n[2]})}),this)}};function $p(e){if(!e||!e.outerHTML)return"";let t="";for(;e.parentElement;){let n=e.localName;if(!n)break;n=n.toLowerCase();const r=e.parentElement,o=[];if(r.children&&r.children.length>0)for(let e=0;e<r.children.length;e++){const t=r.children[e];t.localName&&t.localName.toLowerCase&&t.localName.toLowerCase()===n&&o.push(t)}o.length>1&&(n+=`:eq(${o.indexOf(e)})`),t=n+(t?">"+t:""),e=r}return t}function Qp(e){return"[object Object]"===Object.prototype.toString.call(e)}function eh(e,t){if(0===t)return!0;const n=Object.keys(e);for(const r of n)if(Qp(e[r])&&eh(e[r],t-1))return!0;return!1}function th(e,t){const n={numOfKeysLimit:50,depthOfLimit:4};Object.assign(n,t);const r=[],o=[];return JSON.stringify(e,(function(e,t){if(r.length>0){const n=r.indexOf(this);~n?r.splice(n+1):r.push(this),~n?o.splice(n,1/0,e):o.push(e),~r.indexOf(t)&&(t=r[0]===t?"[Circular ~]":"[Circular ~."+o.slice(0,r.indexOf(t)).join(".")+"]")}else r.push(t);if(null===t)return t;if(void 0===t)return"undefined";if(function(e){if(Qp(e)&&Object.keys(e).length>n.numOfKeysLimit)return!0;if("function"==typeof e)return!0;if(Qp(e)&&eh(e,n.depthOfLimit))return!0;return!1}(t))return function(e){let t=e.toString();n.stringLengthLimit&&t.length>n.stringLengthLimit&&(t=`${t.slice(0,n.stringLengthLimit)}...`);return t}(t);if("bigint"==typeof t)return t.toString()+"n";if(t instanceof Event){const e={};for(const n in t){const r=t[n];Array.isArray(r)?e[n]=$p(r.length?r[0]:null):e[n]=r}return e}return t instanceof Node?t instanceof HTMLElement?t?t.outerHTML:"":t.nodeName:t instanceof Error?t.stack?t.stack+"\nEnd of stack for Error object":t.name+": "+t.message:t}))}const nh={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function rh(e,t,n){const r=n?Object.assign({},nh,n):nh,o=r.logger;if(!o)return()=>{};let i;i="string"==typeof o?t[o]:o;let s=0,a=!1;const c=[];if(r.level.includes("error")){const n=t=>{const n=t.message,o=t.error,i=qp.parse(o).map((e=>e.toString())),s=[th(n,r.stringifyOptions)];e({level:"error",trace:i,payload:s})};t.addEventListener("error",n),c.push((()=>{t.removeEventListener("error",n)}));const o=t=>{let n,o;t.reason instanceof Error?(n=t.reason,o=[th(`Uncaught (in promise) ${n.name}: ${n.message}`,r.stringifyOptions)]):(n=new Error,o=[th("Uncaught (in promise)",r.stringifyOptions),th(t.reason,r.stringifyOptions)]);const i=qp.parse(n).map((e=>e.toString()));e({level:"error",trace:i,payload:o})};t.addEventListener("unhandledrejection",o),c.push((()=>{t.removeEventListener("unhandledrejection",o)}))}for(const e of r.level)c.push(u(i,e));return()=>{c.forEach((e=>e()))};function u(t,n){return t[n]?Gp.patch(t,n,(t=>(...o)=>{if(t.apply(this,o),!a){a=!0;try{const t=qp.parse(new Error).map((e=>e.toString())).splice(1),i=o.map((e=>th(e,r.stringifyOptions)));s++,s<r.lengthThreshold?e({level:n,trace:t,payload:i}):s===r.lengthThreshold&&e({level:"warn",trace:[],payload:[th("The number of log records reached the threshold.")]})}catch(e){t("rrweb logger error:",e,...o)}finally{a=!1}}})):()=>{}}}function oh(){const e=1048576;function t(e,t,n,r,o,i,s="sendRecordData"){const a=new Blob([n],{type:"application/octet-stream"});self.postMessage({sessionId:e,sessionCreationDate:t,gzipBlob:a,chunkIndex:r,totalChunks:o,screenshotId:i,event:s})}!function(e,t){try{importScripts(e)}catch(e){try{importScripts(t)}catch(e){self.postMessage({event:"stopRecording"})}}}("https://cdn.rum-ingress-coralogix.com/coralogix/browser/latest/pako_deflate.es5.min.js","https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako_deflate.es5.min.js"),self.onmessage=({data:n})=>{if(!this.pako)return console.warn("Coralogix Browser SDK - Web worker not created due to missing pako library"),void self.postMessage({event:"stopRecording"});let r;r=!!n.screenshotId?JSON.stringify(n.records):JSON.stringify(n.records).slice(1,-1);const o=n.sessionId,i=n.sessionCreationDate,s=n.screenshotId,a=this.pako.gzip(r),c=a.byteLength;if(c>=e){const n=Math.ceil(c/e);for(let r=0;r<n;r++){const c=r*e,u=(r+1)*e;t(o,i,a.slice(c,u),r,n-1,s,"splitRecordData")}}else t(o,i,a,void 0,void 0,s)},self.onerror=e=>{console.warn("Coralogix Browser SDK - Error from session recording worker:\n",e),self.postMessage({event:"stopRecording"})}}class ih{loadAndCreateWorker(e){return Sr(this,void 0,void 0,(function*(){try{const t=e?yield this.loadWorkerScript(e):`(${oh.toString()})()`,n=new Blob([t],{type:"application/javascript"}),r=URL.createObjectURL(n);return new Worker(r)}catch(e){return void console.warn(`CoralogixRum: Error creating worker ${e}`)}}))}loadWorkerScript(e){return Sr(this,void 0,void 0,(function*(){try{const t=yield fetch(this.getFullWorkerUrl(e));return t.ok?yield t.text():(console.warn("CoralogixRum: Error fetching custom web worker"),"")}catch(e){return console.warn("CoralogixRum: Error fetching custom web worker"),""}}))}getFullWorkerUrl(e){return e.startsWith("http://")||e.startsWith("https://")?e:`${To.location.origin}${e}`}}var sh=Object.freeze({__proto__:null,SessionRecorder:class{constructor(e,t){var n;this.isAutoStartRecording=!1,this.onlySessionWithErrorMode=!1,this.recordEvents=[],this.recordEventsForSessionWithError=[[],[]],this.segmentIndexCounter={},this.hasRecording=!1,this.hasScreenshot=!1,this.recordingStopped=!1,this.batchTimeDelay=po,this.isErrorOccurred=!1,this.debugMode=!!(null===(n=Oo())||void 0===n?void 0:n.debug),this._recordingStopDueToTimeout=!1,this.handleRecordEvent=(e,t)=>{this.recordingStopped||(this.onlySessionWithErrorMode?this.handleRecordEventForSessionWithError(e,t):this.recordEvents.push(e))},this.prepareRecordEventsBeforeSend=()=>{if(this.onlySessionWithErrorMode)this.prepareRecordEventsForSessionWithError();else{if(!this.recordEvents.length)return;this.compressRecordData(this.recordEvents),this.resetBatching()}},this.sendRecordEvents=(e,t)=>{const n=new FormData,r=this.getMetadata(e,t);n.append("chunk",e.gzipBlob),n.append("metaData",JSON.stringify(r));const o=()=>Sr(this,void 0,void 0,(function*(){var e;try{const t=this.isErrorOccurred?void 0:yield null===(e=this.request)||void 0===e?void 0:e.send(n);this.handleSessionRecordingResponse(t)}catch(e){this.handleSessionRecordingResponse()}}));t?(this.batchTimeout=setTimeout(o,this.batchTimeDelay),this.batchTimeDelay+=po):(o(),this.batchTimeDelay=po)},To[vo]=this,this.sessionManager=e;const{onlySessionWithErrorMode:r,maxRecordTimeForSessionWithError:o}=e,{maxMutations:i,autoStartSessionRecording:s,workerUrl:a}=t;this.onlySessionWithErrorMode=r,this.maxRecordTimeForSessionWithError=o,this.isAutoStartRecording=s,this.maxMutations=null!=i?i:5e3,this.recordConfig=this.prepareRecordConfig(t),To.Worker?(this.workerManager=new ih,this.initializeSessionWorker(a)):this.debugMode&&console.warn("Coralogix Browser SDK - Recording is not supported on this platform")}getSessionHasScreenshot(){return this.hasScreenshot}getSessionHasRecording(){var e;return this.hasRecording&&!!this.segmentIndexCounter[null===(e=this.sessionManager.getActiveSession())||void 0===e?void 0:e.sessionId]}updateSegmentIndexCounter(e){this.segmentIndexCounter=e}getIsAutoStartRecording(){return this.isAutoStartRecording}set recordingStopDueToTimeout(e){this.debugMode&&e&&console.debug("Coralogix Browser SDK - Session recording stopped due to timeout"),this._recordingStopDueToTimeout=e}get recordingStopDueToTimeout(){return this._recordingStopDueToTimeout}startRecording(){return Sr(this,void 0,void 0,(function*(){yield this.isWorkerReady,this.sessionWorker&&!this.recordRef&&(this.debugMode&&console.debug("Coralogix Browser SDK - Session recording started"),this.startMutationObserver(),this.resetBatching(),this.recordingStopped=!1,this.isErrorOccurred=!1,this.recordingStopDueToTimeout=!1,this.recordRef=Hd(this.recordConfig),this.startBatchingRecords())}))}screenshot(e){this.hasScreenshot=!0;const{sessionId:t,sessionCreationDate:n}=this.sessionManager.getActiveSession()||{},r=function(e,t){const{mirror:n=new Qd,blockClass:r="rr-block",blockSelector:o=null,maskTextClass:i="rr-mask",maskTextSelector:s=null,inlineStylesheet:a=!0,inlineImages:c=!1,recordCanvas:u=!1,maskAllInputs:l=!1,maskTextFn:d,maskInputFn:p,slimDOM:h=!1,dataURLOptions:f,preserveWhiteSpace:g,onSerialize:m,onIframeLoad:v,iframeLoadTimeout:y,onStylesheetLoad:E,stylesheetLoadTimeout:b,keepIframeSrcFn:S=()=>!1}=t||{};return Ip(e,{doc:e,mirror:n,blockClass:r,blockSelector:o,maskTextClass:i,maskTextSelector:s,skipChild:!1,inlineStylesheet:a,maskInputOptions:!0===l?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===l?{password:!0}:l,maskTextFn:d,maskInputFn:p,slimDOMOptions:!0===h||"all"===h?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===h,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===h?{}:h,dataURLOptions:f,inlineImages:c,recordCanvas:u,preserveWhiteSpace:g,onSerialize:m,onIframeLoad:v,iframeLoadTimeout:y,onStylesheetLoad:E,stylesheetLoadTimeout:b,keepIframeSrcFn:S,newlyAddedElement:!1})}(document,this.recordConfig);r&&this.sessionWorker.postMessage({event:"sendRecordData",records:r,sessionId:t,screenshotId:e,sessionCreationDate:n})}stopRecording(){this.recordRef&&(this.debugMode&&console.debug("Coralogix Browser SDK - Session recording stopped"),this.recordRef(),this.recordRef=void 0,this.recordingStopped=!0,this.hasRecording=!1,this.prepareRecordEventsBeforeSend(),this.clearIntervals(),this.stopMutationObserver())}stopMutationObserver(){var e;null===(e=this.mutationObserver)||void 0===e||e.disconnect()}startMutationObserver(){this.stopMutationObserver(),this.mutationObserver=new MutationObserver((e=>{if(e.length>this.maxMutations){const t=`Coralogix Browser SDK - Recording stopped due to too many mutations ${e.length}`;console.warn(t),Gc("recording-stop",t),this.stopRecording()}})),this.mutationObserver.observe(document,{attributes:!1,attributeOldValue:!1,characterData:!1,characterDataOldValue:!1,childList:!0,subtree:!0})}clearIntervals(){this.batchingTimeInterval&&clearInterval(this.batchingTimeInterval)}prepareRecordConfig(e){var t;const{excludeDOMOptions:n,recordConsoleEvents:r}=e||{};var o;return this.recordConfig=Object.assign(Object.assign({},e),{emit:this.handleRecordEvent,checkoutEveryNms:this.onlySessionWithErrorMode?this.maxRecordTimeForSessionWithError:void 0,slimDOMOptions:Object.assign(Object.assign({},n),{script:null===(t=null==n?void 0:n.script)||void 0===t||t}),plugins:r?[{name:"rrweb/console@1",observer:rh,options:o}]:[]}),this.recordConfig}handleRecordEventForSessionWithError(e,t){if(this.sessionManager.sessionHasError&&!!t&&e.type===Uu.FullSnapshot)return;!!t&&e.type===Uu.Meta&&this.recordEventsForSessionWithError.push([]);const{length:n,[n-1]:r}=this.recordEventsForSessionWithError;r.push(e)}prepareRecordEventsForSessionWithError(){const{length:e,[e-2]:t,[e-1]:n}=this.recordEventsForSessionWithError;if(this.sessionManager.sessionHasError){const e=t.concat(n);if(!e.length)return;this.compressRecordData(e),this.resetBatching()}else this.recordEventsForSessionWithError=[t,n]}compressRecordData(e){const{sessionId:t,sessionCreationDate:n}=this.sessionManager.getActiveSession()||{};this.sessionWorker.postMessage({event:"compressRecordData",records:e,sessionId:t,sessionCreationDate:n})}registerToWorkerMessages(){this.sessionWorker.onmessage=({data:e})=>{switch(e.event){case"sendRecordData":this.sendRecordEvents(e,!1);break;case"splitRecordData":this.sendRecordEvents(e,!0);break;case"stopRecording":this.stopRecording()}}}resetBatching(){this.onlySessionWithErrorMode?this.recordEventsForSessionWithError=[[],[]]:this.recordEvents=[]}getMetadata(e,t){const{sessionId:n,sessionCreationDate:r,screenshotId:o,gzipBlob:i,chunkIndex:s,totalChunks:a}=e;let c=0;const{application:u}=Oo();!!o||(this.segmentIndexCounter[n]||(this.segmentIndexCounter[n]=0),c=t?s===a?this.segmentIndexCounter[n]++:this.segmentIndexCounter[n]:this.segmentIndexCounter[n]++,sessionStorage.setItem(yo,JSON.stringify(this.segmentIndexCounter)));return{segmentIndex:c,segmentSize:i.size,segmentTimestamp:uo(),sessionCreationDate:r,sessionId:n,snapshotId:o,application:u,subIndex:null!=s?s:-1}}handleSessionRecordingResponse(e){(null==e?void 0:e.ok)?(this.hasRecording=!0,this.isErrorOccurred=!1):(null==e?void 0:e.ok)||this.isErrorOccurred||(console.warn("Coralogix Browser SDK - Error while sending record"),this.isErrorOccurred=!0,this.stopRecording(),this.batchTimeout&&clearTimeout(this.batchTimeout))}startBatchingRecords(){this.batchingTimeInterval=setInterval(this.prepareRecordEventsBeforeSend,1e4)}initializeSessionWorker(e){this.isWorkerReady=new Promise(((t,n)=>{this.workerManager.loadAndCreateWorker(e).then((e=>{this.sessionWorker=e,this.isAutoStartRecording&&this.startRecording(),this.request=new Ac({suffix:"/browser/alpha/sessionrecording",headers:lo}),this.registerToWorkerMessages(),t(!0)})).catch((e=>{this.debugMode&&console.warn("Coralogix Browser SDK - Web worker not created due to: ",e),n(e)}))}))}}});return e.CoralogixRum=ku,e.UrlBasedLabelProvider=class{constructor(e){const{urlPatterns:t,defaultLabels:n,urlType:r}=e,o=t.map((({regexps:e})=>e.map((e=>new RegExp(e)))));this.urlType=r,this.providerFunc=(e,r)=>{let i={};e:for(const[n,r]of o.entries()){const{labels:o}=t[n];if(r.some((t=>t.test(e)))){i=Object.assign(Object.assign({},i),o);break e}}return Vs(i)&&!Vs(n)&&(i=Object.assign(Object.assign({},i),n)),i}}},e}({});
